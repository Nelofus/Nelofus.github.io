{"config": {"lang": ["en"], "separator": "[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+", "pipeline": ["stemmer"]}, "docs": [{"location": "", "title": "Index", "text": "<p>\u5e0c\u671b\u80fd\u4f5c\u51fa\u4e00\u4e9b\u5fae\u5c0f\u7684\u8d21\u732e\u3002</p> <p>\u6b64\u5904\u7684\u5185\u5bb9\u6709\u7684\u65f6\u5019\u4e5f\u4f1a\u5728\u8fd9\u91cc\u66f4\u65b0\u3002</p> <p>\u9644\u6ce8: \u95ee\u9898\u89e3\u51b3\u7684\u6307\u5bfc\u539f\u5219</p> <p>\u6539\u81ea Elegia \u300a\u8fc7\u53bb\uff0c\u73b0\u5728\u548c\u672a\u6765\u300b\u4e2d\u7684\u540c\u540d\u90e8\u5206\u3002</p> <ul> <li>\u51b7\u9759\u662f\u6709\u6548\u601d\u8003\u7684\u5148\u51b3\u6761\u4ef6\uff0c\u65e0\u8bba\u4f55\u65f6\uff0c\u5fc5\u987b\u4fdd\u8bc1\u81ea\u5df1\u7684\u601d\u8def\u6e05\u6670\uff0c\u4e0d\u8981\u5728\u539f\u5730\u6253\u8f6c\u3002</li> <li>\u62c6\u5206\uff1a\u5728\u9762\u5bf9\u590d\u6742\u7684\u95ee\u9898\u65f6\uff0c\u5c06\u95ee\u9898\u62c6\u5206\u6210\u82e5\u5e72\u4e2a\u5b50\u95ee\u9898\uff0c\u5c1d\u8bd5\u9010\u4e2a\u89e3\u51b3\u3002</li> <li>\u95ee\u9898\u662f\u5426\u6709\u5e73\u51e1\u7684\u60c5\u5f62\uff0c\u6216\u662f\u5728\u6ee1\u8db3\u82e5\u5e72\u7279\u6b8a\u6761\u4ef6\u4e0b\u7684\u89e3\u51b3\u65b9\u6848\uff1f\u5bf9\u6bd4\u8fd9\u79cd\u60c5\u5f62\u4e0e\u539f\u5148\u7684\u95ee\u9898\u3002</li> <li>\u4e0d\u8981\u56f0\u5728\u67d0\u4e00\u4e2a\u90e8\u5206\u4e2d\uff0c\u5982\u679c\u5b83\u771f\u7684\u5f88\u56f0\u96be\uff0c\u7ecf\u8fc7\u5c1d\u8bd5\u4ecd\u7136\u6ca1\u6709\u601d\u8def\uff0c\u8bd5\u7740\u5148\u53bb\u601d\u8003\u5176\u4ed6\u7684\u90e8\u5206\uff0c\u518d\u601d\u8003\u5176\u4ed6\u7684\u90e8\u5206\u80fd\u5426\u5bf9\u8fd9\u4e2a\u5b50\u95ee\u9898\u4ea7\u751f\u542f\u53d1\u3002</li> <li>\u6cdb\u5316\uff1a\u5c1d\u8bd5\u5c06\u95ee\u9898\u6cdb\u5316\uff08\u4ee5\u51f8\u663e\u95ee\u9898\u771f\u6b63\u91cd\u8981\u7684\u6761\u4ef6\uff09\uff0c\u6216\u5bf9\u6bd4\u95ee\u9898\u4e0e\u5176\u4ed6\u6a21\u578b\u7684\u76f8\u4f3c\u4e4b\u5904\u3002\u5bf9\u6bd4\u5927\u95ee\u9898\u4e0e\u5c0f\u95ee\u9898\u7684\u4e00\u822c\u6027\u4e0e\u7279\u6b8a\u6027\u3002</li> <li>\u5c1d\u8bd5\u501f\u52a9\u5404\u79cd\u5de5\u5177\uff0c\u6216\u8005\u5404\u79cd\u7c7b\u578b\u7684\u76f4\u89c2\uff0c\u4ece\u4e0d\u540c\u7684\u89d2\u5ea6\u53bb\u89c2\u5bdf\u3002</li> <li>\u5c3d\u91cf\u8fdb\u884c\u6709\u6548\u7684\u601d\u8003\uff0c\u5728\u7eb8\u4e0a\u5c06\u8f6c\u5316\u7684\u8fc7\u7a0b\u4e00\u4e00\u5199\u4e0b\uff0c\u4fbf\u4e8e\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u89c2\u5bdf\u3002\u5f53\u95ee\u9898\u96be\u4ee5\u63a8\u8fdb\u65f6\uff0c\u5c06\u9047\u5230\u7684\u56f0\u96be\uff0c\u53ef\u80fd\u7684\u89e3\u51b3\u65b9\u5411\uff0c\u53ef\u80fd\u6709\u7528\u7684\u5de5\u5177\u4e00\u4e00\u5217\u51fa\uff0c\u7136\u540e\u5e26\u7740\u65b9\u5411\u4ed4\u7ec6\u89c2\u5bdf\u95ee\u9898\u7684\u6027\u8d28\u3002\u5982\u679c\u4ecd\u7136\u60f3\u4e0d\u51fa\uff0c\u53ef\u80fd\u662f\u88ab\u9519\u8bef\u7684\u601d\u8def\u5e72\u6270\u4e86\uff0c\u5148\u653e\u4e00\u653e\uff0c\u8003\u8651\u4e00\u4e9b\u5176\u4ed6\u7684\u9898\u8f6c\u6362\u4e00\u4e0b\u601d\u8def\u3002</li> <li>\u76f8\u4fe1\u4e00\u5207\u95ee\u9898\u90fd\u662f\u53ef\u505a\u7684\u3002</li> </ul>"}, {"location": "prefix/", "title": "Prefix", "text": "\\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\Endpos{\\operatorname{Endpos}} \\newcommand\\Startpos{\\operatorname{Startpos}} \\newcommand\\height{\\operatorname{height}} \\newcommand\\SA{\\operatorname{SA}} \\newcommand\\len{\\operatorname{len}} \\newcommand\\chkmax{\\operatorname{chkmax}} \\newcommand\\chkmin{\\operatorname{chkmin}} \\newcommand\\siz{\\operatorname{siz}} \\newcommand\\fa{\\operatorname{fa}} \\newcommand\\LCP{\\operatorname{LCP}} \\newcommand\\EGF{\\operatorname{EGF}} \\newcommand\\OGF{\\operatorname{OGF}} \\newcommand\\bd{\\operatorname{Border}} \\newcommand\\mbd{\\operatorname{MaxBorder}} \\]"}, {"location": "Algorithms/", "title": "Index", "text": "<p>\u672c\u6765\u6253\u7b97\u7cfb\u7edf\u7684\u5199\u4e00\u4e9b\u603b\u7ed3\u7684\u5185\u5bb9\uff0c\u4f46\u662f\u5c1d\u8bd5\u4e00\u4e0b\u4e4b\u540e\u53d1\u73b0\u5e76\u6ca1\u6709\u8fd9\u79cd\u7a0b\u5ea6\u7684\u6c34\u5e73\u3002\u6240\u4ee5\u76ee\u524d\u66f4\u65b0\u7684\u5185\u5bb9\u90fd\u53ea\u4f1a\u662f\u6458\u8981\u6216\u8bc4\u6ce8\u5f0f\u7684\u624b\u672d\u3002\u6211\u53ea\u4fdd\u8bc1\u6211\u81ea\u5df1\u80fd\u591f\u770b\u61c2\u3002</p> <p>\u5f53\u7136\uff0c\u4e5f\u5305\u542b\u4e86\u4e00\u4e9b\u6211\u81ea\u5df1\u5b66\u7684\u65f6\u5019\u7684\u505a\u9898\u8bb0\u5f55\u3002</p>"}, {"location": "Algorithms/Counting/Algebra_0/", "title": "Algebra 0", "text": "<p>\u8fd9\u4e00\u8282\u7684\u5185\u5bb9\u5efa\u7acb\u5728\u4e00\u4e9b\u5fae\u79ef\u5206\u7684\u57fa\u7840\u4e4b\u4e0a\uff0c\u6240\u4ee5\u6700\u597d\u638c\u63e1\u57fa\u672c\u7684\u5fae\u79ef\u5206\u77e5\u8bc6\u3002\u4f46\u5373\u4f7f\u4f60\u4e0d\u719f\u6089\u8fd9\u4e9b\uff0c\u5728\u9047\u5230\u964c\u751f\u7684\u7b26\u53f7\u65f6\u518d\u53bb\u67e5\u4e5f\u6765\u5f97\u53ca\uff0c\u8fd9\u4e0d\u4f1a\u6210\u4e3a\u4f60\u89e3\u51b3\u95ee\u9898\u7684\u74f6\u9888\u3002</p> <p>\u901a\u5e38\u7528\u5230\u7684\u7b26\u53f7\u548c\u6027\u8d28\u53ef\u4ee5\u5728\u591a\u9879\u5f0f\u8ba1\u6570\u6742\u8c08\u7684\u7b2c\u4e00\u90e8\u5206\u4e2d\u67e5\u5230\u3002</p> <p>\u5982\u679c\u4f60\u597d\u5947\u4e00\u4e9b\u8fd0\u7b97\u4e3a\u4ec0\u4e48\u662f\u5408\u6cd5\u7684\uff0c\u53ef\u4ee5\u53c2\u9605 rqy \u5199\u7684\u6d45\u8c08 OI \u4e2d\u5e38\u7528\u7684\u4e00\u4e9b\u751f\u6210\u51fd\u6570\u8fd0\u7b97\u7684\u5408\u6cd5\u4e0e\u6b63\u786e\u6027\u3002</p> <p>\u53e6\u5916\uff0c\u6b63\u6587\u6bd4\u8f83\u4fa7\u91cd\u4e8e\u63a8\u5bfc\uff0c\u5982\u4f55\u8ba1\u7b97\u5c31\u653e\u5728\u4e00\u4e9b\u9644\u5f55\u7684\u4f4d\u7f6e\u3002</p> <p>\u7b2c\u4e00\u90e8\u5206\u7684\u7ed3\u6784\u5927\u6982\u4f1a\u5148\u4ee5\u4f8b\u5b50\u7b80\u5355\u4ecb\u7ecd OGF\uff0cEGF \u6700\u57fa\u672c\u7684\u5e94\u7528\uff0c\u5728\u5bf9\u8fd9\u4e9b\u5de5\u5177\u548c\u63a8\u5bfc\u65b9\u5f0f\u6709\u4e86\u57fa\u672c\u7684\u719f\u6089\u540e\uff0c\u5f15\u5165\u7ec4\u5408\u7b26\u53f7\u5316\u65b9\u6cd5\u5bf9\u524d\u6587\u6240\u8ff0\u7684\u5185\u5bb9\u5c3d\u91cf\u4f5c\u4e00\u4e2a\u6bd4\u8f83\u7cfb\u7edf\u7684\u6574\u7406\uff0c\u968f\u540e\u4f1a\u4ecb\u7ecd\u4e00\u4e9b\u591a\u5143 GF \u4e0e\u96c6\u5408\u5e42\u7ea7\u6570\u7684\u7406\u8bba\u3002</p> <p>\u5982\u679c\u6709\u53ef\u80fd\u7684\u8bdd\u4f1a\u591a\u52a0\u4e00\u70b9\u73b0\u4ee3 OI \u7684\u6280\u672f\uff0c\u4f46\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u5199\u5230\u3002</p>"}, {"location": "Algorithms/Counting/Algebra_1/", "title": "Algebra 1", "text": "<p>\u76ee\u306b\u5199\u3063\u305f\u666f\u8272\u3092</p> <p>\u867d\u7136\u6620\u5728\u773c\u524d\u7684\u666f\u8272</p> <p>\u4e16\u754c\u3060\u306a\u3093\u3066\u3044\u3046\u3051\u3069</p> <p>\u5c31\u88ab\u79f0\u4e3a\u662f\u4e16\u754c\u4e86</p> <p>\u898b\u3048\u306a\u304b\u3063\u305f\u666f\u8272\u306f</p> <p>\u4f46\u770b\u4e0d\u89c1\u7684\u666f\u8272</p> <p>\u9593\u9055\u3044\u306a\u304f\u305d\u3053\u306b\u3042\u3063\u305f</p> <p>\u5374\u4e5f\u6beb\u65e0\u7591\u95ee\u7684\u5c31\u5728\u90a3\u5904</p> \\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\ag[1]{\\left\\langle#1\\right\\rangle} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\deg{\\operatorname{deg}} \\newcommand\\pcnt{\\operatorname{popcount}} \\]"}, {"location": "Algorithms/Counting/Algebra_1/#_1", "title": "\u5f15\u5165", "text": "<p>\u751f\u6210\u51fd\u6570\u7684\u60f3\u6cd5\u51fa\u4e8e\u4e00\u79cd\u8bbe\u60f3\uff1a\u8bd5\u56fe\u5c06\u8ba1\u6570\u5bf9\u8c61\u7ec4\u6210\u7684\u5e8f\u5217\u5199\u6210\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u5f62\u5f0f\uff0c\u5728\u5bf9\u5b83\u5bf9\u5e94\u7684\u5f62\u5f0f\u5e42\u7ea7\u6570\u8fdb\u884c\u7814\u7a76\u540e\uff0c\u518d\u7528\u5f62\u5f0f\u5e42\u7ea7\u6570\u751f\u6210\u539f\u6765\u7684\u8ba1\u6570\u5e8f\u5217\u3002\u8fd9\u6837\uff0c\u4e00\u4e2a\u4ee3\u6570\u5f0f\u5c31\u6db5\u76d6\u4e86\u539f\u6765\u6570\u5217\u6240\u6709\u7684\u4fe1\u606f\uff0c\u5728\u7814\u7a76\u7684\u65f6\u5019\u663e\u5f97\u65b9\u4fbf\u5f97\u591a\u3002\u6ce8\u610f\u533a\u5206\u5f62\u5f0f\u5e42\u7ea7\u6570\u4e0e\u591a\u9879\u5f0f\u7684\u6982\u5ff5\u3002</p> <p>\u5148\u5f15\u5165\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u6982\u5ff5\uff0c\u8bbe \\(x\\) \u662f\u4e00\u4e2a\u7b26\u53f7\uff0c\u800c \\(\\ag{a_0,a_1,a_2,\\cdots, a_n\\cdots}\\) \u662f\u4e00\u4e2a\u5b9e\u6570\u5e8f\u5217\uff0c\u90a3\u4e48\u82e5 \\(F(x)\\) \u6ee1\u8db3</p> \\[ F(x)=\\sum_{n=0}^{+\\infty}a_nx^n \\] <p>\u79f0 \\(F(x)\\) \u4e3a\u4e00\u4e2a\u4ee5 \\(x\\) \u4e3a\u672a\u5b9a\u5143\u7684\u5f62\u5f0f\u5e42\u7ea7\u6570\uff0c\u800c \\([x^n]F(x)=a_n\\)\u3002</p> <p>\u4e4b\u6240\u4ee5\u79f0\u5176\u4e3a\u5f62\u5f0f\u5e42\u7ea7\u6570\u800c\u4e0d\u662f\u5e42\u7ea7\u6570\uff0c\u56e0\u4e3a\u6211\u4eec\u5e76\u4e0d\u5173\u5fc3\u5176\u655b\u6563\u6027\uff0c\u4e5f\u4e0d\u5173\u5fc3 \\(x\\) \u53d6\u4f55\u7b49\u7684\u503c\uff0c\u53ef\u4ee5\u5c06\u5176\u770b\u4f5c\u662f\u4e00\u4e2a\u5360\u4f4d\u7b26\u3002</p> <p>\u6839\u636e\uff08\u591a\u9879\u5f0f\u8fd0\u7b97\u7684\uff09\u7ecf\u9a8c\uff0c\u53ef\u4ee5\u5b9a\u4e49\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u52a0\uff0c\u51cf\uff0c\u4e58\u8fd0\u7b97\uff1a</p> \\[ C(n)=A(n)\\pm B(n)\\Longleftrightarrow \\sum_{n=0}^{+\\infty}c_nx^n=\\qty(\\sum_{n=0}^{+\\infty}a_nx^n)\\pm\\qty(\\sum_{n=0}^{+\\infty}b_nx^n) \\] <p>\u800c</p> \\[ C(n)=A(n)B(n)\\Longleftrightarrow \\sum_{n=0}^{+\\infty}c_nx^n=\\qty(\\sum_{n=0}^{+\\infty}a_nx^n)\\qty(\\sum_{n=0}^{+\\infty}b_nx^n) \\]"}, {"location": "Algorithms/Counting/Algebra_1/#ogf", "title": "OGF", "text": "<p>\u6211\u4eec\u79f0\u5e8f\u5217 \\(\\ag{a_0,a_1,a_2,\\cdots, a_n\\cdots}\\) \u7684\u666e\u901a\u751f\u6210\u51fd\u6570\uff08OGF\uff09\u662f\u76f4\u63a5\u5bf9\u8fd9\u4e2a\u5e8f\u5217\u6784\u9020\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u7ed3\u679c\uff0c\u5373</p> \\[ \\sum_{n=0}^{+\\infty}a_nx^n \\] <p>\u8fd9\u6837\u7684\u5f62\u5f0f\u5982\u4f55\u7b80\u5316\u6211\u4eec\u7684\u8ba1\u7b97\uff1f\u4ece\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5168 \\(1\\) \u7684\u6570\u5217 \\(\\ag{1,1,1,1,\\cdots }\\) \u51fa\u53d1\uff0c\u4ee4 \\(F(x)\\) \u4e3a\u5176 OGF\uff0c\u5219</p> \\[ F(x)=\\sum_{n=0}^{+\\infty}x^n \\] <p>\u5206\u6790\u8fd9\u4e2a\u65e0\u7a77\u6c42\u548c\u7684\u65b9\u6cd5\u662f\u7ecf\u5178\u7684\u6270\u52a8\u6cd5</p> \\[ \\begin{aligned} F(x)&amp;=1+x+x^2+x^3+\\cdots\\\\ xF(x)&amp;=\\,\\, \\; \\; \\; \\;  \\; x+x^2+x^3+\\cdots\\\\ F(x)-xF(x)&amp;=1\\\\ \\end{aligned} \\] <p>\u4ece\u800c\u6709</p> \\[ F(x)=\\frac{1}{1-x} \\] <p>\u5373 \\(F(x)\\) \u4e3a \\(1-x\\) \u7684\u5f62\u5f0f\u5e42\u7ea7\u6570\u4e58\u6cd5\u9006\u3002</p> <p>\u6211\u4eec\u6307\u51fa\uff0c\u8fd9\u6837\u7684\u5206\u6790\u8981\u6c42 \\(F(x)\\) \u662f\u6536\u655b\u7684\uff0c\u4f46\u7531\u4e8e \\(x\\) \u662f\u4e00\u4e2a\u5360\u4f4d\u7b26\uff0c\u6211\u4eec\u5e76\u4e0d\u5173\u5fc3\u5176\u6536\u655b\u6027\uff0c\u4e0d\u59a8\u76f4\u63a5\u5047\u8bbe\u5b83\u5c31\u662f\u6536\u655b\u7684\u3002</p> <p>\u5982\u679c\u4f60\u4e0d\u80fd\u63a5\u53d7\u8fd9\u4e2a\u770b\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u5c31\u628a\u8fd9\u5f0f\u770b\u4f5c\u662f \\(\\displaystyle \\sum_{n=0}^{+\\infty}x^n\\) \u7684\u4e00\u79cd\u7f29\u5199\uff0c\u6211\u4eec\u7528\u8fd9\u6837\u7684\u7f29\u5199\u5f0f\u6765\u907f\u514d\u6bcf\u6b21\u90fd\u5199\u51fa\u4e00\u957f\u4e32\u5f0f\u5b50\u7684\u9ebb\u70e6\uff0c\u5e76\u5728\u6700\u540e\u6c42\u503c\u7684\u65f6\u5019\u5c06\u5f97\u5230\u7684\u5f0f\u5b50\u91cd\u65b0\u5c55\u5f00\u6210\u65e0\u7a77\u548c\u5f0f\u3002\u5bf9\u4e8e\u8fd9\u79cd\u53d8\u91cf\u548c\u5e38\u6570\u4f5c\u6709\u9650\u6b21\u52a0\u51cf\u4e58\u9664\uff0c\u6216\u67d0\u4e9b\u91cd\u8981\u7684\u7279\u6b8a\u8fd0\u7b97\uff08\u5982\u9636\u4e58\uff09\u6240\u5f97\u5230\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u79f0\u5176\u4e3a\u5c01\u95ed\u5f62\u5f0f\u3002</p> <p>\u8fd9\u6837\u7684\u4e00\u4e2a\u65e0\u7a77\u5e42\u7ea7\u6570\u6536\u655b\u5230\u4e00\u4e2a\u5c01\u95ed\u5f62\u5f0f\u7684\u6837\u5b50\u5f88\u5bb9\u6613\u8ba9\u6211\u4eec\u8054\u60f3\u5230 Maclaurin \u7ea7\u6570\u3002\u4e8e\u662f\u6211\u4eec\u7acb\u5373\u7531 Maclaurin \u7ea7\u6570\u5f97\u5230\u4e00\u7cfb\u5217\u7684\u6570\u5217\u53ca\u5176\u5bf9\u5e94 OGF \u7684\u5c01\u95ed\u5f62\u5f0f\uff1a</p> \\[ \\begin{array}{ccc} \u6570\u5217 &amp;\\text{OGF} &amp;\u5c01\u95ed\u5f62\u5f0f\\\\ \\ag{1,1,1,\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}x^k &amp;\\dfrac{1}{1-x}\\\\ \\ag{1,c,c^2,c^3,\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}c^kx^k &amp;\\dfrac{1}{1-cx}\\\\ \\ag{1,1,\\frac{1}{2},\\frac{1}{6},\\cdots, \\frac{1}{n!},\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\dfrac{1}{k!}x^k &amp;\\mathrm{e}^x\\\\ \\ag{\\displaystyle\\binom{n}{0},\\binom{n}{1},\\binom{n}{2},\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\binom{n}{k}x^k &amp;(1+x)^n\\\\  \\ag{0,1,-\\frac{1}{2},\\frac{1}{3},-\\frac{1}{4},\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\dfrac{(-1)^k}{k+1}x^{k+1} &amp;\\ln(1+x)\\\\ \\ag{0,1,\\frac{1}{2},\\frac{1}{3},\\frac{1}{4},\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\dfrac{1}{k+1}x^{k+1} &amp;\\ln(1-x)\\\\ \\end{array} \\] <p>\u8fd9\u4e9b\u5e8f\u5217\u4e0e\u751f\u6210\u51fd\u6570\u4e4b\u95f4\u7684\u5bf9\u5e94\u662f\u63a5\u4e0b\u6765\u7684\u57fa\u7840\u3002</p>"}, {"location": "Algorithms/Counting/Algebra_1/#_2", "title": "\u4e8c\u9636\u7ebf\u6027\u9012\u63a8", "text": ""}, {"location": "Algorithms/Counting/Algebra_1/#_3", "title": "\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u901a\u9879", "text": "<p>\u4e8b\u5230\u5982\u4eca\uff0c\u6211\u4eec\u8fd8\u4e0d\u77e5\u9053\u8fd9\u6837\u7684\u5de5\u5177\u600e\u4e48\u7b80\u5316\u6211\u4eec\u7684\u8ba1\u7b97\u3002\u6211\u4eec\u4ece\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u5f15\u5165\uff1a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u3002</p> <p>\u8003\u8651\u6590\u6ce2\u90a3\u5951\u6570\u5217 \\(f_i\\) \u7684 OGF</p> \\[ F(x)=\\sum_{i=0}^{+\\infty}f_ix^i \\] <p>\u6211\u4eec\u77e5\u9053\uff0c\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u9012\u63a8\u516c\u5f0f\u662f \\(f_{i}=f_{i-1}+f_{i-2}\\)\uff0c\u5176\u4e2d \\(f_0=0,f_1=1\\)\uff0c\u90a3\u4e48\u5c31\u6709</p> \\[ \\begin{aligned} F(x)&amp;=0+1x+1x^2+2x^3+3x^4+\\cdots\\\\ xF(x)&amp;=\\,\\, \\; \\; \\; \\;  \\; 0x+1x^2+1x^3+2x^4+\\cdots\\\\ x^2F(x)&amp;=\\,\\, \\; \\; \\; \\;  \\; \\,\\, \\; \\; \\; \\;  \\;\\, \\, \\; 0x^2+1x^3+1x^4+\\cdots \\\\ \\end{aligned} \\] <p>\u6240\u4ee5\u662f</p> \\[ F(x)=xF(x)+x^2F(x)+x \\] <p>\u5f97\u5230\u7684\u662f \\(F(x)=\\dfrac{x}{1-x-x^2}\\)\u3002</p> <p>\u4f46\u662f\u8fd9\u6709\u4ec0\u4e48\u7528\uff1f\u8003\u8651\u901a\u8fc7\u4e00\u4e9b\u624b\u6bb5\u53cd\u5411\u5f97\u5230\u5b83\u7684\u901a\u9879\u3002</p> <p>\u5c1d\u8bd5\u628a \\(F(x)\\) \u5206\u89e3\u6210\u82e5\u5e72\u4e2a\u5f62\u5982 \\(\\dfrac{1}{1-cx^k}\\) \u7684\u5206\u5f0f\u4e4b\u548c\uff0c\u8bbe \\(x_1,x_2,a,b\\) \u4f7f\u5f97</p> \\[ \\frac{x}{1-x-x^2}=\\frac{x}{(x-x_1)(x-x_2)}=\\frac{a}{x-x_1}+\\frac{b}{x-x_2} \\] <p>\u53ef\u4ee5\u89e3\u5f97 \\(x_1=\\frac{-\\sqrt 5-1}{2},x_2=\\frac{\\sqrt 5-1}{2}\\)</p> <p>\u518d\u8003\u8651</p> \\[ \\frac{x}{(x-x_1)(x-x_2)}=\\frac{a}{x-x_1}+\\frac{b}{x-x_2} \\] <p>\u8fd9\u8bf4\u660e \\(a(x-x_2)+b(x-x_1)=x\\)</p> <p>\u90a3\u4e48\u5c31\u6709</p> \\[ \\begin{cases} a+b=1\\\\ ax_2+bx_1=0\\\\ \\end{cases} \\] <p>\u7ecf\u8fc7\u89e3\u65b9\u7a0b\u53ef\u4ee5\u89e3\u51fa</p> \\[ a=\\frac{5-\\sqrt 5}{10},b=\\frac{5+\\sqrt 5}{10} \\] <p>\u63a5\u4e0b\u6765\u5c31\u662f\u8981\u8ba1\u7b97</p> \\[ [x^n]\\qty(\\frac{a}{x-x_1}+\\frac{b}{x-x_2}) \\] <p>\u628a\u5b83\u53d8\u6210\u4e24\u4e2a \\(\\frac{1}{1-cx^k}\\) \u7684\u548c\u7684\u6837\u5b50\uff0c\u90a3\u5c31\u662f</p> \\[ [x^n]\\frac{-\\frac{a}{x_1}}{1-\\frac{x}{x_1}}+[x^n]\\frac{-\\frac{b}{x_2}}{1-\\frac{x}{x_2}} \\] <p>\u7b49\u4e8e</p> \\[ -\\qty(\\dfrac{a}{x_1}\\cdot \\frac{1}{x_1^n})-\\qty(\\dfrac{b}{x_2}\\cdot \\frac{1}{x_2^n}) \\] <p>\u7ecf\u8fc7\u6574\u7406\u5373\u5f97</p> \\[ [x^n]F(x)=\\frac{\\sqrt 5}{5}\\qty[\\qty(\\frac{1+\\sqrt 5}{2})^n-\\qty(\\frac{1-\\sqrt 5}{2})^n] \\]"}, {"location": "Algorithms/Counting/Algebra_1/#_4", "title": "\u80fd\u4e0d\u80fd\u518d\u7ed9\u529b\u4e00\u70b9\u554a\uff1f", "text": "<p>\u6211\u4eec\u8bd5\u56fe\u5bf9\u4e00\u822c\u7684\u4e8c\u9636\u7ebf\u6027\u9012\u63a8\u5f0f\u89e3\u51fa\u5176\u901a\u9879\u516c\u5f0f\uff0c\u5373\u6211\u4eec\u5df2\u77e5 \\(f_0,f_1\\)\uff0c\u4e14\u5bf9\u4e8e \\(i\\ge 2\\) \u6709 \\(f_i=af_{i-1}+bf_{i-2}\\)\u3002</p> <p>\u6709</p> \\[ [x^n]F(x)=a\\cdot [x^n]xF(x)+b\\cdot [x^n]x^2F(x) \\] <p>\u52a0\u4e0a\u7cfb\u6570\u8865\u6b63\uff0c\u5373</p> \\[ F(x)=axF(x)+bx^2F(x)+(f_1-f_0)x \\] <p>\u4e00\u6837\u6709</p> \\[ F(x)=\\frac{(f_1-f_0)x}{1-ax-bx^2} \\] <p>\u6211\u4eec\u8981\u627e\u5230 \\(\\lambda_0,\\lambda_1\\) \u4f7f\u5f97 \\((1-\\lambda_0x)(1-\\lambda_1x)=1-ax-bx^2\\)\uff0c\u5c55\u5f00\u6bd4\u5bf9\u7cfb\u6570\u53ef\u5f97 \\(\\lambda_0\\lambda_1=-b,\\lambda_0+\\lambda_1=a\\)\u3002</p> <p>\u9006\u7528\u97e6\u8fbe\u5b9a\u7406\uff0c\u8fd9\u5c31\u662f\u8bf4 \\(\\lambda_0,\\lambda_1\\) \u662f\u65b9\u7a0b \\(\\lambda^2-a\\lambda -b=0\\) \u7684\u4e24\u6839<sup>1</sup>\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u521d\u59cb\u4e24\u9879\u7684\u7cfb\u6570\u4fee\u6b63\uff0c\u90a3\u4e48\u4efb\u610f \\(\\forall p,q\\in\\mathbb C,F(x)=\\dfrac{p}{1-\\lambda_0x}+\\dfrac{q}{1-\\lambda_1x}\\) \u90fd\u662f\u4e00\u4e2a\u53ef\u80fd\u7684 \\(\\text{OGF}\\)\u3002</p> <p>\u8003\u8651\u6700\u5f00\u59cb\u7684\u7cfb\u6570\u4fee\u6b63\uff0c\u6211\u4eec\u628a \\(p,q\\) \u89e3\u51fa\u6765\u3002</p> \\[ p(1-\\lambda_1x)+q(1-\\lambda_0)x=(f_1-f_0)x \\] <p>\u4e5f\u5c31\u662f</p> \\[ p+q=0,-p\\lambda_1-q\\lambda_0=f_1-f_0 \\] <p>\u4ece\u800c\u53ef\u4ee5\u89e3\u51fa \\(p,q\\)\uff0c\u6700\u540e\u7684\u901a\u9879\u5373 \\(f_k=p^k\\lambda_0^k+q^k\\lambda_1^k\\)\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u8fdb\u4e00\u6b65\u89e3\u51b3 \\(k\\) \u9636\u7684\u5e38\u7cfb\u6570\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\u95ee\u9898\uff0c\u4e0d\u8fc7\u6682\u65f6\u5230\u6b64\u4e3a\u6b62\u3002</p>"}, {"location": "Algorithms/Counting/Algebra_1/#catlan", "title": "Catlan \u6570", "text": "<p>\u5b9a\u4e49 \\(c_n\\) \u4e3a \\(n\\) \u5bf9\u62ec\u53f7\u7ec4\u6210\u7684\u5408\u6cd5\u62ec\u53f7\u5e8f\u5217\u65b9\u6848\u6570\uff0c\\(c_0=1\\)\u3002</p> <p>\u90a3\u4e48\u6709</p> \\[ c_{n+1}=\\sum_{i=0}^{n}c_ic_{n-i} \\] <p>\u7ec4\u5408\u610f\u4e49\u5373\u8003\u8651 <code>(x)y</code>\uff0c\u679a\u4e3e \\(x\\) \u7684\u62ec\u53f7\u5bf9\u6570\u3002</p> <p>\u8fd9\u5c31\u662f\u8bf4\uff0c\u8bbe \\(C(x)\\) \u4e3a Catlan \u6570\u5e8f\u5217\u7684 \\(\\text{OGF}\\)\uff0c\u90a3\u4e48\u6709</p> \\[ [x^{k+1}]C(x)=[x^k]C^2(x) \\] <p>\u8fd9\u5c31\u662f\u8bf4\uff1a</p> \\[ [x^k]\\qty(\\frac{C(x)-1}{x})=[x^k]C^2(x) \\] <p>\u89e3\u5f97</p> \\[ C(x)=\\frac{1\\pm \\sqrt{1-4x}}{2x} \\]"}, {"location": "Algorithms/Counting/Algebra_1/#_5", "title": "\u65e0\u7a77\u6c42\u548c\u7684\u7cfb\u6570\u655b\u6563\u6027", "text": "<p>\u6211\u4eec\u6c42\u51fa \\(C(x)\\) \u7684\u4e24\u4e2a\u89e3\uff0c\u4f46\u6211\u4eec\u7a76\u7adf\u8be5\u53d6\u54ea\u4e2a\u89e3\uff1f\u6211\u4eec\u5f15\u5165\u65e0\u7a77\u6c42\u548c\u6536\u655b\u7684\u6982\u5ff5\uff1a</p> <ul> <li>\u4e00\u4e2a\u65e0\u7a77\u6c42\u548c\u6536\u655b\uff0c\u5f53\u4e14\u4ec5\u5f53\u5bf9\u4e8e\u4efb\u610f\u5927\u7684 \\(n\\)\uff0c\u5176\u524d \\(n\\) \u9879\u7cfb\u6570\u5747\u6536\u655b\u3002</li> <li>\u4e00\u4e2a\u65e0\u7a77\u6c42\u548c\u7684\u7ed3\u679c\u662f\u65e0\u7a77\u591a\u9879\u5f0f \\(S(x)\\)\uff0c\u5f53\u4e14\u4ec5\u5f53\u5bf9\u4e8e\u4efb\u610f\u5927\u7684 \\(n\\)\uff0c\u5176\u524d \\(n\\) \u9879\u7cfb\u6570\u76f8\u540c\u3002</li> </ul> <p>\u90a3\u4e48\u6765\u8003\u5bdf \\([x^0]C(x)\\)\uff0c\u5f53\u53d6 \\(\\dfrac{1+\\sqrt{1-4x}}{2x}\\) \u65f6\uff0c\\([x^0]C(x)\\) \u4e3a</p> \\[ \\lim_{x\\rightarrow 0}\\frac{1+\\sqrt{1-4x}}{2x} \\] <p>\u5de6\u53f3\u6781\u9650\u5206\u522b\u4e3a \\(-\\infty,+\\infty\\)\uff0c\u6b64\u6781\u9650\u4e0d\u5b58\u5728\uff0c\u820d\u53bb\u3002\u56e0\u4e3a\u6570\u5217\u5b58\u5728\uff0c\u6240\u4ee5\u5fc5\u5b9a\u6709\u4e00\u6839\u6b63\u786e\uff0c\\(C(x)=\\dfrac{1-\\sqrt{1-4x}}{2x}\\)\u3002\u6b63\u786e\u6027\u4e5f\u53ef\u4ee5\u81ea\u5df1\u9a8c\u8bc1\u4e00\u4e0b\u3002</p> <p>\u901a\u8fc7\u5e7f\u4e49\u4e8c\u9879\u5f0f\u5b9a\u7406\u62c6\u5f00\u6839\u53f7\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u6f02\u4eae\u7684\u901a\u9879\uff1a $$ [x^n]C(x)=\\dfrac{1}{n+1}\\binom{2n}{n} $$</p> <ol> <li> <p>\u8fd9\u4e2a\u65b9\u7a0b\u5c31\u662f\u901a\u5e38\u6240\u8bf4\u7684\u7279\u5f81\u65b9\u7a0b\u3002\u00a0\u21a9</p> </li> </ol>"}, {"location": "Algorithms/Counting/Algebra_2/", "title": "Algebra 2", "text": "<p>\u3053\u308c\u304b\u3089\u50d5\u3089\u306f</p> <p>\u9003\u308c\u3089\u308c\u306a\u3044\u81ea\u7531\u306e\u679c\u3066\u306b</p> <p>\u5b88\u3089\u308c\u8a31\u3055\u308c\u3066 \u751f\u304d\u3066\u3044\u304f\u306e\u3060</p> \\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\ag[1]{\\left\\langle#1\\right\\rangle} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\deg{\\operatorname{deg}} \\newcommand\\pcnt{\\operatorname{popcount}} \\newcommand\\class{\\mathcal} \\] <p>\u4e3b\u8981\u662f\u65e0\u6807\u53f7\u4f53\u7cfb\u4e0b\u7684\u5185\u5bb9\u3002</p>"}, {"location": "Algorithms/Counting/Algebra_2/#_1", "title": "\u7ec4\u5408\u7c7b", "text": ""}, {"location": "Algorithms/Counting/Algebra_2/#_2", "title": "\u5b9a\u4e49", "text": "<p>\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u7ec4\u5408\u7c7b \\(\\mathcal A\\) \u662f\u4e00\u4e2a\u53ef\u6570\u96c6\u5408\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e00\u4e9b\u7ec4\u5408\u5bf9\u8c61\uff0c\u4ee5\u53ca\u4e00\u4e2a\u9644\u5e26\u7684\u5927\u5c0f\u51fd\u6570 \\(|\\cdot|:\\mathcal A\\rightarrow \\mathbb N\\)\u3002\u8fd9\u4e2a\u5927\u5c0f\u51fd\u6570\u7684\u4f8b\u5b50\u5c31\u662f\u5e8f\u5217\u957f\u5ea6\uff0c\u6811\u7684\u8282\u70b9\u6570\u4e4b\u7c7b\u7684\u3002</p> <p>\u82e5\u5bf9\u4e8e\u81ea\u7136\u6570 \\(n\\)\uff0c\\(A_n=\\operatorname{card}\\qty(\\{|\\alpha |=n,\\alpha \\in \\mathcal A\\})\\)\uff0c\u5219 \\(A\\) \u79f0\u4e3a \\(\\mathcal A\\) \u7684\u8ba1\u6570\u5e8f\u5217\u3002\u4e5f\u5c31\u662f \\(A_n\\) \u5c31\u4ee3\u8868 \\(\\mathcal A\\) \u91cc\u5927\u5c0f\u4e3a \\(n\\) \u7684\u5143\u7d20\u6709\u51e0\u4e2a\u3002</p> <p>\u4e00\u4e2a\u8ba1\u6570\u5e8f\u5217\u7684 OGF \u5c31\u662f\u5f62\u5f0f\u5e42\u7ea7\u6570</p> \\[ A(z)=\\sum_{i\\in \\mathbb N}A_iz^i \\] <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u67d0\u4e2a\u7ec4\u5408\u7c7b \\(\\mathcal A\\)\uff0c\u5176 OGF \u53ef\u4ee5\u5199\u6210</p> \\[ A(z)=\\sum_{\\alpha \\in \\mathcal A} z^{|\\alpha|} \\] <p>\u8fd9\u88ab\u79f0\u4e3a\u5e42\u8868\u793a\u3002</p> <p>\u6211\u4eec\u5b9a\u4e49\u7ec4\u5408\u7c7b \\(\\mathcal A,\\mathcal B\\) \u7684\u4e0d\u4ea4\u5e76\u4e3a \\(\\mathcal A+\\mathcal B\\)\u3002</p> <p>\u5b9a\u4e49\u4e24\u4e2a\u7ec4\u5408\u5bf9\u8c61 \\(\\alpha,\\beta\\) \u7684\u6709\u5e8f\u62fc\u63a5 \\((\\alpha, \\beta)\\) \u6709 \\(|(\\alpha,\\beta)|=|\\alpha|+|\\beta|\\)\u3002\u7ec4\u5408\u7c7b \\(\\class A,\\class B\\) \u7684\u7b1b\u5361\u5c14\u79ef \\(\\class A\\times \\class B\\) \u662f \\(\\{(\\alpha, \\beta)|\\alpha \\in \\class A, \\beta\\in \\class B\\}\\)\u3002</p> <p>\u7531\u5b9a\u4e49\u6211\u4eec\u77e5\u9053</p> \\[ \\class C=\\class A+\\class B\\Longleftrightarrow C(x)=A(x)+B(x)\\\\ \\class C=\\class A\\times \\class B\\Longleftrightarrow C(x)=A(x)\\times B(x) \\] <p>\u8bb0 \\(\\class E=\\{\\epsilon\\}\\) \u662f\u53ea\u7531\u4e00\u4e2a\u5927\u5c0f\u4e3a \\(0\\) \u7684\u5143\u7d20\u6784\u6210\u7684\u7ec4\u5408\u7c7b\uff0c\\(E(z)=1\\)\u3002\u4e14\u5bf9\u4e8e\u4efb\u610f\u7ec4\u5408\u7c7b \\(\\class A\\)\uff0c\u89c4\u5b9a \\(\\class A^0=\\class E\\)\u3002</p> <p>\u8bb0 \\(\\class Z\\) \u662f\u53ea\u7531\u4e00\u4e2a\u5927\u5c0f\u4e3a \\(1\\) \u7684\u5143\u7d20\u6784\u6210\u7684\u7ec4\u5408\u7c7b\uff0c\\(Z(z)=z\\)\u3002</p>"}, {"location": "Algorithms/Counting/Algebra_2/#_3", "title": "\u7ec4\u5408\u7c7b\u7684\u6784\u9020", "text": "<p>\u6211\u4eec\u8bd5\u56fe\u76f4\u63a5\u4ece\u7ec4\u5408\u7c7b\u6784\u9020\u51fa\u5bf9\u5e94\u7684\u751f\u6210\u51fd\u6570\uff0c\u4e3a\u6b64\uff0c\u6211\u4eec\u9700\u8981\u8003\u5bdf\u4e00\u4e9b\u7ec4\u5408\u7c7b\u7684\u57fa\u672c\u6784\u9020\u3002</p>"}, {"location": "Algorithms/Counting/Algebra_2/#sequence", "title": "Sequence \u6784\u9020", "text": "<p>\u6211\u4eec\u6709\u4e00\u4e2a\u7ec4\u5408\u7c7b \\(\\class A\\)\uff0c\u73b0\u5728\u6211\u4eec\u8981\u7528\u5b83\u751f\u6210\u4e00\u4e2a\u4e0d\u5b9a\u957f\u5e8f\u5217\uff0c\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u90fd\u662f \\(\\class A\\) \u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\uff0c\u4e0d\u59a8\u628a\u8fd9\u4e2a\u64cd\u4f5c\u751f\u6210\u7684\u4e0d\u5b9a\u957f\u5e8f\u5217\u7684\u7ec4\u5408\u7c7b\u79f0\u4e3a \\(\\textsf{SEQ}(\\class A)\\)\uff0c\u5219</p> \\[ \\textsf{SEQ}(\\class A)=\\class E+\\class A+\\class A\\times \\class A+\\cdots =\\sum_{k=0}^{\\infty}\\class A^k \\] <p>\u5bf9\u4e8e\u8bb0 \\(\\class B=\\textsf{SEQ}(\\class A)\\)\uff0c\u8fd9\u5c31\u662f\u8bf4</p> \\[ B(x)=\\sum_{k=0}^{\\infty}A^k(x)=\\frac{1}{1-A(x)} \\]"}, {"location": "Algorithms/Counting/Algebra_2/#amplification", "title": "Amplification \u6784\u9020", "text": "<p>\u7ec4\u5408\u7c7b \\(\\class A\\) \u7684 Amplification \u6784\u9020 \\(\\textsf{AMP}(\\class A)\\) \u662f\u7531\u6240\u6709 \\(\\class A\\) \u4e2d\u7684\u5143\u7d20 \\(\\alpha\\)\uff0c\u5c06\u81ea\u5df1\u590d\u5236\u5728\u81ea\u5df1\u540e\u9762\u4efb\u610f\u591a\u6b21\u7ec4\u6210\u7684\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff1a</p> \\[ \\textsf{AMP}(\\class A)=\\bigcup_{\\alpha \\in \\class A}\\qty(\\textsf{SEQ}(\\{\\alpha\\})) \\] <p>\u4e00\u4e2a\u5143\u7d20 \\(\\alpha\\) \u5c06\u81ea\u5df1\u590d\u5236 \\(k\\) \u904d\uff0c\u90a3\u4e48\u65b0\u7684\u5143\u7d20\u5927\u5c0f\u5e94\u4e3a \\(k|\\alpha|\\)\uff0c\u6240\u4ee5\u6b64\u53d8\u6362\u6709\uff1a</p> \\[ \\class B=\\textsf{AMP}(\\class{A})\\Longleftrightarrow B=\\sum_{i\\ge 0}A(z^i) \\] <p>\u66f4\u5e38\u7528\u7684\u662f\u5176\u5e26\u9650\u5236\u7684\u5f62\u5f0f\uff0c\u5373 \\(\\textsf{AMP}_k\\) \u6784\u9020\u3002</p> \\[ \\textsf{AMP}_k(\\class A)=\\{\\overbrace{\\alpha\\alpha\\alpha\\alpha\\cdots\\alpha}^{\\text{\u6070\u597d }k\\text{ \u4e2a}}:\\alpha \\in \\class A\\} \\] <p>\u6240\u4ee5</p> \\[ \\class B=\\textsf{AMP}_k(\\class{A})\\Longleftrightarrow B=A(z^k) \\]"}, {"location": "Algorithms/Counting/Algebra_3/", "title": "Algebra 3", "text": "<p>\u308f\u305f\u3057\u3000\u308f\u305f\u3057\u3000\u308f\u305f\u3057\u306f\u3053\u3053\u306b\u3044\u308b</p> <p>\u5b64\u72ec\u7684 \u5b64\u72ec\u7684 \u5b64\u72ec\u7684\u6211\u5c31\u5b58\u5728\u4e8e\u6b64\u554a</p> <p>\u6bb4\u308a\u66f8\u304d\u307f\u305f\u3044\u306a\u97f3\u3000\u51fa\u305b\u306a\u3044\u72b6\u614b\u3067</p> <p>\u53eb\u3093\u3060\u3088\u597d\u4f3c\u6742\u4e71\u65e0\u7ae0\u7684\u97f3\u5f8b \u4e0d\u6210\u58f0\u5730\u5450\u558a\u7740</p> \\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\ag[1]{\\left\\langle#1\\right\\rangle} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\ol[1]{\\overline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\deg{\\operatorname{deg}} \\newcommand\\pcnt{\\operatorname{popcount}} \\]"}, {"location": "Algorithms/Counting/Algebra_3/#egf", "title": "EGF", "text": "<p>\u5e8f\u5217 \\(\\ag{a_0,a_1,a_2,\\cdots}\\) \u7684 EGF \u662f</p> \\[ \\sum_{i=0}^{+\\infty}\\frac{a_i}{i!}x^i \\] <p>\u5373\u5e8f\u5217 \\(\\ag{\\frac{a_0}{1},\\frac{a_1}{1},\\frac{a_2}{2},\\frac{a_3}{6},\\frac{a_4}{24},\\cdots }\\) \u7684 OGF\uff0c\u4e5f\u5c31\u662f\uff0c\u5728\u7b2c \\(i\\) \u9879\u989d\u5916\u9664\u53bb\u4e00\u4e2a \\(i!\\)\uff0c\u5e38\u7528\u4e8e\u6709\u6807\u53f7\u8ba1\u6570\u4f53\u7cfb\u4e4b\u4e2d\u3002</p> <p>\u6ce8\u610f\u5e8f\u5217 \\(\\ag{1,1,1,\\cdots, 1}\\) \u7684 EGF \u4e3a \\(\\exp(x)\\)\uff0c\u8fd9\u4e5f\u662f\u5176 EGF \u4e4b\u540d\u7684\u7531\u6765\u3002\u540c\u6837\uff0c\u6211\u4eec\u7acb\u5373\u80fd\u5bfc\u51fa\u4e00\u6279 EGF \u7684\u5c01\u95ed\u5f62\u5f0f\uff1a</p> \\[ \\begin{array}{ccc} \u6570\u5217 &amp;\\text{EGF} &amp;\u5c01\u95ed\u5f62\u5f0f\\\\ \\ag{1,1,1,\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\frac{1}{k!}x^k &amp;\\exp(x)\\\\ \\ag{1,c,c^2,c^3,\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\frac{c^k}{k!}x^k &amp;\\exp(cx)\\\\ \\ag{1,0,1,0,1,0\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\dfrac{1}{(2k)!}x^{2k} &amp;\\dfrac{\\exp(x)+\\exp(-x)}{2}=\\cosh x\\\\ \\ag{0,1,0,1,0,1\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\dfrac{1}{(2k+1)!}x^{2k+1}&amp;\\dfrac{\\exp(x)-\\exp(-x)}{2}=\\sinh x\\\\  \\ag{1,-1,1,-1,1,-1,\\cdots} &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\dfrac{1}{k!}(-x)^{k} &amp;\\exp(-x)\\\\ \\ag{1,a^{\\ul{1}},a^\\ul{2},a^\\ul{3},a^\\ul4,\\cdots } &amp;\\displaystyle\\sum_{k=0}^{+\\infty}\\dfrac{a^\\ul k}{k!}x^{k} &amp;(1+x)^a\\\\ \\end{array} \\]"}, {"location": "Algorithms/Counting/Calculating_0/", "title": "Calculating 0", "text": "<p>\u5fc3\u306f\u900f\u660e\u3000\u8840\u6db2\u306f\u9152</p> <p>\u61a7\u308c\u306e\u8a69\u306f\u795e\u69d8\u307f\u305f\u3044</p> <p>\u672c\u6587\u4ea6\u53ef\u89c1\u4e8e\u6211\u7684\u53e6\u4e00\u4e2a\u535a\u5ba2\u3002</p>"}, {"location": "Algorithms/Counting/Calculating_0/#fft", "title": "FFT", "text": "<p>\u591a\u9879\u5f0f\u7684\u52a0\u6cd5\uff0c\u51cf\u6cd5\u663e\u7136\u6709 \\(O(n)\\) \u7684\u505a\u6cd5\uff0c\u800c\u8ba1\u7b97\u591a\u9879\u5f0f\u4e58\u6cd5\u5219\u9700\u8981 \\(O(n^2)\\) \u7684\u65f6\u95f4\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e9b\u66f4\u5feb\u7684\u505a\u6cd5\u3002</p> <p>\u6211\u4eec\u6709\u4e00\u4e2a\u7ed3\u8bba\uff1a</p> <p>\\(n+1\\) \u4e2a\u4e0d\u540c\u7684\u70b9\u53ef\u4ee5\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a \\(n\\) \u6b21\u591a\u9879\u5f0f\u3002</p> <p>\u4e00\u4e2a \\(n\\) \u6b21\u591a\u9879\u5f0f \\(F(x)\\) \u5c31\u53ef\u4ee5\u88ab\u5199\u4f5c</p> \\[ \\{(x_0,F(x_0)),(x_1,F(x_1)),\\ldots, (x_n,F(x_n)\\} \\nonumber \\] <p>\u8fd9\u88ab\u79f0\u4f5c\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a\uff0c\u800c\u539f\u6765\u7684\u8868\u793a\u6cd5\u88ab\u79f0\u4e3a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u793a\u3002</p> <p>\u8bc1\u660e\uff1a</p> <p>\u5047\u8bbe \\(F(x)=p_0+p_1x^1+p_2x^2+\\ldots + p_nx^n\\)</p> <p>\u90a3\u4e48\u6211\u4eec\u628a \\(n+1\\) \u4e2a\u4e0d\u540c\u7684 \\(x\\) \u4ee3\u5165\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff1a</p> \\[ \\left\\{\\begin{aligned} F(x_0)&amp;=p_0+p_1x_0+p_2x_0^2+\\ldots+p_nx_0^n\\\\ F(x_1)&amp;=p_0+p_1x_1+p_2x_1^2+\\ldots+p_nx_1^n\\\\ F(x_2)&amp;=p_0+p_1x_2+p_2x_2^2+\\ldots+p_nx_2^n\\\\ &amp;\\cdots\\\\ F(x_n)&amp;=p_0+p_1x_n+p_2x_n^2+\\ldots+p_nx_n^n\\\\ \\end{aligned}\\right. \\nonumber \\] <p>\u8fd9\u53ef\u4ee5\u88ab\u5199\u6210\u77e9\u9635\u7684\u5f62\u5f0f\uff1a</p> \\[ \\begin{bmatrix} F(x_0)\\\\ F(x_1)\\\\ F(x_2)\\\\ \\vdots\\\\ F(x_n)\\\\ \\end{bmatrix} = \\begin{bmatrix} 1 &amp;x_0 &amp;x_0^2 &amp;\\cdots &amp;x_0^n\\\\ 1 &amp;x_1 &amp;x_1^2 &amp;\\cdots &amp;x_1^n\\\\ 1 &amp;x_2 &amp;x_2^2 &amp;\\cdots &amp;x_2^n\\\\ \\vdots &amp;\\vdots &amp;\\vdots &amp;\\ddots &amp;\\vdots\\\\ 1 &amp;x_n &amp;x_n^2 &amp;\\cdots &amp;x_n^n\\\\ \\end{bmatrix} \\begin{bmatrix} p_0\\\\ p_1\\\\ p_2\\\\ \\vdots\\\\ p_n \\end{bmatrix} \\nonumber \\] <p>\u4e2d\u95f4\u7684\u662f\u8303\u5fb7\u8499\u5fb7\u77e9\u9635\uff0c\u7531\u4e8e\u6211\u4eec\u9009\u7684 \\(n+1\\) \u4e2a \\(x\\) \u4e24\u4e24\u4e0d\u540c\uff0c\u5219\u5176\u884c\u5217\u5f0f\u4e0d\u4e3a \\(0\\)\uff0c\u7ebf\u6027\u65b9\u7a0b\u7ec4\u6709\u552f\u4e00\u89e3\u3002</p> <p>\u90a3\u4e48\u5bf9\u4e8e\u4e24\u4e2a \\(n\\) \u6b21\u591a\u9879\u5f0f\uff0c\u6211\u4eec\u6c42\u51fa\u4ed6\u4eec\u5728 \\(2n+1\\) \u4e2a\u4e0d\u540c\u7684 \\(x\\) \u65f6\u7684\u53d6\u503c\uff0c\u7136\u540e\u628a\u5bf9\u5e94\u4f4d\u7f6e\u7684\u503c\u76f8\u4e58\uff0c\u7136\u540e\u518d\u8fd8\u539f\u4e3a\u7cfb\u6570\u8868\u793a\uff0c\u6211\u4eec\u5c31\u77e5\u9053\u4e86\u4e24\u4e2a\u591a\u9879\u5f0f\u76f8\u4e58\u7684\u7ed3\u679c\uff0c\u4e2d\u95f4\u76f8\u4e58\u7684\u8fc7\u7a0b\u662f \\(O(n)\\) \u7684\u3002</p> <p>\u552f\u4e00\u7684\u95ee\u9898\u662f\uff0c\u6211\u4eec\u600e\u4e48\u5728\u4f4e\u4e8e \\(O(n^2)\\) \u7684\u65f6\u95f4\u5185\u6c42\u51fa\u7cfb\u6570\u8868\u793a\u7684\u70b9\u503c\u8868\u793a/\u628a\u70b9\u503c\u8868\u793a\u8fd8\u539f\u4e3a\u7cfb\u6570\u8868\u793a\uff1f</p> <p>\u6211\u4eec\u6700\u5927\u7684\u7a81\u7834\u53e3\u5728\u4e8e\u53ef\u4ee5\u968f\u610f\u9009\u53d6\u521d\u503c\uff0c\u8ba9\u6211\u4eec\u5c1d\u8bd5\u501f\u52a9\u8fd9\u4e2a\u7279\u6027\u6765\u52a0\u901f\u6c42\u89e3\u3002</p> <p>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u8bbe\u6240\u8981\u64cd\u4f5c\u7684\u591a\u9879\u5f0f\u90fd\u662f \\(2^k-1\\) \u6b21\u7684\uff0c\u5982\u679c\u4e0d\u8db3\uff0c\u53ef\u4ee5\u5728\u9ad8\u6b21\u9879\u8865 \\(0\\)\u3002</p>"}, {"location": "Algorithms/Counting/Calculating_0/#dft", "title": "DFT", "text": ""}, {"location": "Algorithms/Counting/Calculating_0/#_1", "title": "\u5927\u81f4\u6d41\u7a0b", "text": "<p>\u4e00\u4e2a\u5173\u952e\u7684\u60f3\u6cd5\u662f\uff0c\u5982\u679c \\(f(x)\\) \u662f\u4e00\u4e2a\u5076\u51fd\u6570\uff0c\u90a3\u4e48 \\(f(x)=f(-x)\\)\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u8ba1\u7b97\u4e00\u4e2a\u70b9\u7684\u70b9\u503c\u5c31\u77e5\u9053\u4e86\u4e24\u4e2a\u70b9\u7684\u70b9\u503c\u3002</p> <p>\u5982\u679c \\(f(x)\\) \u662f\u4e2a\u5947\u51fd\u6570\uff0c\u5219 \\(f(x)=-f(-x)\\)\uff0c\u4ecd\u7136\u662f\u8ba1\u7b97\u4e00\u4e2a\u503c\u5373\u53ef\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u4e0d\u59a8\u628a \\(F\\) \u5206\u4e3a\u5947\u5076\u4e24\u90e8\u5206\uff0c\u5373\uff1a</p> \\[ \\begin{aligned} F(x)&amp;=a_0+a_1x+a_2x^2+\\cdots + a_nx^n\\\\ &amp;=(a_0+a_2x^2+\\cdots)+x(a_1+a_3x^2+\\cdots)\\\\ &amp;=F_e(x^2)+xF_o(x^2) \\end{aligned} \\nonumber \\] <p>\u90a3\u4e48</p> \\[ \\begin{aligned} F(x_i)&amp;=F_e(x^2)+xF_o(x^2)\\\\ F(-x_i)&amp;=F_e(x^2)-xF_o(x^2) \\end{aligned} \\nonumber \\] <p>\u518d\u5bf9 \\(F_e(x^2)\\) \u4e0e \\(F_o(x^2)\\) \u9012\u5f52\u8ba1\u7b97\u5373\u53ef\u3002</p> <p>\u7531\u4e8e\u6211\u4eec\u521d\u59cb\u9009\u53d6\u7684\u6240\u6709\u70b9\u5bf9\u90fd\u662f\u76f8\u53cd\u6570\uff0c\u90a3\u4e48\u9012\u63a8\u7684\u65f6\u5019\u5c31\u53ea\u5269\u4e0b \\(\\frac{n}{2}\\) \u4e2a\u70b9\u3002\u5982\u6b64\u9012\u5f52\u8ba1\u7b97\uff0c\u590d\u6742\u5ea6\u5373\u4e3a \\(O(n\\log n)\\)\u3002</p> <p>\u4f46\u662f\u4e0d\u96be\u6ce8\u610f\u5230\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5728\u9012\u5f52\u5b50\u95ee\u9898\u65f6\uff0c\u5b9e\u9645\u4e0a\u4ee3\u5165\u7684\u662f \\(x^2\\) \u800c\u4e0d\u662f \\(x\\)\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6ca1\u6709\u529e\u6cd5\u53d6\u76f8\u53cd\u6570\uff0c\u56e0\u4e3a\u5728\u5b9e\u6570\u57df\u5185\uff0c\\(x^2\\) \u603b\u5e94\u8be5\u662f\u6b63\u6570\u3002</p> <p>\u8ba9\u6211\u4eec\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u770b\u770b\u4e0a\u8ff0\u8fc7\u7a0b\u662f\u600e\u4e48\u505a\u7684\uff0c\u4ece\u800c\u8003\u5bdf\u6211\u4eec\u6240\u9009\u7684\u6570\u9700\u8981\u6709\u4ec0\u4e48\u6027\u8d28\u3002\u5047\u8bbe\u6211\u4eec\u8981\u5c06\u4e00\u4e2a\u4e09\u6b21\u591a\u9879\u5f0f \\(F(x)=-1-2x+x^2+x^3\\) \u8f6c\u4e3a\u70b9\u503c\u8868\u793a\uff0c\u4e3a\u6b64\u6211\u4eec\u9700\u8981\u6c42\u5176\u5728\u56db\u4e2a\u70b9 \\(x_0,-x_0,x_1,-x_1\\) \u7684\u503c\uff0c\u90a3\u4e48\u9996\u5148\u62c6\u6210\uff1a</p> \\[ \\begin{aligned} F_e(x^2)&amp;=-1+x^2\\\\ F_o(x^2)&amp;=-2+x^2\\\\ F(x)&amp;=F_e(x^2)+xF_o(x^2)\\\\ \\end{aligned} \\nonumber \\] <p>\u90a3\u4e48\uff0c\u6c42\u51fa \\(F_e(x_0^2)\\) \u4e0e \\(F_o(x_0^2)\\) \u7684\u503c\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u63a8\u51fa</p> \\[ \\begin{aligned} F(x_0)&amp;=F_e(x_0^2)+x_0F_o(x_0^2)\\\\ F(-x_0)&amp;=F_e(x_0^2)-x_0F_o(x_0^2)\\\\ \\end{aligned} \\nonumber \\] <p>\u800c \\(x_1\\) \u7684\u60c5\u51b5\u7c7b\u4f3c\u3002</p> \\[ \\begin{aligned} F(x_1)&amp;=F_e(x_1^2)+x_1F_o(x_1^2)\\\\ F(-x_1)&amp;=F_e(x_1^2)-x_1F_o(x_1^2)\\\\ \\end{aligned} \\nonumber \\] <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8981\u6c42 \\(F_e(x)\\) \u5728 \\(x_0^2\\) \u4e0e \\(x_1^2\\) \u5904\u7684\u503c\uff0c\u5e76\u4e14\u73b0\u5728 \\(x_1^2=-x_0^2\\)\uff0c\u6211\u4eec\u5148\u4e0d\u7ba1\u8fd9\u662f\u600e\u4e48\u505a\u5230\u7684\u3002\u8bb0 \\(F_e\\) \u4e3a \\(G\\)\u3002</p> <p>\u518d\u6b21\u7c7b\u4f3c\u5730\u62c6\u5f00\uff1a</p> \\[ \\begin{aligned} G_e(x^4)&amp;=-1\\\\ G_o(x^4)&amp;=1\\\\ G(x^2)&amp;=G_e(x^4)+x^2G_o(x^4) \\end{aligned} \\nonumber \\] <p>\u56e0\u4e3a \\(x_1^2=-x_0^2\\)\uff0c\u4e14\u6211\u4eec\u76f4\u63a5\u77e5\u9053 \\(G_e(x^4)\\) \u4e0e \\(G_o(x^4)\\) \u5c31\u662f\u5e38\u6570\uff0c\u6240\u4ee5\u7acb\u523b\u6709\uff1a</p> \\[ \\begin{aligned} G(x_0^2)=G_e(x^4)+x_0^2G_o(x^4)=-1+x_0^2\\\\ G(x_1^2)=G_e(x^4)-x_0^2G_o(x^4)=-1-x_0^2 \\end{aligned} \\nonumber \\] <p>\u5e76\u4e14\uff0c\\(F_o\\) \u7684\u60c5\u51b5\u4e5f\u7c7b\u4f3c\uff0c\u518d\u56de\u9000\u5373\u53ef\u9012\u63a8\u5b8c\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u7684\u4e00\u7ec4 \\(x\\) \u9700\u8981\u6ee1\u8db3\u7684\u6027\u8d28\u662f\uff1a</p> <ol> <li>\\(x_0,x_1,x_2,\\cdots,x_{2^k-1}\\)\uff0c\u5176\u4e2d \\(x_0,x_{2^{k-1}}\\) \u4e92\u4e3a\u76f8\u53cd\u6570\uff0c\\(x_1,x_{2^{k-1}+1}\\) \u4e92\u4e3a\u76f8\u53cd\u6570\u2026\u2026\uff08\u8fd9\u91cc\u7684\u987a\u5e8f\u4e0e\u4e0a\u9762\u7565\u6709\u4e0d\u540c\uff0c\u4e3a\u4e86\u5b9e\u73b0\u65b9\u4fbf\u4e0e\u9002\u914d\u4e0b\u9762\u7684\u5185\u5bb9\uff09</li> <li>\u4ee4\u6bcf\u4e2a\u6570\u90fd\u53d8\u4e3a\u5176\u5e73\u65b9\uff0c\u6b64\u65f6 \\(x_0^2=x_{2^{k-1}}^2\\)\uff0c\\(x_1^2=x_{2^{k-1}+1}^2\\)\u2026\u2026\uff0c\u6211\u4eec\u53bb\u6389\u6240\u6709\u91cd\u590d\u7684\u6570\uff0c\u53d8\u4e3a \\(x_0^2,x_1^2,x_3^2,\\cdots, x_{2^{k-1}-1}^2\\)\uff0c\u6b64\u65f6\u5982\u679c\u628a\u4ed6\u4eec\u91cd\u65b0\u6807\u5b9a\u4e3a \\(x_0',x_1',\\cdots, x_{2^{k-1}-1}'\\)\uff0c\u5b83\u4eec\u4ecd\u6ee1\u8db3 \\(1\\) \u4e2d\u7684\u6761\u4ef6\uff0c\u5e76\u4e14\u6bcf\u6b21\u91cd\u590d \\(2\\) \u76f4\u5230\u5e8f\u5217\u4e2d\u4ec5\u5269\u4e00\u4e2a\u6570\uff0c\u5b83\u4eec\u90fd\u6ee1\u8db3 \\(1\\) \u7684\u6761\u4ef6\u3002 </li> </ol> <p>\u5b9e\u6570\u57df\u663e\u7136\u6ca1\u6709\u529e\u6cd5\u8fbe\u6210\u4e0a\u8ff0\u6761\u4ef6\uff0c\u8003\u8651\u4ee4 \\(x\\) \u4e3a\u590d\u6570\u3002</p>"}, {"location": "Algorithms/Counting/Calculating_0/#_2", "title": "\u5355\u4f4d\u6839", "text": "<p>\u5728\u590d\u6570\u57df\u4e2d\uff0c\u4e00\u4e9b\u6ee1\u8db3\u6211\u4eec\u9700\u6c42\u7684\u6570\u662f\u5355\u4f4d\u6839\uff0c\u5e76\u4e14\u53ef\u4ee5\u8bc1\u660e\uff0c\u8fd9\u662f\u552f\u4e00\u6ee1\u8db3\u6211\u4eec\u9700\u6c42\u7684\u6570\u3002</p> <p>\u4ee5\u4e0b\u7684 \\(n\\) \u6307\u7684\u662f\u6211\u4eec\u6240\u9700\u7684\u591a\u9879\u5f0f\u7684\u9879\u6570\uff0c\u5373\u6b21\u6570\\(+1\\)\uff0c\u8fd9\u610f\u5473\u7740 \\(n\\) \u662f\u4e00\u4e2a \\(2\\) \u7684\u5e42\u3002</p> <p>\u4ee5\u5355\u4f4d\u5706\u70b9\u4e3a\u8d77\u70b9\uff0c\u5355\u4f4d\u5706\u7684 \\(n\\) \u7b49\u5206\u70b9\u4e3a\u7ec8\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\(n\\) \u4e2a\u590d\u6570\u3002\u6211\u4eec\u79f0 \\(n\\) \u6b21\u672c\u539f\u5355\u4f4d\u6839\u662f\u5b83\u4eec\u4e4b\u4e2d\u5e45\u89d2\u4e3a\u6b63\u4e14\u6700\u5c0f\u7684\u590d\u6570\uff0c\u4e5f\u5c31\u662f\uff1a</p> \\[ \\omega_n=\\cos\\frac{2\\pi}{n}+i\\sin\\frac{2\\pi}{n} \\nonumber \\] <p>\u6839\u636e\u6b27\u62c9\u516c\u5f0f\uff0c\u6211\u4eec\u5c06 \\(\\omega_n\\) \u5199\u4f5c \\(e^{i\\frac{2\\pi}{n}}\\)\uff08\u6216\u8005\u76f4\u63a5\u4ece\u590d\u6570\u4e58\u6cd5\u5c31\u662f\u65cb\u8f6c\u7684\u89d2\u5ea6\uff09\u53ef\u4ee5\u77e5\u9053\uff1a</p> \\[ \\begin{aligned} \\omega_n^k=\\cos\\frac{2k\\pi}{n}+i\\sin\\frac{2k\\pi}{n} \\end{aligned} \\nonumber \\] <p>\u4ed4\u7ec6\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\u51e0\u6761\u975e\u5e38\u597d\u7684\u6027\u8d28\uff1a</p> <ol> <li> <p>\\(\\omega_n^{k+\\frac{n}{2}}=-\\omega_n^k,k\\in \\mathbb N^+\\)</p> <p>\u8fd9\u6761\u6027\u8d28\u6211\u4eec\u628a\u524d\u9762\u7684\u5f0f\u5b50\u5c55\u5f00\u6210 \\(\\omega^{k}_n\\omega_n^{\\frac{n}{2}}\\)\uff0c\u518d\u628a\u540e\u9762\u7684\u4ee3\u5165\u4e0a\u5f0f\u5373\u53ef\u8bc1\u660e\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u6211\u4eec\u5982\u679c\u628a\u521d\u59cb\u7684 \\(x_0,x_1,x_2,\\cdots, x_n\\) \u9009\u4e3a \\(\\omega_n^{0},\\omega_n^{1},\\omega_n^{2},\\cdots, \\omega_n^{n-1}\\)</p> <p>\u90a3\u4e48\u8fd9\u5c31\u6ee1\u8db3\u4e0a\u9762\u6240\u9700\u7684\u7b2c\u4e00\u6761\u8981\u6c42\uff0c\\(\\omega_n^0\\) \u4e0e \\(\\omega_n^{\\frac{n}{2}}\\) \u662f\u4e00\u7ec4\uff0c\\(\\omega_n^1\\) \u4e0e \\(\\omega_n^{1+\\frac{n}{2}}\\) \u662f\u4e00\u7ec4\u2026\u2026\u6bcf\u7ec4\u4e2d\u5747\u4e92\u4e3a\u5bf9\u65b9\u7684\u76f8\u53cd\u6570\u3002</p> </li> <li> <p>\\(\\omega_{kn}^{kr}=\\omega_{n}^{r},r\\in \\mathbb N^{+}\\)</p> <p>\u8fd9\u6761\u6027\u8d28\u4ecd\u7136\u662f\u76f4\u63a5\u5c55\u5f00\u5373\u5f97\u8bc1\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5c06\u6240\u6709\u6570\u9010\u4e2a\u5e73\u65b9\uff0c\u5373\u53d8\u4e3a \\(\\omega_n^{0},\\omega_n^{2},\\omega_n^{4},\\cdots, \\omega^{2n-2}_n\\)\uff0c\u7531\u4e8e\u53bb\u91cd\u7684\u539f\u56e0\u540e\u534a\u90e8\u5206\u4e0d\u7528\u7ba1\uff0c\u53ea\u7559 \\(\\omega_n^{0},\\omega_{n}^2,\\omega_n^{4},\\cdots,\\omega_{n}^{n-2}\\)\u3002</p> <p>\u7531\u8fd9\u6761\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4e0a\u9762\u7684\u518d\u5199\u6210\uff1a</p> \\[ \\omega_{\\frac{n}{2}}^{0},\\omega_{\\frac{n}{2}}^{1},\\omega_{\\frac{n}{2}}^{2},\\cdots,\\omega_{\\frac{n}{2}}^{\\frac{n}{2}-1} \\nonumber \\] <p>\u8fd9\u53c8\u6070\u597d\u6ee1\u8db3\u4e86\u6211\u4eec\u4e0a\u9762\u6240\u9700\u6027\u8d28 \\(2\\) \u4e2d\u91cd\u65b0\u6807\u5b9a\u7684\u9700\u6c42\uff01\u5e76\u4e14\u8fd9\u4e00\u7ec4\u5355\u4f4d\u6839\u53ea\u662f\u628a \\(n\\) \u7f29\u5c0f\u5230\u539f\u6765\u7684 \\(\\frac{1}{2}\\)\uff0c\u81ea\u7136\u4ecd\u7136\u6ee1\u8db3\u6027\u8d28 \\(1\\)\uff0c\u5355\u4f4d\u6839\u7684\u6027\u8d28\u5b8c\u7f8e\u5951\u5408\u4e86\u6211\u4eec\u7684\u6240\u9700\uff01</p> </li> </ol>"}, {"location": "Algorithms/Counting/Calculating_0/#_3", "title": "\u5b9e\u73b0", "text": "<p>\u81f3\u6b64\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u5199\u51fa\u5c06\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u793a\u8f6c\u5316\u4e3a\u70b9\u503c\u8868\u793a\u7684\u8fc7\u7a0b\uff0c\u53ea\u8981\u6211\u4eec\u5c06\u6211\u4eec\u9700\u8981\u6c42\u7684 \\(x\\) \u9009\u4e3a \\(n\\) \u6b21\u5355\u4f4d\u6839\u7684\u5404\u6b21\u5e42\u5373\u53ef\uff0c\u7ed9\u51fa\u4e00\u4efd\u6700\u6734\u7d20\u7684\u5b9e\u73b0\uff1a</p> <pre><code>//a\u6570\u7ec4\u6700\u5f00\u59cb\u662f\u7cfb\u6570\u8868\u793a\nvoid FFT(std::complex&lt;double&gt; *a, int n) {\n    //\u5f53\u9012\u5f52\u5230\u5e8f\u5217\u957f\u5ea6\u4e3a 1 \u65f6, n \u6b21\u5355\u4f4d\u6839\u53d8\u4e3a\u539f\u6765\u7684 n \u6b21\u65b9, \u4e5f\u5c31\u662f 1, \u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\u7684\u503c\u76f4\u63a5\u5c31\u662f\u5bf9\u5e94\u4f4d\u7f6e\u7684\u7cfb\u6570\n    if(n == 1)\n        return ;\n    int mid = n &gt;&gt; 1;\n    //\u5947\u5076\u5206\u7ec4, \u6682\u5b58\u4e0b\u6b64\u65f6\u7684\u7cfb\u6570\n    std::complex&lt;double&gt; A1[mid + 1], A2[mid + 1];\n\n    for(int i = 0; i &lt;= n; i += 2) {\n        A1[i &gt;&gt; 1] = a[i];\n        A2[i &gt;&gt; 1] = a[i + 1];\n    }\n    FFT(A1, mid);\n    FFT(A2, mid);\n\n    //\u6b64\u65f6A1, A2\u5df2\u7ecf\u662f n / 2 \u4e2a\u70b9\u7684\u7cfb\u6570\u8868\u793a\n    //wn \u662f n \u6b21\u5355\u4f4d\u6839\n    std::complex&lt;double&gt; w0(1, 0), wn(cos(2 * pi / n), sin(2 * pi / n));\n    //\u6c42 x \u4e3a w_n^0, w_n^1, w_n^1, ..., w_n^{n-1} \u65f6\u5206\u522b\u7684\u89e3\n    for(int i = 0; i &lt; mid; i++, w0 *= wn) {\n        //F(x) = F_e(x) + x * F_o(x)\n        a[i] = A1[i] + w0 * A2[i];\n        //F(-x) = F_e(x) - x * F_o(x)\n        a[i + (n &gt;&gt; 1)] = A1[i] - w0 * A2[i];\n    }\n}\n</code></pre>"}, {"location": "Algorithms/Counting/Calculating_0/#idft", "title": "IDFT", "text": "<p>\u6211\u4eec\u8fd8\u5f97\u628a\u70b9\u503c\u8868\u793a\u6362\u6210\u7cfb\u6570\u8868\u793a\uff0c\u6240\u5e78\u8fd9\u90e8\u5206\u5176\u5b9e\u975e\u5e38\u7684\u7b80\u5355\uff0c\u4e0e FFT \u51e0\u4e4e\u5b8c\u5168\u76f8\u540c\u3002</p> <p>\u5148\u4e0d\u7ba1\u4e0a\u9762\u7684 FFT \u5e72\u4e86\u5565\uff0c\u8003\u8651\u66b4\u529b\u7684\u7cfb\u6570\u8868\u793a\u8f6c\u70b9\u503c\u8868\u793a\u3002</p> \\[ \\left\\{\\begin{aligned} F(\\omega_n^0)&amp;=a_0+a_1(\\omega_n^0)^1+a_2\\omega(\\omega_n^0)^2+\\cdots+a_{n-1}(\\omega_n^0)^{n-1}\\\\ F(\\omega_n^1)&amp;=a_0+a_1(\\omega_n^1)^1+a_2\\omega(\\omega_n^1)^2+\\cdots+a_{n-1}(\\omega_n^1)^{n-1}\\\\ &amp;\\cdots\\\\ F(\\omega_n^{n-1})&amp;=a_0+a_1(\\omega_n^{n-1})^1+a_2\\omega(\\omega_n^{n-1})^2+\\cdots+a_{n-1}(\\omega_n^{n-1})^{n-1}\\\\ \\end{aligned}\\right. \\nonumber \\] <p>\u8fd9\u53ef\u4ee5\u88ab\u5199\u6210\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\u7684\u5f62\u5f0f\uff1a</p> \\[ \\begin{bmatrix} F(\\omega_{n}^{0})\\\\ F(\\omega_{n}^{1})\\\\ F(\\omega_{n}^{2})\\\\ \\vdots\\\\ F(\\omega_n^{n-1}) \\end{bmatrix} = \\begin{bmatrix} 1 &amp;(\\omega_n^0)^1 &amp;(\\omega_n^0)^2 &amp;\\cdots &amp;(\\omega_n^0)^{n-1}\\\\ 1 &amp;(\\omega_n^1)^1 &amp;(\\omega_n^1)^2 &amp;\\cdots &amp;(\\omega_n^1)^{n-1}\\\\ 1 &amp;(\\omega_n^2)^1 &amp;(\\omega_n^2)^2 &amp;\\cdots &amp;(\\omega_n^2)^{n-1}\\\\ \\vdots &amp;\\vdots &amp;\\vdots &amp;\\ddots &amp;\\vdots\\\\ 1 &amp;(\\omega_n^{n-1})^1 &amp;(\\omega_n^{n-1})^2 &amp;\\cdots &amp;(\\omega_n^{n-1})^{n-1}\\\\ \\end{bmatrix} \\begin{bmatrix} a_0\\\\ a_1\\\\ a_2\\\\ \\cdots\\\\ a_{n-1} \\end{bmatrix} \\nonumber \\] <p>FFT \u5b9e\u9645\u4e0a\u5c31\u662f\u7b97\u4e86\u4e0a\u9762\u7684\u8fd9\u6837\u4e00\u4e2a\u77e9\u9635\u4e58\u6cd5\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u5728\u5de6\u8fb9\u7684\u7cfb\u6570\u8868\u793a\u5de6\u4e58\u4e2d\u95f4\u7684\u8303\u5fb7\u8499\u5fb7\u77e9\u9635\u7684\u9006\u77e9\u9635\uff0c\u5c31\u5f97\u5230\u4e86\u7cfb\u6570\u8868\u793a\u3002</p> <p>\u4e2d\u95f4\u7684\u77e9\u9635\u5f62\u5f0f\u975e\u5e38\u597d\uff0c\u76f4\u63a5\u7ed9\u51fa\u7ed3\u8bba\uff1a\u5176\u9006\u77e9\u9635\u5c31\u662f\u6bcf\u4e2a\u5143\u7d20\u5148\u53d6\u5012\u6570\uff0c\u518d\u9664\u4ee5\u53d8\u6362\u957f\u5ea6 \\(n\\)\u3002</p> <p>~~\u4e3a\u5565\u76f4\u63a5\u7ed9\u51fa\u7ed3\u8bba\u662f\u56e0\u4e3a\u6211\u4e0d\u60f3\u7b97\u4e86~~</p> <p>\u800c\u5982\u679c\u6211\u4eec\u8981\u5c06\u5355\u4f4d\u6839\u53d6\u5012\u6570\uff0c\u8fd9\u5b9e\u9645\u4e0a\u5c31\u662f\uff1a</p> \\[ \\omega_n^{-1}=e^{-i\\frac{2\\pi}{n}}=\\cos-\\frac{2\\pi}{n}+i\\sin-\\frac{2\\pi}{n}=\\cos\\frac{2\\pi}{n}-i\\sin\\frac{2\\pi}{n} \\nonumber \\] <p>\u6240\u4ee5\u6211\u4eec\u5728 FFT \u7684\u8fc7\u7a0b\u4e2d\u5c06\u6240\u6709\u5355\u4f4d\u6839\u865a\u90e8\u53d6\u6210\u76f8\u53cd\u6570\uff0c\u6240\u5f97\u5230\u7684\u5c31\u662f IDFT \u7684\u8fc7\u7a0b\uff0c\u81f3\u4e8e\u9664\u4ee5 \\(n\\)\uff0c\u53ef\u4ee5\u5728\u8ba1\u7b97\u5b8c\u6210\u540e\u4e00\u5e76\u89e3\u51b3\u3002</p> <pre><code>//inv = 1 \u65f6\u4e3a FFT, inv = -1 \u65f6\u4e3a IDFT\nvoid FFT(std::complex&lt;double&gt; *a, int n, int inv) {\n    if(n == 1)\n        return ;\n    int mid = n &gt;&gt; 1;\n    std::complex&lt;double&gt; A1[mid + 1], A2[mid + 1];\n\n    for(int i = 0; i &lt;= n; i += 2) {\n        A1[i &gt;&gt; 1] = a[i];\n        A2[i &gt;&gt; 1] = a[i + 1];\n    }\n    FFT(A1, mid, inv);\n    FFT(A2, mid, inv);\n\n    //\u865a\u90e8\u4e58\u4e0a\u76f8\u53cd\u6570\n    std::complex&lt;double&gt; w0(1, 0), wn(cos(2 * pi / n), inv * sin(2 * pi / n));\n    for(int i = 0; i &lt; mid; i++, w0 *= wn) {\n        a[i] = A1[i] + w0 * A2[i];\n        a[i + (n &gt;&gt; 1)] = A1[i] - w0 * A2[i];\n    }\n}\n</code></pre>"}, {"location": "Algorithms/Counting/Calculating_0/#dft-idft", "title": "DFT &amp; IDFT \u7684\u5b8c\u6574\u5b9e\u73b0", "text": "<p>\u5b8c\u6574\u7684\u6a21\u677f\u9898\u4ee3\u7801\u662f\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;complex&gt;\n#include &lt;cmath&gt;\n\nconst int maxn = 1 &lt;&lt; 22;\nconst double eps = 1e-6, pi = acos(-1.0);\n\nstd::complex&lt;double&gt; a[maxn], b[maxn];\nint n, m;\n\nvoid FFT(std::complex&lt;double&gt; *a, int n, int inv) {\n    if(n == 1)\n        return ;\n    int mid = n &gt;&gt; 1;\n    std::complex&lt;double&gt; A1[mid + 1], A2[mid + 1];\n\n    for(int i = 0; i &lt;= n; i += 2) {\n        A1[i &gt;&gt; 1] = a[i];\n        A2[i &gt;&gt; 1] = a[i + 1];\n    }\n    FFT(A1, mid, inv);\n    FFT(A2, mid, inv);\n\n    std::complex&lt;double&gt; w0(1, 0), wn(cos(2 * pi / n), inv * sin(2 * pi / n));\n    for(int i = 0; i &lt; mid; i++, w0 *= wn) {\n        a[i] = A1[i] + w0 * A2[i];\n        a[i + (n &gt;&gt; 1)] = A1[i] - w0 * A2[i];\n    }\n}\n\nint main(){\n    scanf(\"%d%d\", &amp;n, &amp;m);\n    for(int i = 0; i &lt;= n; i++) {\n        double x;\n        scanf(\"%lf\", &amp;x);\n        a[i].real(x);\n    }\n\n    for(int i = 0; i &lt;= m; i++) {\n        double x;\n        scanf(\"%lf\", &amp;x);\n        b[i].real(x);\n    }\n\n    int len = 1 &lt;&lt; std::max((int)ceil(log2(n+m)), 1);\n    FFT(a, len, 1);\n    FFT(b, len, 1);\n    for(int i = 0; i &lt;= len; i++)\n        a[i] = a[i] * b[i];\n\n    FFT(a, len, -1);\n    for(int i = 0; i &lt;= n + m; i++)\n        printf(\"%.0f \", a[i].real() / len + eps);\n    puts(\"\");\n    return 0;\n}\n</code></pre>"}, {"location": "Algorithms/Counting/Calculating_0/#ntt", "title": "NTT", "text": "<p>\u5927\u91cf\u7684\u6d6e\u70b9\u8fd0\u7b97\u4f1a\u5e26\u6765\u7cbe\u5ea6\u8bef\u5dee\uff0c\u4e5f\u4f1a\u5927\u5927\u51cf\u7f13\u6548\u7387\uff0c\u53ef\u60dc\u5728\u590d\u6570\u57df \\(\\mathbb C\\) \u4e2d\u5355\u4f4d\u6839\u662f\u6211\u4eec\u552f\u4e00\u6ee1\u8db3\u9700\u6c42\u7684\u6570\uff0c\u4f46\u6211\u4eec\u5927\u591a\u6570\u7684\u591a\u9879\u5f0f\u9898\u4e2d\uff0c\u8fd0\u7b97\u5b9e\u9645\u4e0a\u5728 \\(\\mathbb Z/p\\mathbb Z\\) \u4e2d\u8fdb\u884c\uff0c\u800c \\(p\\) \u901a\u5e38\u662f\u4e00\u4e2a\u7d20\u6570\u3002\u6211\u4eec\u5e0c\u671b\u6211\u4eec\u6240\u6709\u7684\u8fd0\u7b97\u90fd\u5728\u6a21\u610f\u4e49\u4e0b\u5b8c\u6210\uff0c\u6240\u5e78\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cFFT \u6709\u4e00\u4e2a\u66ff\u4ee3\u54c1\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a NTT\uff0c\u5373\u5feb\u901f\u6570\u8bba\u53d8\u6362\u3002</p> <p>\u6240\u6709\u590d\u6570\u8fd0\u7b97\u90fd\u4ea7\u751f\u81ea\u5355\u4f4d\u6839\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u4e0d\u4f7f\u7528\u590d\u6570\u8fdb\u884c\u8ba1\u7b97\uff0c\u5c31\u9700\u8981\u627e\u5230\u5355\u4f4d\u6839\u7684\u66ff\u4ee3\u54c1\u3002\u8003\u8651\u6211\u4eec\u9700\u8981\u5355\u4f4d\u6839\u7684\u54ea\u4e9b\u6027\u8d28\uff1a</p> <ol> <li>\\(\\omega_n^{k+\\frac{n}{2}}=-\\omega_n^k,k\\in \\mathbb N^+\\)</li> <li>\\(\\omega_{kn}^{kr}=\\omega_{n}^{r},r\\in \\mathbb N^{+}\\)</li> <li>\\(\\omega_n^{-1}=\\cos\\frac{2\\pi}{n}-i\\sin\\frac{2\\pi}{n}\\)</li> </ol> <p>\u6700\u540e\u4e00\u6761\u6027\u8d28\u662f\u65e0\u5173\u7d27\u8981\u7684\uff0c\u6211\u4eec\u6c42\u9006\u5373\u53ef\u3002</p> <p>\u5982\u679c\u4e86\u89e3\u8fc7\u539f\u6839\u7684\u6027\u8d28\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u5176\u5728\u6a21 \\(p\\) \u610f\u4e49\u4e0b\u548c\u6211\u4eec\u8981\u6c42\u7684\u4e1c\u897f\u76f8\u5f53\u63a5\u8fd1\u3002</p> <p>\u4e0d\u4e86\u89e3\u539f\u6839\u4e5f\u6ca1\u5173\u7cfb\uff0c\u4e0b\u9762\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u5b83\u5728 NTT \u4e2d\u5e94\u7528\u7684\u6027\u8d28\uff1a</p>"}, {"location": "Algorithms/Counting/Calculating_0/#_4", "title": "\u539f\u6839\u4e0e\u9636", "text": "<p>\u5982\u679c\u6b63\u6574\u6570 \\(a\\) \u4e0e\u6b63\u6574\u6570 \\(p\\) \u4e92\u8d28\uff0c\u5e76\u4e14 \\(p&gt;1\\)\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6ee1\u8db3 \\(a^n\\equiv 1\\pmod p\\) \u7684\u6700\u5c0f\u7684 \\(n\\)\uff0c\u6211\u4eec\u79f0\u5176\u4e3a \\(a\\) \u6a21 \\(p\\) \u7684\u9636\uff0c\u8bb0\u4f5c \\(\\delta_p(a)\\)\u3002</p> <p>\u9636\u6700\u91cd\u8981\u7684\u6027\u8d28\u662f\uff0c\u5bf9\u4e8e\u6240\u6709\u7684 \\(i\\in [0,\\delta_p(a))\\)\uff0c\u6240\u6709 \\(a^i\\bmod p\\) \u7684\u7ed3\u679c\u4e24\u4e24\u4e0d\u540c\u3002</p> <p>\u6211\u4eec\u53cd\u8bc1\uff0c\u5047\u8bbe \\(k,j\\in [0,\\delta_p(a))\\) \u6ee1\u8db3 \\(a^k\\equiv a^j\\pmod p\\)\uff0c\u90a3\u4e48 \\(a^{k-j}\\equiv 1\\pmod p\\)\uff0c\u4e0e\u5b9a\u4e49\u77db\u76fe\u3002</p> <p>\u800c\u5982\u679c \\(g\\) \u4e0e \\(n\\) \u6ee1\u8db3 \\(\\delta_n(g)=\\varphi(n)\\)\uff0c\u4e14 \\(\\gcd(g,n)=1\\)\uff0c\u5219 \\(g\\) \u4e3a \\(n\\) \u7684\u4e00\u4e2a\u539f\u6839\u3002</p> <p>\u5982\u679c \\(\\gcd(g,n)=1\\) \u4e14 \\(n&gt;0\\)\uff0c\u90a3\u4e48 \\(g\\) \u4e3a \\(n\\) \u7684\u4e00\u4e2a\u5145\u8981\u6761\u4ef6\u662f \\(\\{g^1,g^2,g^3,\\cdots, g^{\\varphi(n)}\\}\\) \u662f \\(n\\) \u7684\u4e00\u7ec4\u7b80\u5316\u5269\u4f59\u7cfb\u3002\u8fd9\u662f\u56e0\u4e3a\u7531\u9636\u7684\u5b9a\u4e49\uff0c\u96c6\u5408\u4e2d\u7684\u4efb\u610f\u4e24\u4e2a\u5143\u7d20\u6a21 \\(n\\) \u4e0d\u540c\u4f59\uff0c\u4e14 \\(\\gcd(g,n)=1\\)\uff0c\u5219\u8be5\u96c6\u5408\u5c31\u662f \\(n\\) \u7684\u4e00\u7ec4\u7b80\u5316\u5269\u4f59\u7cfb\u3002</p> <p>\u8bf4\u4e86\u8fd9\u4e48\u591a\u5b9a\u4e49\uff0c\u539f\u6839\u5230\u5e95\u4e3a\u4ec0\u4e48\u6ee1\u8db3\u6211\u4eec\u4e0a\u9762\u7684\u8981\u6c42\uff1f</p> <p>\u901a\u5e38\u6a21\u6570\u90fd\u662f\u7d20\u6570\uff0c\u90a3\u4e48 \\(\\varphi(p)=p-1\\)\uff0c\u6240\u4ee5 \\(p\\) \u7684\u4e00\u4e2a\u539f\u6839 \\(g\\) \u81ea\u7136\u6ee1\u8db3 \\(\\gcd(p,n)=1\\)\uff0c\u5219 \\(g\\) \u7684\u4ece \\(1\\) \u5230 \\(p-1\\) \u6b21\u65b9\u5728\u6a21 \\(p\\) \u610f\u4e49\u4e0b\u53ef\u4ee5\u53d6\u904d \\(1\\sim p-1\\) \u4e2d\u7684\u6bcf\u4e00\u4e2a\u503c\u3002\u5e76\u4e14\u6bcf\u4e2a\u503c\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a \\(g^k,k\\in[1,p-1)\\)</p> <p>\u73b0\u5728\u6211\u4eec\u5047\u8bbe \\(n | (p-1)\\)\uff0c\\(n\\) \u4e0e\u4e0a\u9762\u610f\u4e49\u76f8\u540c\uff0c\u90fd\u662f \\(2\\) \u7684\u67d0\u4e2a\u5e42\uff0c\u5b9a\u4e49</p> \\[ g_n=g^{\\frac{p-1}{n}} \\nonumber \\] <p>\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u6211\u4eec\u6709 \\(g_n^n=g^{n\\frac{p-1}{n}}=g^{p-1}=1\\)\uff0c\u4e5f\u5c31\u662f\u8fd9\u4ecd\u7136\u662f\u6bcf \\(n\\) \u6b21\u65b9\u4e00\u5faa\u73af\u7684\uff0c\u4e0e\u5355\u4f4d\u6839\u76f8\u540c\u3002</p> <p>\u5355\u4f4d\u6839\u7684\u6027\u8d28 \\(1\\)\uff0c\\(\\omega_n^{k+\\frac{n}{2}}=-\\omega_n^k,k\\in \\mathbb N^+\\) \u53ef\u4ee5\u88ab\u7b49\u4ef7\u5730\u53d9\u8ff0\u4e3a \\(\\omega_n^{\\frac{n}{2}}=-\\omega_n\\)</p> <p>\u8ba9\u6211\u4eec\u8003\u8651 \\(g_n^{\\frac{n}{2}}\\)\uff1a</p> \\[ \\begin{aligned} g^{\\frac{n}{2}}_{n}&amp;=g^{\\frac{n}{2}\\cdot\\frac{p-1}{n}}\\\\ &amp;=g^{\\frac{p-1}{2}} \\end{aligned} \\nonumber \\] <p>\u53c8\u56e0\u4e3a</p> \\[ (g^{\\frac{p-1}{2}})^2=g^{p-1},g^{p-1}\\equiv 1\\pmod p \\nonumber \\] <p>\u6839\u636e\u539f\u6839\u7684\u5b9a\u4e49\uff0c\\(g^{\\frac{p-1}{2}}\\) \u5fc5\u5b9a\u4e0d\u4e0e \\(1\\) \u540c\u4f59\uff0c\u56e0\u4e3a\u5982\u679c\u8fd9\u6837\u5c31\u4e0d\u6ee1\u8db3\u6bcf\u4e00\u4e2a\u503c\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a \\(g^k,k\\in[1,p-1)\\)</p> <p>\u6240\u4ee5\u5c31\u4e00\u5b9a\u6709\uff1a</p> \\[ g_n^{\\frac{n}{2}}\\equiv -1\\pmod p \\nonumber \\] <p>\u6ee1\u8db3\u6211\u4eec\u6240\u9700\u7684\u6027\u8d28 \\(1\\)\u3002</p> <p>\u5bf9\u4e8e\u6ee1\u8db3\u6027\u8d28 \\(2\\) \u7684\u8bc1\u660e\u662f\u7b80\u5355\u7684\uff1a</p> \\[ \\begin{aligned} g^{rk}_{rn}=g^{\\frac{rk(p-1)}{rn}}=g^{k}_n \\end{aligned} \\nonumber \\] <p>\u6240\u4ee5\u5982\u679c\u6211\u4eec\u76f4\u63a5\u628a\u4e0a\u9762 FFT \u7684\u4ee3\u7801\u4e2d\u7684\u5355\u4f4d\u6839\u5168\u90e8\u66ff\u6362\u6210\u5bf9\u5e94\u7684 \\(g_n\\)\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230 NTT \u7684\u4ee3\u7801\u4e86\u3002</p> <p>\u552f\u4e00\u7684\u95ee\u9898\u662f\uff0c\u6211\u4eec\u603b\u662f\u9700\u8981\u6ee1\u8db3 \\(n|p-1\\)\uff0c\u800c\u6211\u4eec\u5e38\u7528\u7684\u6a21\u6570 \\(998244353\\) \u6ee1\u8db3 \\(998244352=7\\times17\\times2^{23}\\)\uff0c\u800c \\(1004535809\\) \u6ee1\u8db3 \\(1004535808=479\\times 2^{21}\\)\uff0c\\(469762049\\) \u6ee1\u8db3 \\(469762048=7\\times 2^{26}\\)\uff0c\u53ef\u60dc\u7684\u662f \\(1000000007\\) \u7684\u6027\u8d28\u5c31\u8981\u5dee\u5f97\u591a\uff0c\\(1000000006=2\\times 500000003\\)\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u5c06\u5728\u540e\u9762\u4ecb\u7ecd\u89e3\u51b3\u65b9\u6cd5\u3002</p> <p>\u5230\u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u5199\u51fa NTT \u4e86\uff0c\u4f46\u8fd9\u4e2a\u591a\u9879\u5f0f\u4e58\u6cd5\u4e5f\u592a\u6162\u4e86\uff0c\u80fd\u4e0d\u80fd\u66f4\u731b\u4e00\u70b9\u554a\uff1f</p>"}, {"location": "Algorithms/Counting/Calculating_0/#_5", "title": "\u4f18\u5316", "text": ""}, {"location": "Algorithms/Counting/Calculating_0/#_6", "title": "\u4f4d\u9006\u5e8f\u7f6e\u6362 / \u8774\u8776\u53d8\u6362", "text": "<p>\u4e0a\u9762\u7684\u5b9e\u73b0\u4e2d\uff0c\u6211\u4eec\u6bcf\u6b21\u9012\u5f52\u90fd\u8981\u7533\u8bf7\u4e24\u4e2a\u957f\u5ea6\u4e3a \\(mid\\) \u7a7a\u95f4\uff0c\u505a\u4e00\u904d\u5206\u62c6\u7cfb\u6570\u2026\u2026</p> <p>\u6700\u5927\u7684\u95ee\u9898\u5728\u4e8e\u6211\u4eec\u8981\u5206\u62c6\u7cfb\u6570\u8d4b\u503c\uff0c\u5982\u679c\u6211\u4eec\u4ece\u4e00\u5f00\u59cb\u5c31\u628a\u6bcf\u4e2a\u7cfb\u6570\u653e\u5230\u76ee\u6807\u4f4d\u7f6e\u4e0a\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u76f4\u63a5\u4e24\u4e2a\u4e24\u4e2a\u5408\u5e76\uff0c\u56db\u4e2a\u56db\u4e2a\u5408\u5e76\u2026\u2026\u6bcf\u6b21\u500d\u589e\u5373\u53ef\u5b8c\u6210\u6574\u4e2a\u8fc7\u7a0b\u3002</p> <p>\u8003\u8651\u6211\u4eec\u662f\u600e\u4e48\u628a\u6bcf\u4e2a\u7cfb\u6570 \\(a_i\\) \u653e\u5230\u76ee\u6807\u4f4d\u7f6e\u4e0a\u7684\u3002</p> <p>\u4ece\u4f4e\u5230\u9ad8\u9010\u4f4d\u8003\u8651 \\(i\\) \u4e8c\u8fdb\u5236\u7684\u6bcf\u4e00\u4f4d\uff0c\u5982\u679c\u662f \\(1\\) \u6211\u4eec\u5c31\u628a\u4ed6\u653e\u5728\u5e8f\u5217\u53f3\u534a\u8fb9\uff0c\u9012\u5f52\u53f3\u8fb9\uff0c\u5982\u679c\u662f \\(0\\) \u5c31\u653e\u5230\u5e8f\u5217\u5de6\u534a\u8fb9\uff0c\u9012\u5f52\u5de6\u534a\u8fb9\u3002</p> <p>\u4e0d\u96be\u60f3\u5230\u8fd9\u6837\u9010\u6b65\u8fdb\u884c\u4e0b\u53bb\uff0c\u9012\u5f52\u5230\u5e95\u65f6\u5176\u4f4d\u7f6e\u5c31\u662f \\(i\\) \u7684\u4e8c\u8fdb\u5236\u7ffb\u8f6c</p> <p>\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u628a\u6bcf\u4e2a\u7cfb\u6570\u8981\u653e\u5230\u7684\u4f4d\u7f6e\u5904\u7406\u51fa\u6765\uff0c\u7136\u540e\u4e24\u4e24\u5408\u5e76\u5c31\u53ef\u4ee5\u4e86\uff0c\u7701\u53bb\u4e86\u4e2d\u95f4\u5927\u91cf\u7684\u7533\u8bf7\u5185\u5b58\u4e0e\u590d\u5236\u7684\u65f6\u95f4\u3002</p> <p>\u800c\u76ee\u6807\u8981\u6362\u5230\u7684\u4f4d\u7f6e\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u7ebf\u6027\u9884\u5904\u7406\u51fa\u6765\u7684\uff0c\u5047\u8bbe \\(\\operatorname{rev}(i)\\) \u8868\u793a\u4e0b\u6807\u4e3a \\(i\\) \u7684\u7cfb\u6570\u6700\u7ec8\u8981\u79fb\u52a8\u5230\u7684\u4f4d\u7f6e\u3002</p> <p>\u4ece\u5c0f\u5230\u5927\u505a\uff0c\u800c \\(\\operatorname{rev}(0)=0\\)</p> <p>\u90a3\u4e48\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 \\(\\operatorname{rev}(\\lfloor\\frac{i}{2}\\rfloor)\\) \u7684\u7ed3\u679c\u3002\u6211\u4eec\u8981\u7ffb\u8f6c \\(i\\)\uff0c\u53ef\u4ee5\u770b\u505a\u5148\u7ffb\u8f6c \\(\\lfloor\\frac{i}{2}\\rfloor\\)\uff0c\u5c06\u5176\u53f3\u79fb\u4e00\u4f4d\uff0c\u7136\u540e\u518d\u6700\u9ad8\u4f4d\u4e0a\u586b\u4e0a\u672b\u5c3e\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u8981\u7ffb\u8f6c \\(\\color{red}{01101010}\\color{green}1\\)\uff0c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 \\(0\\color{red}01101010\\)(\u5148\u53bb\u6389\u672b\u4f4d\u518d\u5728\u524d\u9762\u8865 \\(0\\))\uff0c\u90a3\u4e48\u7ffb\u8f6c\u4e4b\u540e\u5c31\u662f \\(\\color{red}{01010110}\\color{black}{0}\\)\uff0c\u53bb\u6389\u6700\u540e\u4e00\u4f4d\u53d8\u6210 \\(\\color{red}{01010110}\\)\uff0c\u968f\u540e\u5728\u6700\u524d\u9762\u8865\u4e0a \\(1\\)\uff0c\u5c31\u53d8\u6210 \\(\\color{green}1\\color{red}{01101010}\\)\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u6240\u9700\u7684\u7ffb\u8f6c\u3002</p> <p>\u5047\u8bbe\u6574\u4e2a\u5e8f\u5217\u7684\u957f\u5ea6\u662f \\(2^k\\)\uff0c\u90a3\u4e48\uff1a</p> \\[ \\operatorname{rev}(i)=\\left\\lfloor\\frac{\\operatorname{rev}(\\lfloor\\frac{i}{2}\\rfloor)}{2}\\right\\rfloor+(i\\bmod 2)\\times 2^{k-1} \\nonumber \\] <p>\u63a5\u4e0b\u6765\u8003\u8651\u600e\u4e48\u5408\u5e76\u7b54\u6848\u3002</p> <p>\u73b0\u5728\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6709\u4e86 \\(F_e(\\omega_{n/2}^{k})\\) \u548c \\(F_o(\\omega^{k}_{n/2})\\) \u7684\u7b54\u6848\uff0c\u90a3\u4e48\u4ed6\u4eec\u5206\u522b\u5b58\u5728\u6570\u7ec4\u91cc \\(k\\) \u4e0e \\(k+\\frac{n}{2}\\) \u7684\u4f4d\u7f6e\uff0c\u800c\u6211\u4eec\u501f\u52a9\u8fd9\u4e24\u4e2a\u503c\u7b97\u51fa\u6765\u7684 \\(F(\\omega_n^{k})\\) \u4e0e \\(F(\\omega^{k+\\frac{n}{2}}_n)\\) \u6070\u597d\u653e\u5728\u540c\u6837\u7684\u4f4d\u7f6e\uff0c\u76f4\u63a5\u8986\u76d6\u5373\u53ef\u3002</p> <p>\u5177\u4f53\u5b9e\u73b0\u53ef\u4ee5\u770b\u4ee3\u7801\uff1a</p> <pre><code>int k = std::max((int)ceil(log2(n+m)), 1);\nint len = 1 &lt;&lt; k;\n//\u9884\u5904\u7406rev\nfor(int i = 0; i &lt; len; i++)\n    rev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; (k - 1));\n</code></pre> <pre><code>void NTT(ll *a, int n, int inv){\n    //\u5c06\u7cfb\u6570\u6362\u5230\u7f6e\u6362\u5bf9\u5e94\u7684\u4f4d\u7f6e\n    for(int i = 0; i &lt; n; i++)\n        if(i &lt; rev[i])\n            std::swap(a[i], a[rev[i]]);\n\n    //\u53d8\u6362\u7684\u533a\u95f4\u957f\u5ea6\n    for(int i = 1; i &lt; n; i &lt;&lt;= 1) {\n        //\u8fd9\u90e8\u5206\u53ef\u4ee5\u9884\u5904\u7406\u5355\u4f4d\u6839\u505a\u5230\u66f4\u5feb\n        ll gn = f_pow(inv ? g : gi, (mod - 1) / (i &lt;&lt; 1));\n\n        for(int j = 0; j &lt; n; j += (i &lt;&lt; 1)) {\n            ll g0 = 1;\n            for(int k = 0; k &lt; i; k++, g0 = g0 * gn % mod) {\n                //\u76f4\u63a5\u8986\u76d6\u539f\u6765\u7684\u503c\n                ll x = a[j + k], y = g0 * a[i + j + k] % mod;\n                a[j + k] = (x + y) % mod;\n                a[i + j + k] = (x - y + mod) % mod;\n            }\n        }\n    }\n}\n</code></pre> <p>\u8fd9\u8fd8\u53ef\u4ee5\u901a\u8fc7\u51cf\u5c11\u53d6\u6a21\u6b21\u6570\u8fdb\u4e00\u6b65\u4f18\u5316\u3002</p>"}, {"location": "Algorithms/Counting/Calculating_0/#_7", "title": "\u80fd\u4e0d\u80fd\u518d\u731b\u4e00\u70b9\u554a\uff1f", "text": "<p>\u4e0a\u9762\u7684 NTT \u518d\u52a0\u4e0a\u9884\u5904\u7406\u5355\u4f4d\u6839\u4e0e\u9006\u5143\u5c31\u5df2\u7ecf\u8db3\u591f\u5e94\u4ed8\u5927\u591a\u6570\u7684\u60c5\u51b5\uff0c\u4e0b\u9762\u7684\u5185\u5bb9\u53ef\u4ee5\u6682\u65f6\u7565\u8fc7\u3002</p> <p>\u53c2\u8003\u8d44\u6599\uff1a</p> <p>yhx-12243 \u7684 NTT \u5230\u5e95\u5199\u4e86\u4e9b\u4ec0\u4e48\uff08\u8be6\u7ec6\u63ed\u79d8\uff09 - Seniorious' blog</p> <p>\u8f6c\u7f6e\u539f\u7406\u53ca\u5176\u5e94\u7528</p> <p>\u5b8c\u6574\u591a\u9879\u5f0f\u6a21\u677f (yhx-12243.github.io)</p>"}, {"location": "Algorithms/Counting/Calculating_0/#dif-fft", "title": "DIF-FFT", "text": "<p>\u4e0a\u9762\u7684\u6bcf\u6b21\u6309\u5947\u5076\u5212\u5206\u7684\u505a\u6cd5\u88ab\u79f0\u4e3aDIT(\u6309\u65f6\u57df\u62bd\u53d6)-FFT\uff0c\u5176\u4f5c\u7528\u53ef\u4ee5\u6982\u62ec\u4e3a\u8f93\u5165\u4e00\u4e2a\u7ecf\u8fc7\u8774\u8776\u53d8\u6362\u540e\u7684\u7cfb\u6570\u5411\u91cf\uff0c\u8f93\u51fa\u4e00\u4e2a\u70b9\u503c\u5411\u91cf</p> <p>\u800cDIF(\u6309\u9891\u57df\u62bd\u53d6)-FFT\u662f\u5176\u8f6c\u7f6e\uff0c\u4f5c\u7528\u662f\u8f93\u5165\u4e00\u4e2a\u7cfb\u6570\u5411\u91cf\uff0c\u8f93\u51fa\u4e00\u4e2a\u8774\u8776\u53d8\u6362\u540e\u7684\u70b9\u503c\u5411\u91cf</p> <p>\u592a\u62bd\u8c61\u4e86\uff0c\u5148\u4e0d\u7ba1\u8fd9\u73a9\u610f\u662f\u5565\u610f\u601d\uff0c\u6211\u4eec\u8003\u8651\u6362\u4e00\u4e2a\u89d2\u5ea6\u505a FFT\uff0c\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u77e5\u9053 FFT \u7684\u53d6\u503c\u90fd\u662f\u5355\u4f4d\u6839\u4e86\uff0c\u6211\u4eec\u4ece\u5355\u4f4d\u6839\u4e0b\u624b\uff1a</p> <p>\u5047\u8bbe\u6211\u4eec\u8981\u6c42 \\(F(\\omega_n^k)\\)</p> \\[ \\begin{aligned} F(\\omega_n^{k}) &amp;=\\sum_{i=0}^{n-1}a_i\\omega_n^{ki}\\\\ &amp;=\\sum_{i=0}^{\\frac{n}{2}-1}a_i\\omega_n^{ki}+\\sum_{i=\\frac{n}{2}}^{n-1}a_i\\omega_n^{ki}\\\\ &amp;=\\sum_{i=0}^{\\frac{n}{2}-1}a_i\\omega_n^{ki}+\\sum_{i=0}^{\\frac{n}{2}-1}a_{i+\\frac{n}{2}}\\omega_n^{k(\\frac{n}{2}+i)}\\\\ &amp;=\\sum_{i=0}^{\\frac{n}{2}-1}a_i\\omega_n^{ki}+\\sum_{i=0}^{\\frac{n}{2}-1}a_{i+\\frac{n}{2}}\\omega_n^{\\frac{kn}{2}+ki}\\\\ &amp;=\\sum_{i=0}^{\\frac{n}{2}-1}a_i\\omega_n^{ki}+\\sum_{i=0}^{\\frac{n}{2}-1}a_{i+\\frac{n}{2}}\\omega_n^{\\frac{kn}{2}+ki}\\\\ &amp;=\\sum_{i=0}^{\\frac{n}{2}-1}\\bigg(a_i+a_{i+\\frac{n}{2}}\\omega_n^{\\frac{kn}{2}}\\bigg)\\omega_n^{ki}\\\\ &amp;=\\sum_{i=0}^{\\frac{n}{2}-1}\\bigg(a_i+(-1)^ka_{i+\\frac{n}{2}}\\bigg)\\omega_n^{ki}\\\\ &amp;=\\sum_{i=0}^{\\frac{n}{2}-1}a_i\\omega^{ki}+\\sum_{i=0}^{\\frac{n}{2}-1}(-1)^ka_{i+\\frac{n}{2}}\\omega_n^{ki} \\end{aligned} \\nonumber \\] <p>\u6309 \\(k\\) \u7684\u5947\u5076\u6027\u5206\u7c7b\u8ba8\u8bba\uff0c\u5982\u679c\u6211\u4eec\u7684 \\(k\\) \u662f\u4e00\u4e2a\u5076\u6570\uff0c\u90a3\u4e48</p> \\[ F(\\omega_n^{k})=(\\sum_{i=0}^{\\frac{n}{2}-1}a_i+\\sum_{i=0}^{\\frac{n}{2}-1}a_{i+\\frac{n}{2}})\\omega_n^{ki} \\nonumber \\] <p>\u5982\u679c\u6211\u4eec\u7684 \\(k\\) \u662f\u4e00\u4e2a\u5947\u6570\uff0c\u90a3</p> \\[ F(\\omega_n^k)=(\\sum_{i=0}^{\\frac{n}{2}-1}a_i-\\sum_{i=0}^{\\frac{n}{2}-1}a_{i+\\frac{n}{2}})\\omega_n^{ki} \\nonumber \\] <p>\u8fd9\u6837\u4f3c\u4e4e\u8fd8\u662f\u8981\u5bf9\u6bcf\u4e2a\u70b9\u6c42\u4e00\u6b21\u5355\u4f4d\u6839\uff0c\u662f \\(\\mathcal O(n^2)\\) \u7684\uff0c\u4f46\u662f\u4e0d\u8981\u5fd8\u8bb0\u5355\u4f4d\u6839\u7684\u6027\u8d28</p> \\[ (\\omega_n^{k})^2=(\\omega_{n/2}^{k}) \\] <p>\u5bf9\u4e8e\u6240\u6709\u5076\u6570\u7684 \\(k\\)\uff0c\u90fd\u5199\u6210 \\(\\omega_{n}^{2p}\\) \u7684\u5f62\u5f0f\uff0c\u4e5f\u5c31\u662f \\(\\omega_{n/2}^{p}\\)\uff0c\u8fd9\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u628a\u5947\u6570\u7684\u4f4d\u7f6e\u5168\u90e8\u4e58\u4e0a \\(\\omega^{1}_{n}\\)\uff0c\u518d\u628a\u5947\u6570\u548c\u5076\u6570\u7684\u90e8\u5206\u63d0\u53d6\u51fa\u6765\uff0c\u5206\u522b\u9012\u5f52\u8fdb\u884c DIF\uff0c\u90a3\u4e48\u5728\u7b2c\u4e8c\u5c42\u4e58\u4e0a \\(\\omega^{1}_{n/2}\\) \u5b9e\u9645\u4e0a\u5c31\u662f\u5728\u7b2c\u4e00\u5c42\u4e58\u4e0a\u4e86 \\(\\omega^{2}_n\\)\u3002\u8003\u8651\u5e42\u6b21\u4e0a\u7684\u4e8c\u8fdb\u5236\u62c6\u5206\uff0c\u6240\u4ee5\u8fd9\u4e2a\u662f\u5bf9\u7684\u3002</p> <p>\u8fd9\u91cc\u7684\u505a\u6cd5\u5176\u5b9e\u662f\u8003\u8651\u6bcf\u4e00\u4e2a\u7cfb\u6570\u4f1a\u4e58\u4e0a\u54ea\u4e9b\u5355\u4f4d\u6839\uff0c\u800c DIT-FFT \u5b9e\u9645\u4e0a\u662f\u8003\u8651\u6bcf\u4e00\u4e2a\u5355\u4f4d\u6839\u4f1a\u4e58\u4e0a\u54ea\u4e9b\u7cfb\u6570\u3002</p> <p>\u6700\u540e\u5b9e\u9645\u4e0a\u628a\u6240\u6709 \\(F(\\omega_n^{k})\\) \u6309 \\(k\\) \u8774\u8776\u53d8\u6362\u4e86\u4e00\u904d\uff0c\u6240\u4ee5\u5c31\u662f\u8f93\u5165\u4e00\u4e2a\u7cfb\u6570\u5411\u91cf\uff0c\u8f93\u51fa\u4e00\u4e2a\u8774\u8776\u53d8\u6362\u540e\u7684\u70b9\u503c\u5411\u91cf</p> <p>\u6211\u4eec\u6709\u4e00\u4efd\u975e\u5e38\u66b4\u529b\u7684\u5b9e\u73b0\uff1a</p> <pre><code>std::vector&lt;std::complex&lt;double&gt;&gt; dif_fft(std::vector&lt;std::complex&lt;double&gt;&gt;&amp; x) {\n    int N = x.size();\n\n    if (N == 1) {\n        return x;\n    }\n\n    std::vector&lt;std::complex&lt;double&gt;&gt; even(N / 2);\n    std::vector&lt;std::complex&lt;double&gt;&gt; odd(N / 2);\n\n    for (int i = 0; i &lt; N / 2; i++) {\n        even[i] = x[i] + x[i + N / 2];\n        odd[i] = (x[i] - x[i + N / 2]) * std::polar(1.0, -2 * M_PI * i / N);\n    }\n\n    std::vector&lt;std::complex&lt;double&gt;&gt; evenResult = dif_fft(even);\n    std::vector&lt;std::complex&lt;double&gt;&gt; oddResult = dif_fft(odd);\n\n    std::vector&lt;std::complex&lt;double&gt;&gt; result(N);\n\n    for (int k = 0; k &lt; N / 2; k++) {\n        result[k] = evenResult[k];\n        result[k + N / 2] = oddResult[k];\n    }\n\n    return result;\n}\n</code></pre> <p>\u5de7\u7684\u662f\uff0c\u6211\u4eec\u539f\u672c\u7684 DIT-FFT \u662f\u8f93\u5165\u4e00\u4e2a\u7ecf\u8fc7\u8774\u8776\u53d8\u6362\u540e\u7684\u7cfb\u6570\u5411\u91cf\uff0c\u8f93\u51fa\u4e00\u4e2a\u70b9\u503c\u5411\u91cf\uff0c\u800c DIF-FFT \u662f\u8f93\u5165\u4e00\u4e2a\u7cfb\u6570\u5411\u91cf\uff0c\u8f93\u51fa\u4e00\u4e2a\u8774\u8776\u53d8\u6362\u540e\u7684\u70b9\u503c\u5411\u91cf\u3002</p> <p>\u90a3\u6211\u4eec\u76f4\u63a5\u5148 DIF-FFT \u5f97\u5230\u8774\u8776\u53d8\u6362\u540e\u7684\u70b9\u503c\u5411\u91cf\uff0c\u518d DIT-FFT \u7ffb\u8f6c\u56de\u6765\u4e0d\u5c31\u80fd\u5f97\u5230\u7cfb\u6570\u5411\u91cf\u4e86\u5417\uff1f</p> <p>\u76f4\u63a5\u6309\u8fd9\u6837\u5b9e\u73b0\u53ef\u4ee5\u518d\u5361\u5927\u6982 \\(70\\text{ms}\\)\u3002</p>"}, {"location": "Algorithms/Counting/Calculating_0/#_8", "title": "\u518d\u4f18\u5316", "text": "<p>DIT-FFT\u56e0\u4e3a\u4ece\u5c0f\u5230\u5927\uff0c\u6bcf\u5c42\u90fd\u8981\u91cd\u65b0\u5904\u7406\u5355\u4f4d\u6839\uff0c\u5355\u4f4d\u6839\u4e58\u6cd5\u662f \\(O(n\\log n)\\) \u6b21\u7684\u3002</p> <p>DIF-FFT\u56e0\u4e3a\u4ece\u5927\u5230\u5c0f\uff0c\u4f46\u662f\u6bcf\u5c42\u8ba1\u7b97\u7684\u65f6\u5019\u90fd\u8981\u5373\u65f6\u8d21\u732e\uff0c\u5355\u4f4d\u6839\u4e58\u6cd5\u4e5f\u662f \\(O(n\\log n)\\) \u6b21\u7684\u3002</p> <p>\u90a3\u5982\u679c\u6211\u4eec\u76f4\u63a5\u5bf9\u4e0d\u8774\u8776\u53d8\u6362\u7684\u7cfb\u6570\u5411\u91cf\u505a DIT-FFT \u5462\uff1f</p> <p></p> <p>\u6211\u4eec\u4ecd\u7136\u4f1a\u5f97\u5230\u4e00\u4e2a\u70b9\u503c\u7684\u6570\u7ec4\uff0c\u800c\u5176\u6b63\u662f\u8774\u8776\u53d8\u6362\u540e\u7684\u6570\u7ec4\uff0c\u53ea\u8981\u6211\u4eec\u5bf9\u4e2d\u9014\u7528\u5230\u7684\u539f\u6839\u4e5f\u8774\u8776\u53d8\u6362\u4e00\u4e0b\u5c31\u884c\u4e86\u3002</p> <p>\u66f4\u5177\u4f53\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 DIF-FFT \u7684\u8fc7\u7a0b\u4e2d\u505a DIT-FFT\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9664\u4e86\u6700\u5916\u5c42\u5927\u5faa\u73af\u4ee5\u5916\u90fd\u662f DIT-FFT \u7684\u64cd\u4f5c\uff0c\u5bf9 DIT-FFT \u4e5f\u53ef\u4ee5\u50cf\u8fd9\u6837\u76f4\u63a5\u53cd\u8fc7\u6765\u3002\u8fd9\u6837\u6211\u4eec\u7684\u539f\u6839\u79fb\u52a8\u6b21\u6570\u53ef\u4ee5\u4f18\u5316\u5230 \\(O(n)\\) \u7ea7\u522b\u7684\u3002</p> <p>\u5bf9\u4e8e\u9884\u5904\u7406\u539f\u6839\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6539\u53d8\u4e00\u4e0b\uff0c\u4ee5 \\(\\bmod 998244353\\) \u4e3e\u4f8b\uff0c\u6211\u4eec\u8003\u8651\u6bcf\u6b21\u7528\u5230\u7684\u539f\u6839\u90fd\u662f \\(3^{\\frac{p-1}{n}}\\)\uff0c\u800c \\(n\\) \u662f \\(2\\) \u7684\u5e42\uff0c\u628a \\(p\\) \u62c6\u6210 \\(7\\times 17\\times 2^{23}=119\\times 2^{23}\\) \u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u628a\u539f\u6765\u7684\u5e95\u6570\u4ece \\(3\\) \u6362\u6210 \\(3^{119}\\)\uff0c\u8fd9\u6837\u6211\u4eec\u53ea\u8981\u7ef4\u62a4\u5e95\u6570\u7684\u5404\u4e2a\u5e42\u5373\u53ef\u3002</p> <p>\u81f3\u4e8e\u5982\u4f55\u76f4\u63a5\u9884\u5904\u7406\u8774\u8776\u53d8\u6362\u540e\u7684\u539f\u6839\uff0c\u5148\u76f4\u63a5\u9884\u5904\u7406\u51fa \\(g^{2^k}\\) \u653e\u5728 \\(2^{21-k}\\) \u5904\uff0c\u4e5f\u5c31\u662f\u8774\u8776\u53d8\u6362\u540e\u7684\u7ed3\u679c\uff0c\u4e3a\u4ec0\u4e48\u662f \\(21-k\\) \u6b21\u65b9\u662f\u56e0\u4e3a \\(\\frac{p-1}{n}\\) \u5bf9\u5e94\u7684\u5c31\u662f\u5b83\u3002</p> <p>\u5176\u6b21 \\(g^{2^j+2^k}=g^{2^j}\\times g^{2^k}\\)\uff0c\u6bcf\u6b21\u62ff\u4e24\u4e2a\u4f4d\u62fc\u8d77\u6765\u5c31\u884c\u4e86</p> <pre><code>#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n#include &lt;cctype&gt;\n#include &lt;cmath&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n\ntypedef long long ll;\nusing namespace std;\nconst ll g = 3, gi = 332748118, mod = 998244353;\n// 3^119\nconst ll prebase = 15311432;\nconst int N = 2e6 + 1e5 + 10;\n\nll f_pow(ll a, ll k) {\n    ll base = 1;\n    for (; k; k &gt;&gt;= 1, a = a * a % mod)\n        if (k &amp; 1)\n            base = base * a % mod;\n    return base;\n}\n\nnamespace NTT {\n    ll w2[N];\n    int n;\n    void init(int n = N) {\n        int t = min((n &gt; 1 ? __lg(n) - 1 : 0), 21);\n        // \u76f4\u63a5\u9884\u5904\u7406\u8774\u8776\u53d8\u6362\u540e\u7684\u5355\u4f4d\u6839\n        w2[0] = 1, w2[1 &lt;&lt; t] = f_pow(prebase, 1 &lt;&lt; (21 - t));\n        // \u7ffb\u8f6c\u540e\u7684\u5355\u4f4d\u6839, \u5927\u7684\u5bf9\u5e94\u5c0f\u7684\n        for (int i = t; i; i--)\n            w2[1 &lt;&lt; (i - 1)] = w2[1 &lt;&lt; i] * w2[1 &lt;&lt; i] % mod;\n\n        // \u9664\u53bb\u6700\u540e\u4e00\u4e2a 1 \u4e0e\u53ea\u7559\u6700\u540e\u4e00\u4e2a 1, \u8fd9\u4e2a\u65f6\u5019\u672c\u8eab\u5c31\u662f\u5df2\u7ecf\u5012\u5e8f\u7684, \u81ea\u7136\u8fd9\u6837\u5904\u7406\u51fa\u6765\u7684\u4e5f\u662f\u5012\u5e8f\u7684\n        for (int i = 1; i &lt; (1 &lt;&lt; t); i++)\n            w2[i] = w2[i &amp; (i - 1)] * w2[i &amp; -i] % mod;\n    }\n\n    inline void NTT_init(int len) {\n        n = 1 &lt;&lt; len;\n    }\n\n    void DIF(vector&lt;ll&gt; &amp;a) {\n        // \u5916\u5c42\u5faa\u73af\u662f DIT\n        for (int i = n &gt;&gt; 1; i &gt;= 1; i &gt;&gt;= 1) {\n            for (int j = 0, og = 0; j &lt; n; j += (i &lt;&lt; 1), og++) {\n                for (int k = 0; k &lt; i; k++) {\n                    ll x = a[j + k], y = a[i + j + k] * w2[og] % mod;\n                    a[i + j + k] = (x - y + mod) % mod;\n                    a[j + k] = (x + y) % mod;\n                }\n            }\n        }\n    }\n\n    void DIT(vector&lt;ll&gt; &amp;a) {\n        // \u5916\u5c42\u5faa\u73af\u662f DIF\n        for (int i = 1; i &lt; n; i &lt;&lt;= 1) {\n            for (int j = 0, og = 0; j &lt; n; j += (i &lt;&lt; 1), og++)\n                for (int k = 0; k &lt; i; k++) {\n                    ll y = (a[j + k] + a[i + j + k]) % mod;\n                    a[i + j + k] = (a[j + k] - a[i + j + k] + mod) * w2[og] % mod;\n                    a[j + k] = y;\n                }\n        }\n    }\n    inline void DNTT(vector&lt;ll&gt; &amp;a) {\n        DIF(a);\n    }\n    inline void IDNTT(vector&lt;ll&gt; &amp;a) {\n        DIT(a);\n        reverse(a.begin() + 1, a.begin() + n);\n        ll inv = f_pow(n, mod - 2);\n        for (int i = 0; i &lt; n; i++)\n            a[i] = a[i] * inv % mod;\n    }\n}\n\nint n, m;\nvector&lt;ll&gt; a, b;\nint main() {\n    scanf(\"%d%d\", &amp;n, &amp;m);\n    a.resize(n + m + 1, 0);\n    b.resize(n + m + 1, 0);\n    for (int i = 0; i &lt;= n; i++)\n        scanf(\"%lld\", &amp;a[i]);\n    for (int i = 0; i &lt;= m; i++)\n        scanf(\"%lld\", &amp;b[i]);\n    int k = std::max((int)ceil(log2(n + m + 1)), 1);\n    NTT::init();\n    NTT::NTT_init(k);\n    a.resize(1 &lt;&lt; k);\n    b.resize(1 &lt;&lt; k);\n    fill(a.begin() + n + 1, a.begin() + (1 &lt;&lt; k), 0);\n    fill(b.begin() + m + 1, b.begin() + (1 &lt;&lt; k), 0);\n    NTT::DNTT(a);\n    NTT::DNTT(b);\n    for (int i = 0; i &lt; (1 &lt;&lt; k); i++)\n        a[i] = a[i] * b[i] % mod;\n    NTT::IDNTT(a);\n    for (int i = 0; i &lt; n + m + 1; i++)\n        printf(\"%lld \", a[i]);\n    puts(\"\");\n    return 0;\n}\n</code></pre> <p>\u542c\u8bf4\u8fd8\u80fd\u518d\u5feb\u70b9 \u6700\u65b0\u6700\u70ed\u591a\u9879\u5f0f\u4e58\u6cd5\u5e38\u6570\u4f18\u5316 - Kevin090228 \u7684\u535a\u5ba2 \u4f46\u662f\u6446\u4e86\u3002</p>"}, {"location": "Algorithms/Counting/Calculating_1/", "title": "Calculating 1", "text": "<p>\u5bf9\u4e8e\u6211\u4eec\u7ecf\u8fc7\u4e00\u901a\u5206\u6790\u4e4b\u540e\u5f97\u5230\u7684\u5c01\u95ed\u5f62\u5f0f\uff0c\u6211\u4eec\u5927\u591a\u6570\u65f6\u5019\u9700\u8981\u505a\u5230\u7684\u662f\u6c42\u51fa\u5176\u7b2c \\(0\\sim n\\) \u9879\u7cfb\u6570\u3002\u8fd9\u610f\u5473\u7740\uff0c\u867d\u7136\u6211\u4eec\uff08\u51e0\u4e4e\uff09\u603b\u662f\u5728\u64cd\u7eb5\u65e0\u7a77\u548c\u5f0f\uff0c\u4f46\u5bf9\u4e8e\u6700\u540e\u8ba1\u7b97\u7684\u90e8\u5206\uff0c\u6211\u4eec\u5728\u6bcf\u4e00\u6b65\u7684\u8fd0\u7b97\u90fd\u53ea\u7528\u8003\u8651\u5176 \\(0\\sim n\\) \u9879\u7684\u7cfb\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u5bf9\u4e00\u4e2a\u6709\u9650\u7684\u591a\u9879\u5f0f\u8fdb\u884c\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\u3002\u5373\uff0c\u770b\u8d77\u6765\u6211\u4eec\u5728\u64cd\u4f5c\u65e0\u7a77\u548c\u5f0f\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u53ea\u64cd\u4f5c\u4e86\u5b83\u7684\u6709\u9650\u9636\u8fd1\u4f3c\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u591a\u9879\u5f0f \\(F(x)\\)\uff0c\u6211\u4eec\u79f0\u5b83\u53ea\u4fdd\u7559 \\(0\\sim n\\) \u6b21\u5e42\u7684\u7cfb\u6570\uff0c\u5176\u4f59\u7684\u7cfb\u6570\u8bbe\u4e3a \\(0\\) \u6240\u5f97\u5230\u7684\u591a\u9879\u5f0f \\(G\\)\uff0c\u662f\u591a\u9879\u5f0f \\(F\\) \u5230 \\(n\\) \u9636\u7684\u622a\u65ad\u3002</p>"}, {"location": "Algorithms/Counting/Calculating_2/", "title": "Calculating 2", "text": "<p>\u6284\u5199\u81ea \u6d45\u8c08\u591a\u9879\u5f0f\u590d\u5408\u548c\u62c9\u683c\u6717\u65e5\u53cd\u6f14 - Alpha1022 \u4e0e \u591a\u9879\u5f0f\u8ba1\u6570\u6742\u8c08 - Command_block\u3002</p> <p>\u672c\u6587\u65e0\u4efb\u4f55\u8bc1\u660e\u3002</p>"}, {"location": "Algorithms/Counting/Calculating_2/#_1", "title": "\u62c9\u683c\u6717\u65e5\u53cd\u6f14", "text": "<p>\u5b9a\u7406 1\uff08\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff09</p> <p>\u82e5 \\([x^0]F(x)=0,[x^1]F(x)\\neq 0\\)\uff0c\u4e14 \\(G(F(x))=x\\)\uff0c\u5373 \\(G\\) \u4e3a \\(F\\) \u7684\u590d\u5408\u9006\uff0c\u5219\u6709</p> <p>$$ n[x^n]F^k(x)=k[x^{-k}]G^{-n}(x) $$ \u4e5f\u5373 $$ [x^n]F^k(x)=\\frac{k}{n}[x^{n-k}]\\qty(\\frac{G(x)}{x})^{-n} $$ \u8fd9\u5f0f\u4e5f\u5c31\u662f\u5728\u53f3\u8fb9\u4e58\u4e0a\u4e86\u4e00\u4e2a \\(x^n\\)\uff0c\u7136\u540e\u63d0\u53d6 \\([x^{n-k}]\\) \u7684\u7cfb\u6570\u3002</p> <p>\u5b9a\u7406 2\uff08\u6269\u5c55\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff09</p> <p>\u6761\u4ef6\u540c\u4e0a\uff0c\\(H\\) \u662f\u4e00\u4e2a\u4efb\u610f\u5f62\u5f0f Laurent \u7ea7\u6570\uff0c\u5219</p> <p>$$ [x^n]H(F)=\\frac{1}{n}[x^{n-1}]H'\\qty(\\frac{G}{x})^{-n} $$ \u5b9a\u7406 3\uff08\u53e6\u7c7b\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff0cEI\uff09</p> <p>\u6761\u4ef6\u4ecd\u540c 1\uff0c\u6709 $$ [x^n]F(x)=[x^{-k-1}]G'G^{-n-1} $$</p>"}, {"location": "Algorithms/Counting/Exercise/", "title": "Exercise", "text": "\\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\Endpos{\\operatorname{Endpos}} \\newcommand\\Startpos{\\operatorname{Startpos}} \\newcommand\\height{\\operatorname{height}} \\newcommand\\SA{\\operatorname{SA}} \\newcommand\\len{\\operatorname{len}} \\newcommand\\chkmax{\\operatorname{chkmax}} \\newcommand\\chkmin{\\operatorname{chkmin}} \\newcommand\\siz{\\operatorname{siz}} \\newcommand\\fa{\\operatorname{fa}} \\newcommand\\LCP{\\operatorname{LCP}} \\newcommand\\EGF{\\operatorname{EGF}} \\newcommand\\OGF{\\operatorname{OGF}} \\]"}, {"location": "Algorithms/Counting/Exercise/#_1", "title": "\u57fa\u7840\u6280\u672f", "text": ""}, {"location": "Algorithms/Counting/Exercise/#p4931-mtoi2018", "title": "P4931 [MtOI2018] \u60c5\u4fa3\uff1f\u7ed9\u6211\u70e7\u4e86\uff01", "text": "<p>\u9996\u5148\u8003\u8651\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u4ee4 \\(g(n,k)\\) \u8868\u793a \\(n\\) \u5bf9\u6070\u597d\u6709 \\(k\\) \u5bf9\u5750\u5728\u4e00\u8d77\u7684\u65b9\u6848\u6570\uff0c\\(h(n,k)\\) \u8868\u793a\u6240\u6709\u5148\u9009\u5b9a \\(k\\) \u4e2a\uff0c\u5176\u4ed6\u4efb\u610f\u6392\u7684\u65b9\u6848\u6570\u4e4b\u548c\u3002</p> \\[ g(n,k)=\\sum_{i=k}^{n}(-1)^{i-k}\\binom{i}{k}h(n,i) \\] <p>\u800c</p> \\[ h(n,i)=\\binom{n}{i}^2i!2^i(2(n-i))! \\] <p>\u5148\u9009\u5b9a \\(i\\) \u4e2a\u5ea7\u4f4d\uff0c\u5728\u9009\u5b9a \\(i\\) \u5bf9\u60c5\u4fa3\uff0c\u8fd9 \\(i\\) \u5bf9\u53ef\u4ee5\u5de6\u53f3\u4efb\u610f\u6362\uff0c\u5176\u4ed6 \\(2(n-i)!\\) \u4e2a\u4efb\u610f\u6392\u3002</p> <p>\u8bd5\u56fe\u9884\u5904\u7406 \\(g(n,k)\\) \u53ea\u80fd\u5f97\u5230\u4e00\u4e2a \\(\\mathcal O(n^3)\\) \u9884\u5904\u7406\u7684\u505a\u6cd5\uff0c\u6bcf\u6b21\u91cd\u7b97\u662f \\(\\mathcal O(Tn^2)\\) \u7684\uff0c\u90fd\u4e0d\u592a\u884c\u3002</p> <p>\u8003\u8651\u5148\u9009\u5b9a \\(k\\) \u5bf9\u5750\u5728\u4e00\u8d77\uff0c\u518d\u4e58\u4e0a\u5269\u4e0b\u7684\u4e00\u5bf9\u90fd\u4e0d\u4ea4\u7684\u65b9\u6848\u6570\u3002</p> \\[ \\binom{n}{k}^2k!2^k\\cdot g(n-k,0) \\] <p>\u90a3\u4e48\u95ee\u9898\u5373\u6c42\u51fa \\(c=0,1,2,\\cdots, n\\) \u7684 \\(g(c,0)\\)\u3002</p> \\[ g(c,0)=\\sum_{i=0}^{c}(-1)^{i}\\binom{c}{i}^2i!2^i(2(c-i))! \\] <p>\u8fd9\u662f\u53ef\u4ee5 \\(\\mathcal O(n^2)\\) \u9884\u5904\u7406\u7684\u3002</p> <p>\u663e\u7136\u95ee\u9898\u5c31\u5728\u4e8e\u5904\u7406 \\(g(c, 0)\\) \u4e0a\uff0c\u8003\u8651\u4f18\u5316\u5176\u5904\u7406\uff0c\u4e0b\u9762 \\(g(c,0)\\) \u7b80\u8bb0\u4e3a \\(g(c)\\)\u3002</p> <p>\u603b\u4e4b\u5148\u5316\u6210\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u628a \\((n-i)\\) \u548c \\(i\\) \u5206\u522b\u653e\u4e00\u8d77\u3002 $$ \\begin{aligned} g(n)&amp;=\\sum_{i=0}^{n}(-1)^i\\qty(\\frac{n!}{(n-i)!i!})^2i!2^i(2(n-i))!\\ &amp;=(n!)^2\\sum_{i=0}^{n}\\frac{(2(n-i))!}{(n-i)!^2}\\cdot \\frac{(-2)^i}{i!} \\end{aligned} $$</p> <p>\u8bbe \\(a(n)=\\frac{(2n)!}{n!^2},b(n)=\\frac{(-2)^n}{n!}\\)\uff0c\u5b83\u4eec\u5bf9\u5e94\u7684 \\(\\OGF\\) \u5206\u522b\u4e3a \\(A(x),B(x)\\)\u3002 $$ A(x)=\\sum_{n=0}^{\\infty}\\frac{(2n)!}{n!^2}x^n=\\sum_{n=0}^{\\infty}\\binom{2n}{n}x^n=\\dfrac{1}{\\sqrt{1-4x}} $$</p> \\[ B(x)=\\sum_{n=0}^{\\infty}\\frac{(-2)^n}{n!}x^n=\\exp(-2x)\\\\ \\] <p>\u8003\u8651</p> \\[ G(x)=\\frac{\\mathrm{e}^{-2x}}{\\sqrt{1-4x}} \\] <p>\u51d1\u70b9 ODE \u51fa\u6765\uff1a $$ G'(x)=\\frac{\\mathrm{e}^{-2x}\\cdot 8x}{(1-4x)^{3/2}}\\ \\frac{1-4x}{8x}G'(x)=G(x)\\ G'(x)=4x\\cdot G'(x)+8x\\cdot G(x) $$ \u5373\uff1a $$ g(n)=\\frac{4(n-1)g(n-1)+8g(n-2)}{n} $$</p>"}, {"location": "Algorithms/Counting/Exercise/#_2", "title": "\u7b80\u5355\u8fd0\u7528", "text": ""}, {"location": "Algorithms/Counting/Subset_0/", "title": "Subset 0", "text": "\\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\deg{\\operatorname{deg}} \\newcommand\\pcnt{\\operatorname{popcount}} \\] <p>\u6284\u5199\u4e86 \u4f4d\u8fd0\u7b97\u5377\u79ef(FWT) &amp; \u96c6\u5408\u5e42\u7ea7\u6570 - command_block \u548c \u3010\u5b66\u4e60\u7b14\u8bb0\u3011 \u5b50\u96c6\u5377\u79ef\u76f8\u5173 - UltiMadow\u3002</p>"}, {"location": "Algorithms/Counting/Subset_0/#fwt", "title": "FWT", "text": "<p>\u5176\u5b9e OR, AND, XOR \u4e09\u4e2a\u64cd\u4f5c\u90fd\u80fd\u505a\u3002\u4e0d\u8fc7 OR \u548c AND \u4e00\u822c\u88ab\u66f4\u7b80\u5355\u597d\u5199\u7684 FMT \u66ff\u4ee3\u4e86\u3002</p> <p>FWT \u7684\u60f3\u6cd5\u7c7b\u4f3c FFT\uff0c\u662f\u4e0d\u662f\u4e5f\u6709\u4eba\u53eb\u8fd9\u73a9\u610f\u591a\u7ef4 FFT \u8fd8\u662f\u5565\u6765\u7740\u3002</p> <p>\u8bb0 \\(n=2^k\\)\uff0c\u5176\u4e2d \\(k\\) \u662f\u67d0\u4e2a\u975e\u8d1f\u6574\u6570\u3002</p> <p>\u603b\u4e4b\u5c31\u662f\u4f60\u6709\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5411\u91cf \\(A\\) \u548c \\(B\\)\uff0c\u4f60\u5e0c\u671b\u6c42\u51fa\u540c\u6837\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5411\u91cf \\(X\\)\uff0c\u6ee1\u8db3</p> \\[ X_k=\\sum_{i\\oplus j=k}A_i\\cdot B_j \\] <p>\u8fd9\u91cc \\(\\oplus\\) \u662f\u67d0\u79cd\u8fd0\u7b97\u3002\u7136\u540e FWT / FFT \u7684\u7b2c\u4e00\u6b65\u60f3\u6cd5\u5c31\u662f\uff0c\u53bb\u6784\u9020\u4e00\u4e2a\u5927\u5c0f\u4e3a \\(n\\times n\\) \u7684\u53ef\u9006\u77e9\u9635 \\(C\\)\uff0c\u4f7f\u5f97\u6709</p> \\[ (CA)\\circ (CB)=CX \\] <p>\u5176\u4e2d \\(\\circ\\) \u662f\u77e9\u9635\u7684 Hadamard \u79ef\u3002</p> <p>\u6211\u4eec\u6765\u4ed4\u7ec6\u8003\u5bdf\u77e9\u9635 \\(C\\) \u7684\u6027\u8d28\uff0c\u7b2c\u4e00\u6b65\u662f\u5148\u628a\u77e9\u9635\u4e58\u6cd5\u5c55\u5f00\uff0c\\(\\forall i\\in [0,n)\\)\uff0c\u4e0b\u5217\u7b49\u5f0f\u6210\u7acb\u3002</p> \\[ \\qty(\\sum_{j=0}^{n-1}C_{i,j}A_j)\\qty(\\sum_{j=0}^{n-1}C_{i,j}B_j)=\\sum_{j=0}^{n-1}C_{i,j}X_j \\] <p>\u5de6\u8fb9\u53ef\u4ee5\u76f4\u63a5\u4e58\u6cd5\u5206\u914d\u5f8b</p> \\[ \\sum_{j=0}^{n-1}\\sum_{k=0}^{n-1}C_{i,j}C_{i,k}A_jB_k=\\sum_{j=0}^{n-1}C_{i,j}X_j \\] <p>\u7136\u540e\u628a\u53f3\u8fb9\u7684\u8fd9\u4e2a \\(X_j\\) \u4e5f\u5c55\u5f00\u4e00\u4e0b</p> \\[ \\begin{aligned} \\sum_{j=0}^{n-1}\\sum_{k=0}^{n-1}C_{i,j}C_{i,k}A_jB_k&amp;=\\sum_{j=0}^{n-1}C_{i,j}\\sum_{t_1\\oplus t_2=j}A_{t_1}B_{t_2}\\\\ &amp;=\\sum_{j=0}^{n-1}\\sum_{t_1\\oplus t_2=j}A_{t_1}B_{t_2}C_{i,t_1\\oplus t_2}\\\\ &amp;=\\sum_{t_1=0}^{n-1}\\sum_{t_2=0}^{n-1}A_{t_1}B_{t_2}C_{i,t_1\\oplus t_2} \\end{aligned} \\] <p>\u6211\u4eec\u5c31\u5f97\u5230 \\(C_{i,j}C_{i,k}=C_{i,j\\oplus k}\\)\u3002\u56e0\u4e3a\u6211\u4eec\u7684 FWT \u662f\u4e00\u4e2a\u6309\u4f4d\u7684\u5377\u79ef\uff0c\u6240\u4ee5\u5e94\u5f53\u53ef\u4ee5\u62c6\u4f4d\u8ba1\u7b97\u8d21\u732e\uff0c\u6240\u4ee5\u6709</p> \\[ C_{i,j}=\\prod_{p}C_{i_p,j_p} \\] <p>\u5176\u4e2d \\(i_p,j_p\\) \u5206\u522b\u8868\u793a \\(i,j\\) \u7684\u7b2c \\(p\\) \u4e2a\u4e8c\u8fdb\u5236\u4f4d\u3002\u90a3\u4e48\u6211\u4eec\u6784\u9020\u4e00\u4e2a \\(2\\times 2\\) \u7684\u77e9\u9635\u5373\u53ef\u3002</p> <p>OR \u548c AND \u7684\u6784\u9020\u5c31\u4e0d\u4ecb\u7ecd\u4e86\uff0c\u5177\u4f53\u89c1 cmd \u7684\u535a\u5ba2\u3002\u8003\u8651\u600e\u4e48\u6784\u9020 XOR \u7684\u77e9\u9635\u3002</p> <ol> <li> <p>\\(C_{0,0}C_{0,y}=C_{0,y}\\)\uff0c\u6240\u4ee5 \\(C_{0,0}=1\\)\u3002</p> </li> <li> <p>\\(C_{1,1}C_{1,1}=C_{1,0}\\)</p> </li> <li> <p>\\(C_{1,0}C_{1,1}=C_{1,1}\\)\uff0c\u6545 \\(C_{1,0}=1\\)\u3002\u7ed3\u5408\u4e0a\u5f0f\u6709 \\(C_{1,1}=1\\) \u6216 \\(C_{1,1}=-1\\)\u3002</p> </li> <li> <p>\\(C_{0,1}C_{0,1}=C_{0,0}=1\\)\uff0c\u6240\u4ee5 \\(C_{0,1}=1\\) \u6216 \\(C_{0,1}=-1\\)\u3002</p> </li> <li> <p>\u7531\u4e8e \\(C\\) \u53ef\u9006\uff0c\u4e14 \\(C_{0,0}=C_{1,0}=1\\)\uff0c\u6545 \\(C_{1,1}\\neq C_{0,1}\\)\uff0c\u53ef\u884c\u7684\u77e9\u9635\u6709\u4e14\u53ea\u6709</p> \\[ \\begin{bmatrix} 1 &amp;1\\\\ 1 &amp;-1 \\end{bmatrix}, \\begin{bmatrix} 1 &amp;-1\\\\ 1 &amp;1 \\end{bmatrix} \\] </li> </ol> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f cmd \u8fd9\u91cc\u5199\u9519\u4e86\u2026\u2026 \\(\\begin{bmatrix} 1 &amp;1\\\\ -1 &amp;1 \\end{bmatrix}\\) \u662f\u4e0d\u53ef\u884c\u7684\uff0c\u4ece\u63d0\u4ea4\u8bb0\u5f55 Submission#169888354 \u53ef\u4ee5\u770b\u51fa\u6765 \\(\\begin{bmatrix} 1 &amp;-1\\\\ 1 &amp;1 \\end{bmatrix}\\) \u662f\u5bf9\u7684\u3002\u4f46\u6211\u4eec\u90fd\u4e0d\u7528\u8fd9\u4e2a\uff0c\u800c\u662f\u7528 \\(\\begin{bmatrix} 1 &amp;1\\\\ 1 &amp;-1 \\end{bmatrix}\\)\uff0c\u56e0\u4e3a\u5b83\u7684\u9006\u5c31\u662f\u81ea\u5df1\u4e58\u4e0a \\(\\dfrac{1}{2}\\)\uff0c\u53ef\u4ee5\u5c11\u5199\u4e24\u884c\u3002</p> <p>\u7c7b\u4f3c FFT\uff0cFWT \u7684\u4e00\u4e2a\u5b9e\u73b0\u662f</p> <pre><code>void XOR(ll *f, ll inv) {\n    for (int i = 1; i &lt; (1 &lt;&lt; n); i &lt;&lt;= 1)\n        for (int j = 0; j &lt; (1 &lt;&lt; n); j += (i &lt;&lt; 1))\n            for (int k = 0; k &lt; i; k++) {\n                ll x = f[j + k], y = f[i + j + k];\n                f[j + k] = (x + y) * inv % mod;\n                f[i + j + k] = (x - y + mod) * inv % mod;\n            }\n}\n</code></pre>"}, {"location": "Algorithms/Counting/Subset_0/#_1", "title": "\u5b50\u96c6\u5377\u79ef", "text": "<p>\u4f60\u8bf4\u5f97\u5bf9\uff0c\u4f46\u4f60\u8bf4\u7684\u4e0d\u5bf9\u3002</p> <p>\u7ed9\u4f60\u4e24\u4e2a\u957f\u5ea6\u4e3a \\(2^k\\) \u7684\u5411\u91cf \\(A,B\\)\uff0c\u6c42\u51fa \\(X\\)\uff0c\u5176\u4e2d</p> \\[ X_k=\\sum_{\\substack{i\\operatorname{or}j=k \\\\ i\\operatorname{and}j=0}}A_iB_j \\] <p>\u95ee\u9898\u5c31\u662f\u8fd9\u4e2a \\(i\\operatorname{and} j=0\\) \u7684\u9650\u5236\u5f88\u68d8\u624b\uff0c\u6211\u4eec\u5e0c\u671b\u628a\u5b83\u523b\u753b\u6210\u53e6\u4e00\u4e2a\u4e0e\u4f4d\u76f8\u5173\u7684\u9650\u5236\u3002</p> <p>\u56e0\u4e3a\u9650\u5236\u4ee3\u8868\u7740\u4e0d\u4f1a\u8fdb\u4f4d\uff0c\u6240\u4ee5\u6211\u4eec\u6709 \\(\\pcnt(i)+\\pcnt(j)=\\pcnt(i\\operatorname{or}j)\\)\u3002</p> <p>\u6211\u4eec\u6309 \\(\\pcnt(i)\\) \u5c06 \\(A,B,C\\) \u5206\u4e3a \\(\\log n\\) \u4e2a\u5e8f\u5217\uff0c\u7b2c \\(k\\) \u4e2a\u5e8f\u5217\u4e2d\u7b2c \\(s\\) \u4e2a\u4f4d\u7f6e \\(A_{k,s}=A_{s}\\) \u5f53\u4e14\u4ec5\u5f53 \\(\\pcnt(s)=k\\)\uff0c\u5426\u5219\u8fd9\u4e00\u4f4d\u4e3a \\(0\\)\u3002\\(B\\) \u7684 \\(\\log\\) \u4e2a\u5e8f\u5217\u540c\u7406\u3002\u6211\u4eec\u5206\u522b\u5bf9\u8fd9 \\(\\log\\) \u4e2a\u5e8f\u5217\u5206\u522b FMT\uff0c\u7136\u540e \\(A\\) \u7684\u7b2c \\(i\\) \u4e2a\u5e8f\u5217\u548c \\(B\\) \u7684\u7b2c \\(j\\) \u4e2a\u5e8f\u5217\u8d21\u732e\u5230 \\(C\\) \u7684\u7b2c \\(i+j\\) \u4e2a\u5e8f\u5217\u3002\u590d\u6742\u5ea6 \\(\\mathcal O(n^22^n)\\)\u3002</p> <p>\u4e00\u4e2a\u5b9e\u73b0\u3002</p>"}, {"location": "Algorithms/Counting/Subset_1/", "title": "Subset 1", "text": ""}, {"location": "Algorithms/Counting/Subset_1/#ln-exp", "title": "Ln \u4e0e Exp", "text": "<p>\u65e2\u7136\u80fd\u505a\u5b50\u96c6\u5377\u79ef\uff0c\u90a3\u4e48\u4e5f\u7406\u5e94\u80fd\u5bf9\u96c6\u5408\u5e42\u7ea7\u6570\u505a\u4e00\u7cfb\u5217\u5f62\u5f0f\u5e42\u7ea7\u6570\u4e0a\u5bf9\u5e94\u7684\u64cd\u4f5c\u3002</p> <p>\u8003\u8651\u5148\u524d\u7684\u5b50\u96c6\u5377\u79ef\u505a\u6cd5\uff0c\u5b9e\u9645\u4e0a\u662f\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86\u4e00\u4e2a\u7ef4\u5ea6\u6765\u8bb0\u5f55\u96c6\u5408\u7684\u5927\u5c0f\uff0c\u5373\u901a\u8fc7\u5360\u4f4d\u591a\u9879\u5f0f\u533a\u5206\u51fa\u4e86\u5e94\u5f53\u6ea2\u51fa\u7684\u503c\uff0c\u5bf9\u539f\u6765\u7ef4\u5ea6\u6bcf\u4e2a\u503c\u9010\u6b21\u4f5c\u83ab\u6bd4\u4e4c\u65af\u53d8\u6362\uff0c\u518d\u5bf9\u5360\u4f4d\u591a\u9879\u5f0f\u7684\u4e00\u7ef4\u4f5c\u5f62\u5f0f\u5e42\u7ea7\u6570\u64cd\u4f5c\u3002</p> <p>\u540c\u6837\u7684\uff0c\u96c6\u5408\u5e42\u7ea7\u6570\u7684 Ln \u4e0e Exp \u5c31\u662f\u8fd9\u4e48\u505a\u7684\u3002</p> <p>\u4f46\u6211\u4eec\u80af\u5b9a\u4e0d\u4f1a\u5199\u90a3\u4e2a FFT \u7684\uff0c\u5e38\u6570\u4e5f\u592a\u7206\u4e86\u3002</p> <p>\u6211\u4eec\u77e5\u9053 \\(G=\\exp-1\\) \u6ee1\u8db3</p> \\[ G'=F'\\exp(F) \\] <p>\u63d0\u53d6\u7b2c \\(n-1\\) \u9879\u7cfb\u6570\u6709</p> \\[ g_n=\\frac{1}{n}\\sum_{i=1}^{n-1}if_{i}g_{n-i} \\] <p>\u90a3\u5bf9\u8fd9\u4e2a\u53d8\u5316\u4e00\u4e0b\u5f0f\u5b50\u53ef\u4ee5\u5f97\u5230\u5b83\u7684\u9006\u53d8\u6362 \\(\\ln\\)\uff0c\u5373</p> \\[ g_n=f_n-\\frac{1}{n}\\sum_{i=1}^{n}ig_if_{n-i} \\]"}, {"location": "Algorithms/Counting/Tricks_1/", "title": "Tricks 1", "text": "\\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\ag[1]{\\left\\langle#1\\right\\rangle} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\ol[1]{\\overline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\deg{\\operatorname{deg}} \\newcommand\\pcnt{\\operatorname{popcount}} \\] <p>\u672c\u8282\u5185\u5bb9\u5b58\u5728\u7684\u76ee\u7684\u5927\u6982\u5c31\u662f\u7b80\u5355\u63d0\u4e00\u4e0b\u8fd9\u51e0\u4e2a\u4e1c\u897f\u7684\u5b58\u5728\uff0c\u7136\u540e\u5e94\u7528\u5728\u4e0b\u4e00\u8282\u3002</p>"}, {"location": "Algorithms/Counting/Tricks_1/#_1", "title": "\u62c9\u683c\u6717\u65e5\u53cd\u6f14", "text": "<p>\u7531\u4e8e\u8bc1\u660e\u5e76\u6ca1\u6709\u90a3\u4e48\u91cd\u8981\u6211\u4e0d\u4f1a\uff0c\u6240\u4ee5\u4ee5\u4e0b\u4f1a\u7565\u8fc7\u76f8\u5173\u7684\u8bc1\u660e\u3002</p> <p>\u4e0b\u9762\u8ba8\u8bba\u7684\u4e0d\u518d\u662f\u5f62\u5f0f\u5e42\u7ea7\u6570\uff0c\u800c\u662f\u5f62\u5f0f \\(\\text{Laurent}\\) \u7ea7\u6570\u3002</p> <p>\u5b9a\u4e49\uff1a</p> <p>\u4e00\u4e2a\u6700\u4f4e\u6b21\u9879\u4e3a \\(n_0\\) \u7684\u5f62\u5f0f \\(\\text{Laurent}\\) \u7ea7\u6570 \\(A(x)\\) \u88ab\u5b9a\u4e49\u4e3a</p> \\[ A(x)=\\sum_{i=n_0}^{+\\infty}a_ix^i \\] <p>\u76f8\u5173\u7684\u6027\u8d28\u53ef\u4ee5\u53c2\u8003<sup>1</sup>\u3002</p> <p>\u4e24\u4e2a\u5f62\u5f0f \\(\\text{Laurent}\\) \u7ea7\u6570 \\(F\\) \u590d\u5408 \\(G\\) \u7684\u7ed3\u679c \\(H\\) \u4e3a\uff1a</p> \\[ H(x)=\\sum_{k=n_0}^{+\\infty}f_kG^k(x) \\] <p>\u663e\u7136\uff0c\u5f53 \\(F(x)\\) \u9879\u6570\u6709\u9650\u6216 \\(G(0)=0\\) \u65f6\u590d\u5408\u624d\u826f\u5b9a\u4e49\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4 \\(0\\) \u6b21\u9879\u7cfb\u6570\u53d1\u6563\u3002</p> <p>\u5bf9\u4e8e\u4e24\u4e2a\u5f62\u5f0f \\(\\text{Laurent}\\) \u7ea7\u6570\uff0c\u82e5 \\(F(G(x))=x\\)\uff0c\u5219\u79f0 \\(G\\) \u4e3a \\(F\\) \u7684\u590d\u5408\u9006\uff0c\u8bb0\u4f5c \\(G(x)=F^{\\ag{1}}(x)\\)\u3002</p> <p>\u7531\u4e8e\u5f62\u5f0f \\(\\text{Laurent}\\) \u5728\u590d\u5408\u610f\u4e49\u4e0b\u6784\u6210\u7fa4\uff0c\u6240\u4ee5\u82e5 \\(G\\) \u4e3a \\(F\\) \u7684\u590d\u5408\u9006\uff0c\\(G\\) \u4e5f\u662f \\(F\\) \u7684\u590d\u5408\u9006\u3002</p> <p>\u5b9a\u7406 1. \u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff1a</p> <p>\u5bf9\u4e8e\u5f62\u5f0f \\(\\text{Laurent}\\) \u7ea7\u6570 \\(F(x)\\)\uff0c\u82e5 \\(n_0=1\\)\uff0c\u8bbe \\(G(x)\\) \u4e3a \\(F(x)\\) \u7684\u590d\u5408\u9006\uff0c\u5219 \\(\\forall n,k\\in \\mathbb Z\\)</p> \\[ \\begin{aligned} n[x^n]F^k(x)=k[x^{-k}]G^{-n}(x) \\end{aligned} \\nonumber \\] <p>\u8fd9\u6761\u5f0f\u5b50\u7684\u7ebf\u6027\u7ec4\u5408\u53ef\u4ee5\u5bfc\u51fa\u4e0b\u9762\u7684\u6269\u5c55\u62c9\u683c\u6717\u65e5\u53cd\u6f14\u3002</p> <p>\u5b9a\u7406 2. \u6269\u5c55\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff1a</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u7684\u5f62\u5f0f \\(\\text{Laurent}\\) \u7ea7\u6570 \\(P(x)\\)\uff0c\u82e5 \\(F,G\\) \u6ee1\u8db3\u7684\u6761\u4ef6\u540c\u4e0a\uff0c\u5219</p> \\[ [x^n]P(F(x))=\\frac{1}{n}[x^{n-1}]P'\\qty(\\frac{x}{G(x)})^n \\] <p>\u5bf9\u4e8e\u4e00\u4e9b\u7279\u6b8a\u7684\u60c5\u51b5\uff0c\u4e0a\u9762\u7684\u516c\u5f0f\u53ef\u80fd\u5e76\u4e0d\u591f\u7528\uff0c\u4ece\u800c\u5f15\u51fa\u4e86\u5982\u4e0b\u7684\u7ed3\u679c\u3002</p> <p>\u5b9a\u7406 3. \u53e6\u7c7b\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff08by EI)\uff1a</p> <p>\u82e5 \\(F,G\\) \u6ee1\u8db3\u7684\u6761\u4ef6\u540c\u5b9a\u7406 1\uff0c\u5219 \\(\\forall n,k\\in \\mathbb Z\\)\uff0c\u6709</p> \\[ [x^n]F^k(x)=[x^{-k-1}]G'(x)\\qty(\\frac{1}{G(x)})^{n+1} \\] <p>\u540c\u6837\uff0c\u8fd9\u5f0f\u4e5f\u6709\u4e00\u4e2a\u6269\u5c55\u5f62\u5f0f</p> <p>\u5b9a\u7406 4. \u6269\u5c55\u53e6\u7c7b\u62c9\u683c\u6717\u65e5\u53cd\u6f14 (by EI):</p> <p>\u82e5 \\(P,F,G\\) \u6ee1\u8db3\u7684\u6761\u4ef6\u540c\u5b9a\u7406 2\uff0c\u5219\u6709</p> \\[ [x^n]P(F(x))=[x^n]P(x)G'(x)\\qty(\\frac{x}{G(x)})^{n+1} \\]"}, {"location": "Algorithms/Counting/Tricks_1/#ode", "title": "ODE", "text": "<ol> <li> <p>\u6d45\u8c08\u591a\u9879\u5f0f\u4e0e\u751f\u6210\u51fd\u6570 - joke3579 \u21a9</p> </li> </ol>"}, {"location": "Algorithms/Counting/basic/", "title": "Basic", "text": ""}, {"location": "Algorithms/Counting/basic/#_1", "title": "\u57fa\u672c\u7684\u5b9a\u7406 / \u6052\u7b49\u5f0f", "text": ""}, {"location": "Algorithms/Counting/basic/#_2", "title": "\u4e8c\u9879\u5f0f\u5b9a\u7406", "text": "\\[ (x+y)^n=\\sum_{i=0}^{n}\\binom{n}{i}x^iy^{n-i} \\] <p>\u5bf9\u4e8e\u6307\u6570\u4e0d\u4e3a\u975e\u8d1f\u6574\u6570\u7684\u60c5\u51b5\uff0c\u6709\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406\uff1a</p> \\[ (x+y)^{\\alpha}=\\sum_{k=0}^{\\infty}\\frac{\\alpha^{\\underline{k}}}{k!}x^ky^{\\alpha-k} \\]"}, {"location": "Algorithms/Counting/basic/#_3", "title": "\u63d2\u503c", "text": "<p>\u5b9a\u7406\uff1a\\(n\\) \u4e2a\u70b9\u503c\u53ef\u4ee5\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a \\(n-1\\) \u6b21\u7684\u591a\u9879\u5f0f\u3002</p>"}, {"location": "Algorithms/Counting/basic/#_4", "title": "\u62c9\u683c\u6717\u65e5\u63d2\u503c", "text": "<p>\u7ed9\u51fa\u4e00\u4e2a \\(n-1\\) \u6b21\u591a\u9879\u5f0f \\(F(x)\\) \u5728 \\(n\\) \u4e2a\u70b9\u7684\u70b9\u503c \\((a_i,b_i\\))\uff0c\u8bd5\u8fd8\u539f \\(F(x)\\)\u3002</p> <p>\u62c9\u683c\u6717\u65e5\u63d2\u503c\u7ed9\u4e86\u6211\u4eec\u4e00\u79cd\u53ef\u4ee5\u8fd8\u539f\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u6784\u9020\u3002</p> <p>\u8003\u8651\u4e00\u4e2a\u591a\u9879\u5f0f \\(G_i\\)\uff0c\u5b83\u6ee1\u8db3 \\(G_i(a_i)=b_i\\)\uff0c\u5e76\u4e14\u5bf9\u4e8e\u6240\u6709 \\(j\\neq i,G_i(a_j)=0\\)\u3002</p> <p>\u90a3\u4e48\u5c31\u6709 \\(F(x)=\\sum_{i=1}^{n} G_i\\)\u3002</p> <p>\u6211\u4eec\u6765\u8bd5\u7740\u6784\u9020\u8fd9\u4e2a \\(G_i\\)\uff0c\u9996\u5148\u6240\u6709 \\(j\\neq i\\) \u7684 \\(a_j\\) \u90fd\u662f\u5b83\u7684\u96f6\u70b9\uff0c\u90a3\u4e48\u5c31\u5e94\u8be5\u662f\uff1a</p> \\[ \\prod_{j\\neq i}(x-a_j) \\] <p>\u7136\u540e\u5b83\u5728 \\(a_i\\) \u5904\u7684\u70b9\u503c\u8fd8\u5e94\u4e3a \\(b_i\\)\uff0c\u90a3\u4e48\u6211\u4eec\u5148\u9664\u6389 \\(\\prod_{j\\neq i}(a_i-a_j)\\)\uff0c\u518d\u4e58\u4e0a \\(b_i\\)\uff0c\u4e5f\u5c31\u662f\u8bf4\uff1a</p> \\[ F(x)=\\sum_{i=1}^{n}\\frac{b_i\\prod_{j\\neq i}(x-a_j)}{\\prod_{j\\neq i}(a_i-a_j)} \\] <p>\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u5728 \\(\\mathcal O(n^2)\\) \u7684\u65f6\u95f4\u5185\u6c42\u51fa\u67d0\u4e00\u70b9\u7684\u503c\u4e86\u3002\u8003\u8651\u8fdb\u4e00\u6b65\u6c42\u51fa\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u3002</p> <p>\u6211\u4eec\u5148\u6c42\u51fa\u591a\u9879\u5f0f \\(G(x)=\\prod_{i}(x-a_i)\\)\uff0c\u663e\u7136\u8fd9\u53ef\u4ee5\u5728 \\(\\mathcal O(n^2)\\) \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u3002</p> <p>\u7136\u540e\u5229\u7528\u7c7b\u4f3c\u4e8e\u56de\u64a4\u80cc\u5305\u7684 Trick\uff0c\u5bf9\u4e8e\u6bcf\u4e2a \\(j\\)\uff0c\u6211\u4eec\u94a6\u5b9a \\((x-a_j)\\) \u662f\u6700\u540e\u4e00\u4e2a\u4e58\u7684\uff08\u6709\u4ea4\u6362\u5f8b\uff09\uff0c\u4ee4 \\(P_i(x)=\\prod_{j\\neq i}(x-a_j)\\)\uff0c\u90a3\u4e48\u6709</p> \\[ \\begin{aligned} G(x)&amp;=(x-a_i)P_i(x)\\\\ G(x)&amp;=xP_i(x)-a_iP_i(x)\\\\ [x^k]G(x)&amp;=[x^{k-1}]P_i(x)-a_i[x^k]P_i(x) \\end{aligned} \\] <p>\u5176\u4e2d\u663e\u7136 \\([x^0]G(x)=-a_i[x^0]P_i(x)\\)\u3002\u5bf9\u4e8e\u6bcf\u4e2a \\(k\\)\uff0c\u5047\u4f7f\u6211\u4eec\u5df2\u7ecf\u7b97\u51fa\u4e86 \\(&lt;k\\) \u9879\u7684 \\(P_i(x)\\) \u7684\u7cfb\u6570\uff0c\u90a3\u4e48</p> \\[ [x^k]P_i(x)=\\frac{[x^k]G(x)-[x^{k-1}]P_i(x)}{-a_i} \\] <p>\\(\\mathcal O(n)\\) \u9012\u63a8\u5373\u53ef\u7b97\u51fa\u6574\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u3002</p>"}, {"location": "Algorithms/Counting/basic/#_5", "title": "\u8fde\u7eed\u70b9\u503c\u63d2\u503c", "text": "<p>\u5047\u5982 \\((a_i,b_i)\\) \u4e2d\u7684 \\(a_i\\) \u662f\u4e00\u4e2a \\(1\\sim n\\) \u7684\u6392\u5217\uff0c\u5e76\u4e14\u6211\u4eec\u53ea\u9700\u8981\u8be2\u95ee\u67d0\u4e00\u4e2a\u70b9 \\(k\\) \u5904 \\(F(k)\\) \u7684\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u505a\u5230 \\(\\mathcal O(n)\\) \u7684\u590d\u6742\u5ea6\u3002</p> <p>\u9996\u5148\u662f</p> \\[ \\prod_{j\\neq i}(a_i-a_j) \\] <p>\u5bf9\u4e8e \\(a_j&lt;a_i\\) \u7684\u90e8\u5206\uff0c\u8d21\u732e\u663e\u7136\u662f \\((a_i-1)!\\)\uff0c\u5bf9\u4e8e \\(a_j&gt;a_i\\) \u7684\u90e8\u5206\uff0c\u5219\u662f</p> \\[ \\prod_{k=1}^{n-a_i}(-k)=(-1)^{n-a_i}(n-a_i)! \\] <p>\u663e\u7136\u5728\u9884\u5904\u7406\u9636\u4e58\u540e\u53ef\u4ee5 \\(\\mathcal O(1)\\) \u8ba1\u7b97\u3002</p> <p>\u800c\u5bf9\u4e8e</p> \\[ \\prod_{j\\neq i}(k-a_j) \\] <p>\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u5e8f\u5217 \\(p_i=(k-a_i)\\)\uff0c\u90a3\u4e48\u663e\u7136\u8fd9\u5c31\u662f</p> \\[ \\prod_{j&lt;i}p_j\\prod_{j&gt;i}p_j \\] <p>\u7ef4\u62a4\u524d\uff0c\u540e\u7f00\u79ef\u5373\u53ef\u3002</p> <p>\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u88ab\u63a8\u5e7f\u5230 \\(a_i\\) \u662f\u4e00\u4e2a \\(l\\sim r\\) \u7684\u6392\u5217\u7684\u60c5\u51b5\u3002</p> <p>\u4f8b\uff1aCF622F. The Sum of the k-th Powers</p> <p>\u7ecf\u5178\u7ed3\u8bba\u662f \\(1\\sim n\\) \u7684 \\(k\\) \u6b21\u5e42\u4e4b\u548c\u662f\u4e00\u4e2a \\(k+1\\) \u6b21\u591a\u9879\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u63d2 \\(k+2\\) \u4e2a\u503c\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u800c \\(\\operatorname{id}^k\\) \u662f\u4e00\u4e2a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u53ef\u4ee5\u76f4\u63a5\u7ebf\u6027\u7b5b\u3002</p> <p>\u4ee3\u7801\uff1aSubmission #296314171 - Codeforces</p>"}, {"location": "Algorithms/Counting/basic/#_6", "title": "\u53cd\u6f14", "text": ""}, {"location": "Algorithms/Counting/basic/#_7", "title": "\u4e8c\u9879\u5f0f\u53cd\u6f14", "text": "<p>\u5f62\u5f0f 1\uff1a $$ f(n)=\\sum_{i=n}^{m}\\binom{i}{n}g(i)\\Longleftrightarrow g(n)=\\sum_{i=n}^{m}(-1)^{i-n}\\binom{i}{n}f(i) $$</p> <p>\\(f(i)\\) \u4e0e \\(g(i)\\) \u7684\u7ec4\u5408\u610f\u4e49\u4e3a\uff1a\\(g(i)\\) \u8868\u793a\u6240\u6709\u6070\u597d\u6ee1\u8db3 \\(i\\) \u6761\u9650\u5236\u7684\u7ec4\u5408\u7ed3\u6784\u6570\uff0c\\(f(i)\\) \u8868\u793a\u6240\u6709\u201c\u5728 \\(m\\) \u6761\u9650\u5236\u4e2d\u9009\u5b9a \\(n\\) \u6761\u7684\u65b9\u6848\u201d\u7684\u6743\u503c\u4e4b\u548c\uff0c\u6bcf\u79cd\u65b9\u6848\u7684\u6743\u503c\u662f\u6ee1\u8db3\u8fd9 \\(n\\) \u6761\u9650\u5236\u7684\u7ec4\u5408\u7ed3\u6784\u6570\u3002\u663e\u7136\uff0c\u6240\u6709\u65b9\u6848\u7684\u6743\u503c\u5e94\u76f8\u540c\u3002</p> <p>\u5f62\u5f0f 2\uff1a $$ f(n)=\\sum_{i=0}^{n}\\binom{n}{i}g(i)\\Longleftrightarrow g(n)=\\sum_{i=0}^{n}(-1)^{n-i}\\binom{n}{i}f(i) $$</p> <p>\\(f(i)\\) \u4e0e \\(g(i)\\) \u7684\u7ec4\u5408\u610f\u4e49\u4e3a\uff1a\\(g(i)\\) \u8868\u793a\u5728 \\(n\\) \u6761\u9650\u5236\u4e2d\u9009\u62e9 \\(i\\) \u6761\u540e\uff0c\u6070\u597d\u6ee1\u8db3\u8fd9 \\(i\\) \u6761\u9650\u5236\u7684\u7ec4\u5408\u7ed3\u6784\u6570\uff0c\\(f(i)\\) \u8868\u793a\u5728 \\(n\\) \u6761\u9650\u5236\u4e2d\u9009\u62e9 \\(i\\) \u6761\u540e\uff0c\u6ee1\u8db3\u7684\u6240\u6709\u9650\u5236\u90fd\u5c5e\u4e8e\u8fd9 \\(i\\) \u6761\u7684\u7ec4\u5408\u7ed3\u6784\u6570\u3002</p> <p>\u8bc1\u660e\u89c1 \u4e8c\u9879\u5f0f\u53cd\u6f14\u53ca\u5176\u5e94\u7528 - GXZlegend\u3002</p>"}, {"location": "Algorithms/Counting/basic/#burnside-polya", "title": "Burnside \u5f15\u7406\u4e0e P\u00f3lya \u5b9a\u7406", "text": ""}, {"location": "Algorithms/Counting/basic/#_8", "title": "\u7fa4\u4f5c\u7528 / \u7b49\u4ef7\u7c7b", "text": "<p>\u6211\u4eec\u5047\u8bbe\u6709\u4e00\u4e2a\u7fa4 \\((G,*)\\) \u548c\u4e00\u4e2a\u96c6\u5408 \\(X\\)\uff0c\u540c\u65f6\u53c8\u6709\u4e00\u4e2a\u6620\u5c04 \\(G\\times X\\rightarrow X\\)\uff08\u5c06 \\(G\\) \u4e0e \\(X\\) \u7684\u7b1b\u5361\u5c14\u79ef\u6620\u5c04\u5230 \\(X\\)\uff09\u3002\u8bb0 \\((g,x)\\) \u5728\u6b64\u6620\u5c04\u4e0b\u7684\u50cf\u4e3a \\(g\\cdot x\\)\uff0c\u90a3\u4e48\u82e5\u6620\u5c04\u6ee1\u8db3</p> <ol> <li>\\((g*h)\\cdot x=g\\cdot (h\\cdot x)\\) \u5bf9\u6240\u6709 \\(g,h\\in G,x\\in X\\) \u6210\u7acb\u3002</li> <li>\\(e\\cdot x=x\\)\uff0c\u5176\u4e2d \\(e\\) \u662f \\(G\\) \u7684\u5355\u4f4d\u5143\u3002</li> </ol> <p>\u90a3\u4e48\u6b64\u6620\u5c04\u5219\u88ab\u79f0\u4e3a\u4e00\u4e2a \\(G\\) \u5728 \\(X\\) \u4e0a\u7684\uff08\u5de6\uff09\u7fa4\u4f5c\u7528\u3002</p> <p>\u6211\u4eec\u79f0 \\(x,y\\) \u6ee1\u8db3\u4e00\u79cd\u5173\u7cfb \\(x\\sim y\\)\uff0c\u5f53\u4e14\u4ec5\u5f53 \\(\\exists g\\in G,g\\cdot x=y\\)\u3002</p> <p>\u663e\u7136\u7531\u7fa4\u7684\u6027\u8d28\u53ef\u4ee5\u5bfc\u51fa \\(x\\sim y\\) \u7684\u5bf9\u79f0\uff0c\u81ea\u53cd\uff0c\u4f20\u9012\u6027\u3002\u6240\u4ee5 \\(x\\sim y\\) \u662f\u4e00\u79cd\u7b49\u4ef7\u5173\u7cfb\u3002</p> <p>\u6211\u4eec\u8981\u6c42\u7684\u95ee\u9898\u5c31\u662f\u5728\u8fd9\u6837\u7684\u7b49\u4ef7\u5173\u7cfb\u4e0b\uff0c\u7b49\u4ef7\u7c7b\u96c6\u5408 \\(X/G\\) \u7684\u5927\u5c0f\u3002</p>"}, {"location": "Algorithms/Counting/basic/#lgv-lemma", "title": "LGV Lemma", "text": ""}, {"location": "Algorithms/Counting/basic/#matrix-tree-best", "title": "Matrix Tree \u5b9a\u7406\u4e0e BEST \u5b9a\u7406", "text": ""}, {"location": "Algorithms/Counting/object/", "title": "Object", "text": ""}, {"location": "Algorithms/Counting/object/#prufer", "title": "Pr\u00fcfer \u5e8f\u5217", "text": ""}, {"location": "Algorithms/Counting/object/#_1", "title": "\u683c\u8def", "text": ""}, {"location": "Algorithms/Counting/object/#_2", "title": "\u6768\u8868", "text": ""}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-1/", "title": "Trees 1", "text": "<p>\u6811\u4e0a\u95ee\u9898\u8981\u7ef4\u62a4\u7684\u5bf9\u8c61\u4e00\u822c\u6709\uff1a - \u5b50\u6811\uff08\u8fde\u901a\u5757\uff09 - \u6811\u94fe - \u70b9\uff08\u6216\u6811\u94fe\u7684\uff09\u90bb\u57df</p>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/", "title": "Trees 3", "text": "<p>\u624d\u80fd\u306a\u3093\u3066\u306a\u3044\u304b\u3089</p> <p>\u3053\u3053\u3067\u4e00\u751f\u6ce3\u3044\u3066\u3044\u308b\u3093\u3060\u308d</p> <p>\u76ee\u306b\u6620\u3063\u305f\u666f\u8272\u306e\u9752\u3055\u304c</p> <p>\u7fa8\u307e\u3057\u304f\u601d\u3063\u3066\u3044\u305f </p> <p>\u53c2\u8003\u8d44\u6599</p> <ol> <li>Top Tree \u76f8\u5173\u7406\u8bba\u626f\u6de1 - ExplodingKonjac</li> <li>\u9759\u6001 Top Tree \u5165\u95e8 - ChiFan</li> <li>\u7b80\u5355\u840c\u840c\u54d2 Top Tree - Laijinyi</li> <li>noip\u9000\u5f79\u9009\u624b\u7684another\u626f\u6de1Top tree \u76f8\u5173\u4e1c\u897f\u7684\u7406\u8bba\u3001\u7528\u6cd5\u548c\u5b9e\u73b0 - \u8bba\u6587\u54e5</li> </ol> <p>\u7406\u8bba\u4e0a\u7684\u5185\u5bb9\u4ee5\u4e0a\u535a\u5ba2\u8bb2\u7684\u5df2\u7ecf\u975e\u5e38\u597d\u4e86\uff0c\u672c\u6587\u53ea\u505a\u7b80\u8981\u5e26\u8fc7\u3002</p> <p>\u672c\u6587\u4e3b\u8981\u7684\u5185\u5bb9\u5c06\u4f1a\u662f\uff0cTop Tree \u5177\u4f53\u600e\u4e48\u5b9e\u73b0\uff0c\u4ee5\u53ca\u5982\u4f55\u7528\u5b83\u89e3\u51b3\u5404\u79cd\u9898\u76ee\u3002</p> <p>\u611f\u8c22 llzer \u7ed9\u4e86\u6211\u4e00\u4efd\u5199\u7684\u975e\u5e38\u597d\u7684\u9759\u6001 Top Tree \u5b9e\u73b0\u53c2\u8003\uff01</p>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#top-tree", "title": "Top Tree \u57fa\u672c\u7406\u8bba", "text": "<p>\u57fa\u672c\u662f\u590d\u8bfb\u3002</p> <p>\u8fb9\u5206\u6811\u8981\u5f15\u5165\u5927\u91cf\u7684\u5197\u4f59\u4fe1\u606f\uff0c\u800c\u4e14\u4f1a\u5bf9\u6811\u7684\u7ed3\u6784\u8fdb\u884c\u7834\u574f\uff0c\u7edf\u8ba1\u4fe1\u606f\u7684\u65f6\u5019\u8fd8\u8981\u6ce8\u610f\u65b0\u52a0\u7684\u8fb9\u4e0e\u539f\u6765\u7684\u8fb9\u7684\u533a\u522b\u3002\u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u6bd4\u5b83\u66f4\u597d\u7684\u4e8c\u53c9\u5206\u6cbb\u7ed3\u6784\uff0c\u53ef\u4ee5\u4e0d\u7ef4\u62a4\u90a3\u4e48\u591a\u5197\u4f59\u7684\u4fe1\u606f\u3002</p> <p>\u5f15\u5165\u7c07(cluster)\u7684\u6982\u5ff5\uff1a\u4e00\u4e2a\u7c07\u662f\u6811\u4e0a\u7684\u4e00\u4e2a\u8fde\u901a\u5b50\u56fe\uff0c\u6ee1\u8db3\u7c07\u5185\u7684\u70b9\u81f3\u591a\u6709\u4e24\u4e2a\u4e0e\u7c07\u5916\u7684\u70b9\u6709\u8fb9\u76f8\u8fde\u3002\u8fd9\u4e24\u4e2a\u70b9\u79f0\u4e3a\u754c\u70b9\u3002\u7c07\u8def\u5f84\u6307\u7684\u662f\u6811\u4e0a\u8fd9\u4e24\u4e2a\u754c\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\u3002</p> <p>\u663e\u7136\uff0c\u521d\u59cb\u6bcf\u6761\u6811\u4e0a\u7684\u8fb9\u90fd\u662f\u4e00\u4e2a\u7c07\u3002\u8fd9\u88ab\u79f0\u4e3a\u57fa\u7c07(base cluster)\u3002</p> <p>\u6709\u4e24\u79cd\u5bf9\u6811\u8fdb\u884c\u7684\u64cd\u4f5c\uff0cRake \u548c Compress\uff1a</p> <p></p> <p>Rake \u53ef\u4ee5\u770b\u4f5c\u5220\u4e00\u5ea6\u70b9\uff0c\u7136\u540e\u628a\u5b83\u7684\u7c07\u5e76\u5230\u53e6\u4e00\u4e2a\u7c07\u4e0a\uff0cCompress \u5219\u662f\u7f29\u4e8c\u5ea6\u70b9\uff0c\u7136\u540e\u5408\u5e76\u8fd9\u4e24\u4e2a\u7c07\u3002</p> <p>\u8fd9\u4e24\u79cd\u64cd\u4f5c\u663e\u7136\u90fd\u4f1a\u8ba9\u6811\u7684\u70b9\u6570\u51cf\u5c0f \\(1\\)\uff0c\u5e76\u4e14\u65b0\u6811\u7684\u6bcf\u6761\u8fb9\u90fd\u662f\u539f\u6765\u7684\u4e00\u4e2a\u7c07\u3002\u6700\u7ec8\uff0c\u6811\u53ea\u4f1a\u5269\u4e0b\u4e00\u6761\u8fb9\uff0c\u8fd9\u6761\u8fb9\u4ee3\u8868\u7684\u7c07\u88ab\u79f0\u4e3a\u6839\u7c07(root cluster)\u3002</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u7c07\u7684\u5408\u5e76\u7ed3\u6784\u5f62\u6210\u4e86\u4e00\u68f5\u6811\uff0c\u6b64\u5373 Top Tree\u3002</p> <p></p> <p>\u901a\u5e38\u4e3a\u4e86\u7ef4\u62a4\u52a8\u6001\u4fe1\u606f\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u7c07\u8def\u5f84\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u7c07\u5185\u8fb9\u96c6\u7684\u4fe1\u606f\uff0c\u5982\u679c\u5e0c\u671b\u7ef4\u62a4\u70b9\u96c6\u4fe1\u606f\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u6211\u4eec\u4e0d\u7ef4\u62a4\u754c\u70b9\u7684\u8d21\u732e\uff0c\u53ea\u6709\u754c\u70b9\u88ab\u7f29\u6389\u4e4b\u540e\u624d\u8ba1\u7b97\u5176\u8d21\u732e\u3002</p>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#top-tree_1", "title": "\u9759\u6001 Top Tree", "text": "<p>\u8fd9\u91cc\u7528\u7684\u505a\u6cd5\u662f\u57fa\u4e8e\u91cd\u94fe\u5256\u5206\u7684\u90a3\u79cd\u3002</p> <p>\u8003\u8651\u5bf9\u6bcf\u6761\u91cd\u94fe\uff0c\u6211\u4eec\u5148\u628a\u8f7b\u5b50\u6811\u5168\u90e8\u9012\u5f52\u5904\u7406\u6389\uff0c\u73b0\u5728\u7684\u91cd\u94fe\u5e94\u5f53\u5f62\u5982\u4e00\u6761\u94fe\uff0c\u7136\u540e\u6bcf\u4e2a\u70b9\u518d\u6302\u4e0a\u82e5\u5e72\u4e2a\u8f7b\u513f\u5b50\u3002</p> <p></p> <p>\u5bf9\u6bcf\u4e2a\u70b9\uff0c\u628a\u5b83\u8f7b\u513f\u5b50\u7684\u7c07\u6392\u6210\u4e00\u5217\uff0c\u6bcf\u4e2a\u70b9\u7684\u6743\u503c\u662f\u5b83\u7684\u8fb9\u6570\uff0c\u5bf9\u8fd9\u4e2a\u5e8f\u5217\u5e26\u6743\u5206\u6cbb\uff0c\u5373\u6bcf\u6b21\u5206\u6cbb\u5206\u4e3a\u4e24\u534a\uff0c\u4ed6\u4eec\u7684\u6743\u503c\u548c\u5c3d\u53ef\u80fd\u63a5\u8fd1\uff0c\u7136\u540e\u628a\u4e24\u4fa7\u5f97\u5230\u7684\u4e24\u4e2a\u7c07\u518d Rake \u6210\u4e00\u4e2a\u7c07\u3002</p> <p>\u73b0\u5728\u53ea\u5269\u4e0b\u4e00\u4e2a\u7c07\u4e86\uff0c\u518d\u628a\u5b83 Rake \u5230\u91cd\u94fe\u4e0a\u3002</p> <p></p> <p>\u73b0\u5728\u6574\u4e2a\u91cd\u94fe\u53ea\u5269\u4e0b\u4e00\u6761\u94fe\u4e86\uff0c\u540c\u6837\u6309\u8fb9\u7684\u5927\u5c0f\u5e26\u6743\u5206\u6cbb Compress \u5373\u53ef\u3002</p> <p>\u8fd9\u6837\u5efa\u51fa\u6765\u7684\u6811\u6709\u5982\u4e0b\u6027\u8d28\uff1a</p> <ul> <li>\u6240\u6709\u7c07\u7684\u754c\u70b9\u90fd\u6709\u7956\u5148\u5173\u7cfb\u3002\u4e0b\u6587\u4e2d\u8bb0 \\(\\operatorname U(x)\\) \u4e3a\u7c07 \\(x\\) \u7684\u4e0a\u754c\u70b9\uff0c\\(\\operatorname{D}(x)\\) \u4e3a\u7c07 \\(x\\) \u7684\u4e0b\u754c\u70b9\u3002</li> <li>\u7c07\u7684\u4e0a\u754c\u70b9\u4e3a\u6574\u4e2a\u7c07\u4e2d\u6df1\u5ea6\u6700\u5c0f\u7684\u70b9\u3002</li> <li>Compress \u6811\u7684\u4e2d\u5e8f\u904d\u5386\u662f\u6309\u7167\u6df1\u5ea6\u5347\u5e8f\u904d\u5386\u3002</li> </ul> <p>\u53ef\u4ee5\u8bc1\u660e\uff0c\u6811\u9ad8\u7ecf\u8fc7\u4e24\u6b65\u4e4b\u540e\u5fc5\u5b9a\u7ffb\u500d\u3002\u6811\u9ad8\u81f3\u591a\u4e3a \\(2\\lfloor\\times \\log n\\rfloor\\)\u3002</p>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#_1", "title": "\u5efa\u6811\u7684\u5b9e\u73b0", "text": "<p>\u9996\u5148\u6211\u4eec\u6709 <code>Cluster</code> \u8fd9\u4e2a\u7c7b\uff0c\u8868\u793a\u4e00\u4e2a\u7c07\u7684\u4fe1\u606f\uff0c\u5176\u4e2d <code>u</code> \u662f\u4e0a\u754c\u70b9\uff0c<code>v</code> \u662f\u4e0b\u754c\u70b9\u3002\u540c\u65f6\u6709 <code>Rake</code> \u548c <code>Compress</code> \u4e24\u4e2a\u57fa\u672c\u7684\u64cd\u4f5c\u3002</p> <p>\u9996\u5148\u5b9a\u4e49 <code>node</code> \u7c7b</p> <pre><code>struct node {\n    std::array&lt;int, 2&gt; ch;\n    Cluster info;\n    int fa, dep, type;   // type 0/1/2 \u5206\u522b\u4e3a base/rake/compress\n    int&amp; operator [](const int &amp;x) {\n        return ch[x];\n    }\n};\ninline void pull(int u) {\n    if (tr[u].type == 0)    return ;\n    tr[u].info = (tr[u].type == 1 ? Rake : Compress)(tr[tr[u][0]].info, tr[tr[u][1]].info);\n}\n</code></pre> <p>\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a\u51fd\u6570\uff0c\u5bf9\u4e00\u4e2a <code>Cluster</code> \u5e8f\u5217\u5e26\u6743\u5206\u6cbb\uff0c\u627e\u5230\u5176\u4e2d\u70b9\uff0c\u5c06\u4e24\u8fb9\u5408\u5e76\u8d77\u6765\u540e\u518d\u5408\u5e76</p> <pre><code>inline int merge(int u, int v, int type) {\n    totN++;\n    tr[totN][0] = u, tr[totN][1] = v;\n    tr[u].fa = totN, tr[v].fa = totN;\n    tr[totN].type = type;\n    pull(totN);\n    return totN;\n}\n\nint Divide_And_Conquer(std::vector&lt;int&gt; &amp;vec, int l, int r, int type) {\n    if (l == r)\n        return vec[l];\n    int gsum = 0;\n    for (int i = l; i &lt;= r; i++)\n        gsum += tr[vec[i]].info.siz;\n\n    int cur = 0, mid = r - 1;\n\n    for (int i = l; i &lt;= r - 1; i++) {\n        cur += tr[vec[i]].info.siz;\n        if (cur * 2 &gt;= gsum) {\n            mid = i;\n            break;\n        }\n    }\n\n    int ls = Divide_And_Conquer(vec, l, mid, type);\n    int rs = Divide_And_Conquer(vec, mid + 1, r, type);\n    return merge(ls, rs, type);\n}\n</code></pre> <p>\u6700\u540e\u662f\u6574\u68f5\u6811\u7684\u5efa\u6811\u8fc7\u7a0b\uff1a</p> <pre><code>// \u5230 (u, fa[u]) \u7684\u57fa\u7c07\u7684 id\nint fa_id[N];\nint Ssiz[N], son[N], fa[N], dep[N];\nvoid dfs_pre(int u) {\n    dep[u] = dep[fa[u]] + 1;\n    Ssiz[u] = 1;\n    for (const int &amp;v : G[u]) {\n        if (v == fa[u])\n            continue;\n        fa[v] = u;\n\n        Cluster t = {u, v, 1};\n        tr[++totN] = {{0, 0}, t, 0, 0, 0};\n        fa_id[v] = totN;\n\n        dfs_pre(v);\n        Ssiz[u] += Ssiz[v];\n        if (Ssiz[v] &gt; Ssiz[son[u]])\n            son[u] = v;\n    }\n}\n\nint build(int tp) {\n    std::vector&lt;int&gt; seq;\n    if (fa_id[tp])\n        seq.push_back(fa_id[tp]);\n\n    for (int u = tp; son[u]; u = son[u]) {\n        std::vector&lt;int&gt; seq2;\n        // \u5148\u628a\u8f7b\u5b50\u6811\u5168\u90e8\u5408\u5e76\u8d77\u6765\n        for (const int &amp;v : G[u]) {\n            if (v == son[u] || v == fa[u])\n                continue;\n            seq2.push_back(build(v));\n        }\n\n        if (!seq2.empty()) {\n            int cur = fa_id[son[u]];\n            // \u5206\u6cbb Rake \u5176\u4ed6\u5b50\u6811\uff0c\u7136\u540e Rake \u5230\u91cd\u513f\u5b50\u4e0a\n            int out = Divide_And_Conquer(seq2, 0, (int)seq2.size() - 1, 1);\n            seq.push_back(merge(cur, out, 1));\n        } else {\n            seq.push_back(fa_id[son[u]]);\n        }\n    }\n    return Divide_And_Conquer(seq, 0, (int)seq.size() - 1, 2);\n}\n</code></pre>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#_2", "title": "\u5168\u5c40\u67e5\u8be2", "text": "<p>\u8bf7\u6ce8\u610f\uff0cTop Tree \u7684\u6bcf\u4e2a\u7c07\u4e0d\u7ef4\u62a4\u754c\u70b9\u7684\u8d21\u732e\u3002</p> <ol> <li> <p>\u3010\u6a21\u677f\u3011\"\u52a8\u6001DP\" &amp; \u52a8\u6001\u6811\u5206\u6cbb</p> <p>\u5355\u70b9\u4fee\u6539\uff0c\u6811\u4e0a\u6700\u5927\u6743\u72ec\u7acb\u96c6\u3002</p> <p>\u6211\u4eec\u77e5\u9053\u6bcf\u4e2a\u7c07\u53ea\u5728\u754c\u70b9\u5904\u4e0e\u5916\u754c\u76f8\u90bb\uff0c\u90a3\u4e48\u4ee4 \\(f_{0/1,0/1}\\) \u8868\u793a\u4e24\u4e2a\u754c\u70b9\u5206\u522b\u4e0d\u9009/\u9009\u7684\u7b54\u6848\u5373\u53ef\u3002</p> <p>\u8bbe \\(c\\) \u8868\u793a\u7b54\u6848\u7684\u7c07\uff0c\u5c06 \\(b\\) \\(\\text{Rake}\\) \u5230 \\(a\\) \u4e0a\u5219\uff1a</p> \\[ c_{i,j}=\\max(a_{i,j}+b_{i,0},a_{i,j}+b_{i,1}+w(\\operatorname{D}(b))) \\] <p>\u5c06 \\(a,b\\) \\(\\text{Compress}\\) \u8d77\u6765\u5219\uff1a</p> \\[ c_{i,j}=\\max(a_{i,1}+b_{1,j}+w(\\operatorname{D}(a)),a_{i,0}+b_{0,j}) \\] <p>\u4ee3\u7801\u89c1\u8fd9\u91cc\uff0c\u9700\u8981\u5361\u4e00\u5361\u5e38\u3002</p> </li> </ol>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#_3", "title": "\u6811\u94fe / \u5b50\u6811\u4fee\u6539\u4e0e\u67e5\u8be2", "text": "<p>\u8fd9\u91cc\u4e3b\u8981\u8bb2\u7ef4\u62a4\u70b9\u96c6\u4fe1\u606f\u7684\u529e\u6cd5\uff0c\u8fb9\u96c6\u4fe1\u606f\u7684\u7ef4\u62a4\u65b9\u6cd5\u662f\u51e0\u4e4e\u4e00\u6837\u7684\u3002</p>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#_4", "title": "\u6811\u94fe", "text": "<p>\u5bf9\u4e8e\u4e00\u4e2a\u7c07 \\(x\\)\uff0c\u4ed6\u7ef4\u62a4\u7684\u4fe1\u606f\u662f\u7c07\u8def\u5f84\u9664\u4e86 \\(\\operatorname{U}(x)\\) \u7684\u6240\u6709\u70b9\u4fe1\u606f\u4e4b\u548c\uff0c\u6709\u70b9\u7c7b\u4f3c\u5de6\u95ed\u53f3\u5f00\u3002</p> <p>\u8bbe\u7c07 \\(x\\) \u7ef4\u62a4\u7684\u4fe1\u606f\u4e3a \\(\\operatorname{F}(x)\\)\uff0c\u90a3\u4e48\u6709\uff1a</p> \\[ \\begin{aligned} \\operatorname{F}(\\operatorname{Rake}(a,b))=\\operatorname{F}(a)\\\\ \\operatorname{F}(\\operatorname{Compress}(a,b)) = \\operatorname{F}(a)+\\operatorname{F}(b); \\end{aligned} \\] <p>\u65e0\u8bba\u662f\u8be2\u95ee\u8fd8\u662f\u4fee\u6539\u4e00\u6761\u8def\u5f84 \\((u, v)\\) \uff0c\u6211\u4eec\u90fd\u9700\u8981\u627e\u5230\u4e00\u4e2a\u7c07\u7684\u96c6\u5408\uff0c\u4f7f\u5f97\u4ed6\u4eec\u7684\u4fe1\u606f\u7684\u5e76\u6070\u597d\u662f\u8fd9\u6761\u8def\u5f84\u3002</p> <p>\u8bbe \\(\\operatorname{rson}(x)\\) \u662f \\(x\\) \u5728 Top Tree \u4e0a\u7684\u53f3\u513f\u5b50\u3002</p> <p>\u8003\u8651\u5148\u627e\u5230 \\((u,\\operatorname{fa}(u)),(v,\\operatorname{fa}(v))\\) \u5bf9\u5e94\u7684\u57fa\u7c07\u5728 Top Tree \u4e0a\u7684 LCA\uff0c\u4e0d\u59a8\u8bbe\u4e3a \\(x\\)\uff0c\u90a3\u4e48 \\(\\operatorname{U}(\\operatorname{rson}(x))\\) \u4e00\u5b9a\u5728\u8def\u5f84 \\((u,v)\\) \u4e4b\u95f4\u3002</p> <ol> <li>\u5982\u679c \\(x\\) \u662f\u4e00\u4e2a \\(\\operatorname{Rake}\\) \u8282\u70b9\uff0c\u8bf4\u660e \\(u,v\\) \u5728 LCA \u7684\u4e24\u4fa7\uff0c\u8fd9\u4e2a\u65f6\u5019 \\(\\operatorname{U(\\operatorname{rson}(x))}\\) \u4e00\u5b9a\u5c31\u662f \\(u,v\\) \u7684 LCA\u3002</li> <li>\u5982\u679c \\(x\\) \u662f\u4e00\u4e2a \\(\\operatorname{Compress}\\) \u8282\u70b9\uff0c\u8bf4\u660e \\((u,v)\\) \u5c31\u662f\u4e00\u6761\u4ece\u4e0a\u5230\u4e0b\u7684\u94fe\uff0c\u8fd9\u4e2a\u65f6\u5019 \\(\\operatorname{U(\\operatorname{rson}(x))}\\) \u5c31\u662f \\((u,v)\\) \u4e4b\u95f4\u7684\u67d0\u4e2a\u8282\u70b9\u3002</li> </ol> <p>\u8bbe \\(m=\\operatorname{U}(\\operatorname{rson}(x))\\)\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u5904\u7406\u4e24\u6761\u76f4\u94fe\u7684\u4fe1\u606f\uff0c\\((\\operatorname{fa}(m),u)\\) \u548c \\((m,v)\\)\u3002\u8fd9\u4e24\u6761\u8def\u5f84\u7684\u4fe1\u606f\u540c\u6837\u662f\u8def\u5f84\u4e2d\u9664\u53bb\u6700\u9ad8\u70b9\u7684\u6240\u6709\u70b9\u4e4b\u548c\u7684\u5de6\u95ed\u53f3\u5f00\u72b6\u7269\u3002\u8fd9\u91cc\u7684 \\(\\operatorname{fa}\\) \u662f\u539f\u6811\u4e0a\u7684\u7236\u4eb2\uff0c</p> <p>\u5bf9\u6bcf\u4e2a\u8be2\u95ee \\((l,r)\\)\uff0c\u5c31\u662f\u627e\u5230\u4e00\u4e2a\u7c07\u7684\u96c6\u5408\uff0c\u4f7f\u5f97\u7c07\u8def\u5f84\u4e4b\u5e76\u6070\u597d\u4e3a \\((l,r)\\)\u3002</p> <p>\u8003\u8651\u5b9e\u73b0\u4e00\u4e2a\u51fd\u6570 \\(\\operatorname{solve}(x,l,r)\\) \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5176\u4e2d \\(x\\) \u662f\u4e00\u4e2a\u5b8c\u5168\u5305\u542b \\((l,r)\\) \u7684\u7c07\u3002</p> <ul> <li>\u5982\u679c \\((\\operatorname{D}(x),\\operatorname{U}(x))\\) \u5b8c\u5168\u5305\u542b\u4e8e \\((l,r)\\)\uff0c\u8fd4\u56de \\(\\operatorname{F}(x)\\)\u3002</li> <li>\u5426\u5219\uff0c\u8bbe \\(m=\\operatorname{U}(\\operatorname{rson}(x))\\)<ul> <li>\u82e5 \\(x\\) \u4e3a \\(\\operatorname{Compress}\\) \u8282\u70b9<ul> <li>\u5982\u679c \\(m\\) \u5728 \\((l,r)\\) \u4e4b\u95f4\uff0c\u90a3\u4e48\u8fd4\u56de \\(\\operatorname{solve}(\\operatorname{lson}(x),l,m)+\\operatorname{solve}(\\operatorname{lson}(x),m,r)\\)\u3002</li> <li>\u5426\u5219\uff0c\u6bd4\u8f83 \\(l\\) \u4e0e \\(m\\) \u7684\u6df1\u6d45\u5173\u7cfb\u3002\u5982\u679c \\(l\\) \u6d45\u4e8e \\(m\\)\uff0c\u90a3\u4e48\u5e94\u5f53\u8fd4\u56de \\(\\operatorname{solve}(\\operatorname{lson}(x),l,r)\\)\uff0c\u5426\u5219\u662f \\(\\operatorname{solve}(\\operatorname{lson}(x),l,r)\\)\u3002</li> </ul> </li> <li>\u82e5 \\(x\\) \u4e3a \\(\\operatorname{Rake}\\) \u8282\u70b9<ul> <li>\u90a3\u4e48 \\(\\operatorname{lson}(x)\\) \u548c \\(\\operatorname{rson}(x)\\) \u5fc5\u5b9a\u6709\u4e00\u4e2a\u5b8c\u5168\u5305\u542b \\((l,r)\\)\uff0c\u53ea\u8981\u8003\u8651 \\(r\\) \u7684\u57fa\u7c07\u4f4d\u4e8e Top Tree \u4e0a\u54ea\u4e00\u4e2a\u513f\u5b50\u7684\u5b50\u6811\uff0c\u9012\u5f52\u90a3\u4e00\u4e2a\u513f\u5b50\u5373\u53ef\u3002</li> </ul> </li> </ul> </li> </ul>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#_5", "title": "\u5b50\u6811", "text": "<p>\u5b50\u6811\u7684\u67e5\u8be2\u5c31\u7b80\u5355\u591a\u4e86\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u8981\u67e5\u8be2 \\(u\\) \u5b50\u6811\u91cc\u6240\u6709\u70b9\u7684\u4fe1\u606f\u4e4b\u548c\uff0c\u4e3a\u4e86\u7b80\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u5148\u52a0\u4e0a \\(u\\) \u8fd9\u4e2a\u5355\u70b9\u7684\u4fe1\u606f\uff08\\(u\\) \u5bf9\u5e94\u7684\u57fa\u7c07\uff09\uff0c\u518d\u52a0\u4e0a\u6240\u6709 \\(u\\) \u5b50\u6811\u91cc\u9664\u4e86 \\(u\\) \u7684\u4fe1\u606f\u4e4b\u548c\u3002</p> <p>\u4ecd\u7136\u8003\u8651\u5b9e\u73b0\u4e00\u4e2a\u51fd\u6570 \\(\\operatorname{solve}(x,u)\\) \u8868\u793a\u5f53\u524d\u7c07\u4e3a \\(x\\)\uff0c\u8981\u6c42\u51fa \\(u\\) \u5b50\u6811\u91cc\u7684\u6240\u6709\u8282\u70b9\u4fe1\u606f\u4e4b\u548c\uff0c\u6ce8\u610f\u8fd9\u91cc\u7c07 \\(x\\) \u672a\u5fc5\u5305\u542b \\(u\\) \u5b50\u6811\u4e2d\u7684\u6240\u6709\u70b9\u3002</p> <ul> <li>\u5982\u679c\u8fd9\u4e2a\u7c07\u4e3a\u57fa\u7c07\u6216\u8005 \\(\\operatorname{U}(x)=u\\)\uff0c\u8fd4\u56de \\(\\operatorname{F}(x)\\)\u3002</li> <li>\u5982\u679c\u5f53\u524d\u8282\u70b9\u4e3a \\(\\operatorname{Compress}\\) \u8282\u70b9\uff0c\u4ecd\u7136\u8bbe \\(m=\\operatorname{U}(\\operatorname{rson}(x))\\)\u3002<ul> <li>\u5047\u8bbe \\(m\\) \u6df1\u4e8e \\(u\\)\uff08\u6df1\u5ea6\u5927\u4e8e\u7b49\u4e8e\uff09\uff0c\u8fd4\u56de \\(\\operatorname{solve}(\\operatorname{lson}(x),u)+\\operatorname{F}(\\operatorname{rson}(x))\\)\u3002</li> <li>\u5426\u5219\uff0c\u8fd4\u56de \\(\\operatorname{solve}(\\operatorname{rson}(x),u)\\)\u3002</li> </ul> </li> <li>\u5982\u679c\u5f53\u524d\u8282\u70b9\u4e3a \\(\\operatorname{Rake}\\) \u8282\u70b9\uff0c\u57fa\u7c07 \\((u,\\operatorname{fa}(u))\\) \u5fc5\u7136\u5728 Top Tree \u4e0a \\(x\\) \u7684\u4e24\u4e2a\u513f\u5b50\u4e4b\u4e00\uff0c\u9012\u5f52\u90a3\u4e00\u4fa7\u5373\u53ef\u3002</li> </ul>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#_6", "title": "\u90bb\u57df\u67e5\u8be2", "text": "<p>\u4ee4 \\(N_d(u)\\) \u8868\u793a \\(u\\) \u7684 \\(d\\) \u90bb\u57df\u3002</p> <p>\u5bf9\u6bcf\u4e2a\u7c07 \\(x\\)\uff0c\u5bf9\u4e8e\u4e0a\u754c\u70b9 \\(\\operatorname{U}(x)\\)\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a \\(d\\) \u7ef4\u62a4\u7c07\u5185\u79bb \\(\\operatorname{U}(x)\\) \u8ddd\u79bb \\(\\le d\\) \u7684\u70b9\u7684\u4fe1\u606f\u4e4b\u548c\uff0c\u8fd9\u91cc\u4e0d\u542b\u4e0a\u754c\u70b9 \\(\\operatorname{U}(x)\\)\u3002\u5bf9\u4e8e\u4e0b\u754c\u70b9 \\(\\operatorname{D}(x)\\) \u7ef4\u62a4\u4e00\u6837\u7684\u4e1c\u897f\uff0c\u4f46\u8fd9\u91cc\u662f\u5305\u542b \\(\\operatorname{D}(x)\\) \u7684\u3002</p> <p>\u6211\u4eec\u8981\u8ba1\u7b97 \\(N_d(u)\\) \u91cc\u7684\u4fe1\u606f\u4e4b\u548c\u3002\u90a3\u4e48\u521d\u59cb\u4ee4\u7c07 \\(x\\) \u4e3a\u8fb9 \\((u,\\operatorname{fa}(u))\\) \u7684\u57fa\u7c07\uff0c\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u8ba1\u7b97\u51fa\u4e86\u6240\u6709\u7c07 \\(x\\) \u4e2d\u70b9\u4e0e \\(N_d(u)\\) \u7684\u4ea4\u7684\u4fe1\u606f\u4e4b\u548c\uff0c\u73b0\u5728\u8981\u4ee4 \\(x\\) \u53d8\u4e3a \\(x\\) \u5728 Top Tree \u4e0a\u7684\u7236\u4eb2 \\(y\\)\u3002</p> <p>\u90a3\u4e48\u8bbe \\(z\\) \u4e3a \\(y\\) \u7684 \\(x\\) \u4e4b\u5916\u7684\u53e6\u4e00\u4e2a\u513f\u5b50\uff0c\u800c \\(x,z\\) \u552f\u4e00\u7684\u4ea4\u70b9\u4e3a \\(p\\)\uff0c\u6211\u4eec\u5408\u5e76\u4e0a \\(z\\) \u4e2d\uff0c\u79bb \\(p\\) \u8ddd\u79bb \\(\\le d-\\operatorname{dis}(u,p)\\) \u7684\u70b9\u7684\u4fe1\u606f\u4e4b\u548c\u5373\u53ef\uff0c\u8fd9\u53ef\u4ee5\u6839\u636e\u6211\u4eec\u9884\u5904\u7406\u7684\u4fe1\u606f\u7ef4\u62a4\u51fa\u6765\u3002</p> <p>\u5177\u4f53\u7684\uff1a</p> <pre><code>// tr[x].c \u662f Top Tree \u8282\u70b9 x \u4ee3\u8868\u7684\u7c07, u \u4e3a\u4e0a\u754c\u70b9, v \u4e3a\u4e0b\u754c\u70b9\n// rt \u4e3a Top Tree \u7684\u6839\ninline int query(int u, int d) {\n    int x = fa_id[u];\n    int ans = a[u];\n    while (x != rt) {\n        int y = tr[x].fa;\n        int s = (tr[y][1] == x);\n        int z = tr[y][s ^ 1];\n        if (tr[y].type == 1) {\n            ans += tr[z].c.Su.query(d - dis(u, tr[z].c.u));\n        } else {\n            if (s == 0)\n                ans += tr[z].c.Su.query(d - dis(u, tr[z].c.u));\n            else\n                ans += tr[z].c.Sv.query(d - dis(u, tr[z].c.v));\n        }\n        x = y;\n    }\n    return ans;\n}\n</code></pre> <p>Top Tree \u90bb\u57df\u67e5\u8be2\u7684\u53c2\u8003\u5b9e\u73b0(P6329)\u3002</p>"}, {"location": "Algorithms/DataStructures/DS_of_Trees/Trees-3/#satt", "title": "SATT", "text": "<p>~~\u8fd9\u6211\u54ea\u4f1a\uff0cNOIP \u6ca1\u9000\u5f79\u518d\u8bf4\u5427\u3002~~\u611f\u89c9\u6ca1\u7528\uff0c\u4e0d\u5b66\u4e86\u3002</p>"}, {"location": "Algorithms/DataStructures/SegmentTree/KTT/", "title": "KTT", "text": "<p>\u6709 \\(n\\) \u4e2a\u51fd\u6570 \\(f_i:\\mathbb R\\rightarrow \\mathbb R\\)\uff0c\u5bf9\u4e8e \\(x_1&lt;x_2&lt;\\cdots &lt;x_m\\) \u7684\u6bcf\u4e2a \\(x_k\\) \u6c42</p> \\[ \\max_{j=1}^{n}\\{f_j(x_k)\\} \\] <p>\u8be2\u95ee\u7684 \\(x\\) \u5355\u8c03\u9012\u589e\u3002</p> <p>\u8003\u8651\u8fd9\u6837\u4e00\u79cd\u7ebf\u6bb5\u6811\uff1a\u6bcf\u4e2a\u53f6\u5b50\u8868\u793a\u4e86\u4e00\u4e2a\u51fd\u6570\uff0c\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u4e24\u4e2a\u4fe1\u606f</p> <ol> <li>\u5728\u5f53\u524d \\(x\\) \u4e0b\u53d6\u5230\u6700\u5927\u503c\u7684\u51fd\u6570\u662f\u54ea\u4e2a</li> <li>\u5b50\u6811\u5185\u6bcf\u4e2a\u8282\u70b9\u53d6\u5230\u6700\u5927\u503c\u7684\u51fd\u6570\u7b2c\u4e00\u6b21\u53d1\u751f\u6539\u53d8\u7684\u65f6\u5019\u7684 \\(x\\) \u7684\u503c\u3002</li> </ol> <p>\u5f53\u4e0b\u4e00\u4e2a\u8be2\u95ee\u8d85\u8fc7\u8fd9\u4e2a \\(x\\) \u7684\u65f6\u5019\uff0c\u91cd\u6784\u6574\u4e2a\u5b50\u6811\u3002</p> <p>\u8fd9\u4e2a\u505a\u6cd5\u7684\u597d\u5904\u662f\u53ef\u4ee5\u4fee\u6539\u67d0\u4e00\u4e2a\u51fd\u6570\u3002</p> <p>\u590d\u6742\u5ea6\u8bc1\u660e\uff1a\u8fd9\u6211\u54ea\u4f1a\u554a\uff0c\\(\\mathcal O((n+q)\\log^3 n)\\) \u8bf4\u662f\u3002</p>"}, {"location": "Algorithms/DataStructures/SegmentTree/KTT/#cf1830f-the-third-grace", "title": "CF1830F. The Third Grace", "text": "<p>\u52a8\u7406\u5e8f\u5217\u6700\u503c \u00b7 \u5f31\u5316\u7248</p> <p>\u8bbe \\(f_i\\) \u8868\u793a\u9009\u53d6\u7b2c \\(i\\) \u4e2a\u70b9\uff0c\u4f46\u4e0d\u8ba1\u7b97\u8fd9\u4e2a\u70b9\u8d21\u732e\u7684\u6700\u5927\u503c\u3002\u8f6c\u79fb\u5c31\u662f</p> \\[ f_i=\\max_{j=1}^{i-1}\\{f_j+c_{j,i}p_j\\} \\] <p>\u5176\u4e2d \\(c_{j,i}\\) \u662f\u6ee1\u8db3 \\(i\\notin[l,r],j\\in [l,r]\\) \u7684\u533a\u95f4 \\([l,r]\\) \u4e2a\u6570\u3002</p> <p>\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u5e8f\u5217 \\(\\{a_i\\}\\)\uff0c\u5176\u4e2d \\(a_i=p_ix_i+f_i\\)\u3002</p> <p>\u6bcf\u6b21\u5728\u8f6c\u79fb\u5b8c \\(f_i\\) \u540e\uff0c\u5bf9\u6240\u6709 \\(r_j=i\\) \u7684\u533a\u95f4 \\([l_j,r_j]\\)\uff0c\u4ee4\u533a\u95f4\u5185\u7684 \\(x_k\\leftarrow x_k+1\\)\u3002</p>"}, {"location": "Algorithms/Misc/Greedy/", "title": "Greedy", "text": "<p>\u672c\u6587\u662f\u4e00\u4e2a\u53d7\u5230 dp \u9898\u65b9\u6cd5\u603b\u6c47 - YeahPotato \u5f71\u54cd\u4ea7\u751f\u7684\u4e00\u4e2a Trick \u6536\u5f55\u578b\u7684\u6587\u7ae0\u3002\u5982\u679c\u6709\u9057\u6f0f\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u8054\u7cfb\u4f5c\u8005\u3002</p>"}, {"location": "Algorithms/Misc/Greedy/#exchange-arguments", "title": "\u90bb\u9879\u4ea4\u6362\u8d2a\u5fc3 / Exchange Arguments", "text": ""}, {"location": "Algorithms/Misc/ShortestPathModelling/", "title": "ShortestPathModelling", "text": ""}, {"location": "Algorithms/Misc/ShortestPathModelling/#_1", "title": "\u5b9a\u4e49", "text": "<p>\u5047\u8bbe\u6211\u4eec\u5728\u975e\u8d1f\u6574\u6570\u96c6\u4e0b\u8ba8\u8bba\u95ee\u9898\u3002</p> <p>\u4ece\u4e00\u4e2a\u81ea\u7136\u7684\u95ee\u9898\u51fa\u53d1\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u6b63\u6574\u6570\u96c6\u5408 \\(S=\\{s_1,s_2,\\cdots, s_n\\}\\)\uff0c\u518d\u7ed9\u4f60\u4e00\u4e2a\u6570 \\(t\\)\uff0c\u5982\u4f55\u5224\u5b9a \\(t\\) \u80fd\u5426\u88ab \\(S\\) \u4e2d\u7684\u6570\u7ebf\u6027\u8868\u51fa\uff1f\u4e5f\u5c31\u662f\uff0c\u662f\u5426\u5b58\u5728\u4e00\u7ec4\u6574\u6570 \\(k_1,k_2,\\cdots, k_n\\)\uff0c\u4f7f\u5f97</p> \\[ t=\\sum_{i=1}^{n}k_is_i \\] <p>\u663e\u7136\uff0c\u8fd9\u4e2a\u95ee\u9898\u662f\u80cc\u5305\u3002</p> <p>\u4f46\u5982\u679c \\(S\\) \u7684\u6570\u90fd\u4e0d\u592a\u5927\uff0c\u4f46 \\(t\\) \u662f\u4e00\u4e2a\u5f88\u5927\u7684\u6570\u5462\uff1f</p> <p>\u8003\u8651\u4ee5 \\(S\\) \u4e2d\u7684\u67d0\u4e00\u4e2a\u6570\u4e3a\u57fa\u51c6\uff0c\u4e0d\u59a8\u8bb0\u5b83\u4e3a \\(b\\)\uff0c\u90a3\u4e48\u6240\u6709\u6574\u6570\u80af\u5b9a\u90fd\u80fd\u88ab\u8868\u793a\u4e3a</p> \\[ bk+r \\] <p>\u7684\u5f62\u5f0f\u3002</p> <p>\u5047\u8bbe \\(r_1,r_2\\) \u90fd\u53ef\u4ee5\u88ab\u5176\u4ed6\u6574\u6570\u8868\u793a\u51fa\u6765\uff0c\\(r_1&lt;r_2\\) \u4e14 \\(r_1\\equiv r_2\\pmod{b}\\)\uff0c\u90a3\u4e48\u80af\u5b9a\u6709 \\(r_2=r_1+bz\\)\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u6a21 \\(b\\) \u7684\u540c\u4f59\u7c7b \\(\\overline r_b\\)\uff0c\u53ea\u7528\u5173\u5fc3\u6700\u5c0f\u7684\u90a3\u4e2a\u80fd\u88ab\u8868\u793a\u51fa\u7684 \\(r\\)\u3002</p> <p>\u663e\u7136\uff0c\u8fd9\u662f\u4e00\u4e2a\u6a21\u610f\u4e49\u4e0b\u5b8c\u5168\u80cc\u5305\u3002</p> <p>\u8bbe \\(f_x\\) \u8868\u793a\u6a21 \\(b\\) \u610f\u4e49\u4e0b\u7b49\u4e8e \\(x\\)\uff0c\u80fd\u591f\u88ab\u8868\u793a\u51fa\u6765\u7684\u6700\u5c0f\u7684\u6570\u3002</p> <p>\u6709\u4e00\u4e9b\u65b9\u6cd5\u8ba1\u7b97\u8fd9\u4e2a\u4e1c\u897f\u7684\u65f6\u5019\u7528\u5230\u7684\u662f\u6700\u77ed\u8def\u4e4b\u7c7b\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u4e0d\u8fd9\u6837\u5e72\uff0c\u8003\u8651\u8f6c\u5708\u3002</p> <p>\u6211\u4eec\u77e5\u9053\uff0c\u4ece\u5bf9\u4e8e\u4e00\u4e2a \\(0\\sim a\\) \u7684\u5e8f\u5217\uff0c\u4ee4\u6bcf\u4e2a\u70b9 \\(i\\) \u5411 \\(i+m\\bmod a\\) \u8fde\u8fb9\uff08\u5b9e\u9645\u4e0a\u523b\u753b\u7684\u662f\u6bcf\u6b21\u5f80\u540e\u8df3 \\(m\\) \u6b65\uff09\uff0c\u6574\u4e2a\u56fe\u5f62\u6210 \\(\\gcd(a,m)\\) \u4e2a\u73af\uff0c\u6bcf\u4e2a\u73af\u7684\u957f\u5ea6\u662f \\(\\frac{a}{\\gcd(a,m)}\\)\uff0c\u8fd9\u662f\u7ecf\u5178\u7684\uff0c\u5177\u4f53\u89c1 P6187 \u7684\u9898\u89e3\u3002</p> <p>\u8fd9\u91cc\u8bf4\u5230\u4e86\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\uff0c\u5b9e\u9645\u4e0a\u5bf9\u4e8e\u6bcf\u4e2a \\(i\\)\uff0c\u80fd\u8f6c\u79fb\u5230\u5b83 / \u88ab\u5b83\u8f6c\u79fb\u5230\u7684\u70b9\u6070\u597d\u6784\u6210\u4e86\u4e00\u4e2a\u73af\u3002</p> <p>\u4f46\u662f\u80af\u5b9a\u4e0d\u4f1a\u5728\u8fd9\u4e2a\u73af\u4e0a\u65e0\u7a77\u5730\u8f6c\u4e0b\u53bb\uff0c\u8fd9\u6837\u7684\u60c5\u51b5\u5fc5\u7136\u662f\u4ee3\u4ef7\u4e3a\u8d1f\uff08\u8d1f\u73af\uff09\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u8f6c\u6070\u597d\u4e24\u5708\u5c31\u884c\u4e86\u3002</p> <p>\u8f6c\u79fb\u6210\u73af\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u6bcf\u4e2a \\(x\\) \u66f4\u65b0\u4e86\u540e\u9762\u7684\u4e00\u7ec4\u503c\uff0c\u8fd9\u53ef\u80fd\u66f4\u65b0\u5230\u539f\u5148\u8f6c\u79fb\u5176\u4ed6\u70b9 \\(z\\) \u7528\u7684\u90a3\u4e2a\u70b9 \\(y\\)\uff0c\u66f4\u65b0\u8fd9\u4e2a\u70b9\u540e \\(z\\) \u8981\u88ab\u91cd\u65b0\u66f4\u65b0\uff08\u8f6c\u7b2c\u4e8c\u5708\uff09\u3002</p> <p>\u8003\u8651\u4e3a\u4ec0\u4e48\u53ea\u9700\u8981\u66f4\u65b0\u4e24\u6b21\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u8f6c\u79fb\u4e3a \\(f_x\\leftarrow \\min(f_x,f_y+w)\\)\uff0c\u8fd9\u76f8\u5f53\u4e8e\u7528\u4e09\u89d2\u5f62\u4e0d\u7b49\u5f0f \\(f_y\\le f_x+w\\) \u66f4\u65b0\u6bcf\u4e2a\u73af\u4e0a\u7684\u70b9\uff0c\u800c\u8fb9\u6743\u975e\u8d1f\u7684\u6700\u77ed\u8def\u4e0d\u4f1a\u7ecf\u8fc7\u4e00\u4e2a\u70b9\u4e24\u6b21\u3002</p>"}, {"location": "Algorithms/Misc/ShortestPathModelling/#p2371", "title": "\u6a21\u677f\u9898 / P2371. \u58a8\u58a8\u7684\u7b49\u5f0f", "text": "<p>\u7ed9\u4f60 \\(n\\) \u4e2a \\(a_i\\)\uff0c\u6c42 \\([l,r]\\) \u4e2d\u6709\u591a\u5c11\u4e2a\u6570 \\(b\\) \u53ef\u4ee5\u88ab\u8868\u793a\u6210</p> \\[ b=\\sum_{i=1}^{n}a_ix_i \\] <p>\u7684\u5f62\u5f0f\u3002\u5176\u4e2d \\(x_i\\ge 0\\)\u3002</p> <p>\\(n\\le 15,0\\le a_i\\le 5\\times 10^5,1\\le l,r\\le 10^{12}\\)</p> <p>Solution</p> <p>\u968f\u4fbf\u9009\u4e00\u4e2a \\(m\\)\uff0c\u8003\u8651\u7528\u540c\u4f59\u6700\u77ed\u8def\u6c42\u51fa\u6bcf\u4e2a \\(0\\le i&lt;m\\) \u6700\u5c0f\u7684 \\(f_i\\)\uff0c\u7136\u540e\u8ba1\u7b97 \\([l-f_i,r-f_i]\\) \u4e2d \\(\\ge 0\\) \u7684 \\(m\\) \u7684\u500d\u6570\u4e2a\u6570\u5373\u53ef\u3002</p> <p>\u4ee3\u7801\u89c1\u8fd9\u91cc\u3002</p>"}, {"location": "Algorithms/Misc/Trick/", "title": "Trick", "text": ""}, {"location": "Algorithms/Misc/Trick/#dp", "title": "\u6700\u4f18\u5316 DP", "text": ""}, {"location": "Algorithms/Misc/Trick/#_1", "title": "\u8ba1\u6570", "text": ""}, {"location": "Algorithms/Misc/Trick/#_2", "title": "\u9012\u63a8", "text": "<ul> <li>\u65b9\u7a0b\u5173\u4e8e\u67d0\u4e00\u7ef4\u5f88\u5927\uff1a\u8003\u8651\u80fd\u4e0d\u80fd\u62c9\u63d2</li> </ul>"}, {"location": "Algorithms/NumberTheory/Introduction-2/", "title": "Introduction-2", "text": "<p>\u8fd9\u4e00\u8282\u7684\u4e3b\u8981\u53c2\u8003\u8d44\u6599\u662f\uff1a</p> <p>OI-Note Chapter4.2 \u6570\u8bba\u51fd\u6570\u4e0e\u6c42\u548c - Command_block</p> <p>\u72c4\u5229\u514b\u96f7\u524d\u7f00\u548c - Aleph_Drawer</p>"}, {"location": "Algorithms/NumberTheory/Introduction-2/#_1", "title": "\u7b26\u53f7\u7ea6\u5b9a", "text": "<ul> <li>\\(\\mathbf{lpf}(n)\\)\uff0c\\(n\\) \u7684\u6700\u5c0f\u8d28\u56e0\u5b50</li> <li>\\(v_p(n)\\)\uff0c\\(n\\) \u7684\u552f\u4e00\u5206\u89e3\u4e2d\u7d20\u56e0\u5b50 \\(p\\) \u7684\u5e42\u6b21\u3002</li> </ul>"}, {"location": "Algorithms/NumberTheory/Number_Theory_1/", "title": "\u6574\u9664\u4e0e\u6574\u9664\u76f8\u5173", "text": "<p>\u6ca1\u6709\u79d1\u6280\u3002</p> <p>\u65f6\u95f4\u7ebf\uff1a</p> <ul> <li>2024 / 05 / 13. \u5f00\u59cb\u65bd\u5de5</li> </ul> <p>\u9ed8\u8ba4\u8bfb\u8005\u5df2\u7ecf\u4e86\u89e3\u5e26\u4f59\u9664\u6cd5\uff0c\u7d20\u6570\uff0c\u7b97\u6570\u57fa\u672c\u5b9a\u7406\uff0c\u5269\u4f59\u7cfb\u7b49\u57fa\u672c\u77e5\u8bc6\u3002</p> <p>\u6211\u4eec\u7ea6\u5b9a\u6240\u6709\u7684\u6570\u53ea\u8981\u6ca1\u6709\u7279\u6b8a\u8bf4\u660e\uff0c\u90a3\u4e48\u6307\u7684\u90fd\u662f\u6574\u6570\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_1/#_2", "title": "\u7b26\u53f7\u7ea6\u5b9a", "text": "<p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u6211\u4eec\u7ea6\u5b9a\u4f7f\u7528\u7684\u7b26\u53f7\uff1a</p> <ul> <li>\u7d20\u6570\u96c6\u5408\uff1a\\(\\mathbb P\\)\u3002</li> <li>\u51fd\u6570 \\(f\\) \u7684\u5b9a\u4e49\u57df\uff1a \\(\\operatorname{dom}(f)\\)\u3002</li> <li>\u51fd\u6570 \\(f\\) \u7684\u503c\u57df\uff1a\\(\\operatorname{ran}(f)\\)\u3002</li> <li>\u7b49\u5f0f/\u4e0d\u7b49\u5f0f\u7684\u5de6\u4fa7\uff1a\\(\\text{LHS}\\)\u3002</li> <li>\u7b49\u5f0f/\u4e0d\u7b49\u5f0f\u7684\u53f3\u4fa7\uff1a\\(\\text{RHS}\\)\u3002</li> </ul>"}, {"location": "Algorithms/NumberTheory/Number_Theory_1/#_3", "title": "\u8f97\u8f6c\u76f8\u9664\u6cd5\u4e0e\u4e0d\u5b9a\u65b9\u7a0b", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_1/#_4", "title": "\u56de\u5fc6\uff1a\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5", "text": "<p>\u7ed9\u51fa\u4e24\u4e2a\u6570 \\(a,b\\)\uff0c\u6211\u4eec\u5e0c\u671b\u6c42\u51fa\u5b83\u4eec\u7684\u6700\u5927\u516c\u7ea6\u6570 \\(\\gcd(a,b)\\)\u3002</p> <p>\u4e0d\u59a8\u8bbe \\(a&gt;b\\)\uff0c\u90a3\u4e48\u82e5 \\(b\\mid a\\)\uff0c\u5219 \\(b\\) \u663e\u7136\u4e3a \\(\\gcd(a,b)\\)\u3002</p> <p>\u5426\u5219\uff0c\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e \\(\\gcd(a,b)=\\gcd(b,a\\bmod b)\\)\uff0c\u8bc1\u660e\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>\u8bbe \\(a=bk+r\\)\uff0c\u5373 \\(r=a\\bmod b\\)\uff0c\u82e5\u6570 \\(d\\) \u6ee1\u8db3 \\(d\\mid a,d\\mid b\\)\uff0c\u5219 \\(d\\mid r=a-bk\\)\u3002</p> <p>\u6545\u800c\uff0c\u82e5 \\(d\\mid a,d\\mid b\\)\uff0c\u5219 \\(d\\mid a\\bmod b\\)\u3002</p> <p>\u6240\u4ee5 \\(a\\bmod b\\) \u7684\u7ea6\u6570\u96c6\u5408\u662f \\(a,b\\) \u7ea6\u6570\u96c6\u5408\u4ea4\u96c6\u7684\u8d85\u96c6\u3002</p> <p>\u53cd\u8fc7\u6765\uff0c\u6211\u4eec\u5c06\u8bc1\u660e\u82e5 \\(d\\mid b,d\\mid a\\bmod b\\)\uff0c\u5219 \\(d\\mid a\\)\uff0c\u8fd9\u4e2a\u540c\u7406\u3002</p> <p>\u8fd9\u8bf4\u660e\u4e86 \\(a\\bmod b\\) \u4e0e \\(b\\) \u7684\u7ea6\u6570\u96c6\u5408\u7684\u4ea4\u96c6\u662f \\(a\\) \u7ea6\u6570\u96c6\u5408\u7684\u5b50\u96c6\u3002</p> <p>\u7531\u4e8e\u6700\u5927\u516c\u7ea6\u6570\u4e0d\u4f1a\u8d85\u8fc7 \\(b\\)\uff0c\u6240\u4ee5\u6211\u4eec\u6c42 \\(\\gcd(b,a\\bmod b)\\) \u7684\u516c\u7ea6\u6570\u5373\u4e3a \\(\\gcd(a,b)\\)\u3002</p> <p>\u5c06 \\(a\\bmod b\\) \u5199\u5728\u7b2c\u4e8c\u9879\u5219\u603b\u662f\u6709 \\(a&gt;b\\)\u3002</p> <pre><code>int gcd(int a, int b) {\n    return b == 0 ? a : gcd(b, a % b);\n}\n</code></pre>"}, {"location": "Algorithms/NumberTheory/Number_Theory_1/#_5", "title": "\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b\u7684\u6c42\u89e3", "text": "<p>\u7ed9\u51fa \\(a,b\\)\uff0c\u6211\u4eec\u5e0c\u671b\u8ba1\u7b97\u65b9\u7a0b \\(ax+by=c\\) \u7684\u89e3\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_1/#_6", "title": "\u89e3\u7684\u5224\u5b9a / \u88f4\u8700\u5b9a\u7406", "text": "<p>\u4e0d\u5b9a\u65b9\u7a0b \\(ax+by=c\\) \u6709\u89e3\u7684\u5145\u8981\u6761\u4ef6\u662f\uff1a $$ \\gcd(a,b)\\mid c $$ \u9996\u5148\u663e\u7136 \\(\\gcd(a,b)\\not\\mid c\\) \u5219\u65e0\u89e3\u3002</p> <p>\u6211\u4eec\u53ea\u8ba8\u8bba \\(\\gcd(a,b)=c\\) \u7684\u60c5\u51b5\uff0c\u5426\u5219\u53ef\u4ee5\u6c42\u89e3 \\(ax+by=\\gcd(a,b)\\)\uff0c\u518d\u4e3a\u6c42\u5f97\u7684 \\(x,y\\) \u4e58\u4e0a \\(\\frac{c}{\\gcd(a,b)}\\)\u3002</p> <p>\u8bc1\u660e\uff1a</p> <p>\u8bbe\u96c6\u5408 \\(A\\)=\\(\\{ax+by\\in \\mathbb Z^+\\mid x,y\\in\\mathbb Z\\}\\)\u3002</p> <ol> <li> <p>\u5148\u8bc1\u660e \\(A\\) \u4e0d\u4e3a\u7a7a\u96c6\u3002</p> <p>\u7531\u4e8e \\(a,b\\) \u4e0d\u5168\u4e3a \\(0\\)\uff0c\u5219 \\(\\exists x,y\\in \\mathbb Z\\) \u6709 \\(ax+by\\neq 0\\)\uff0c\u800c \\(ax+by\\) \u4e0e \\(a(-x)+b(-y)\\) \u5fc5\u6709\u4e00\u4e2a\u662f\u6b63\u6574\u6570\u3002</p> </li> <li> <p>\u8bbe \\(d\\) \u4e3a \\(A\\) \u7684\u6700\u5c0f\u5143\uff0c\u6211\u4eec\u8bc1\u660e \\(d\\mid \\gcd(a,b)\\)\u3002</p> <p>\u4ee4 \\(a=\\alpha d+\\beta(0\\le \\beta&lt;d)\\)\uff0c\u5219</p> <p>\\(\\beta =a-\\alpha d=a-\\alpha (pa+qb)\\)\u3002</p> <p>\\(\\beta =(1-\\alpha p)a+(-\\alpha q)b\\in A\\)\u3002</p> <p>\u7531\u4e8e \\(d\\) \u7684\u6700\u5c0f\u6027\u4e0e \\(\\beta &lt;d\\)\uff0c\u5219\u5fc5\u6709 \\(\\beta=0\\)\u3002</p> </li> <li> <p>\u8bc1\u660e \\(d=\\gcd(a,b)\\)</p> <p>\u82e5 \\(u\\) \u6ee1\u8db3 \\(u\\mid a,u\\mid b\\)\uff0c\u5219 \\(u\\mid (ax+by)\\)\uff0c\u4e5f\u5373 \\(u\\mid d\\)\u3002</p> <p>\u6240\u4ee5 \\(d\\) \u4e3a\u6700\u5927\u516c\u56e0\u5b50\u3002</p> </li> <li> <p>\u7efc\u4e0a\uff0c\\(\\exists x,y\\in\\mathbb Z,ax+by=d\\)\u3002</p> </li> </ol> <p>\u4f2a\u8bc1\u4e00\u5219\uff08\u5faa\u73af\u8bba\u8bc1\uff09\uff1a</p> <p>\u8bc1\u660e \\(\\forall k\\in[0, b), \\exists x,ax\\equiv k\\pmod b\\) \u5373\u53ef\u3002</p> <p>\u6211\u4eec\u8bc1\u660e\uff1a\u82e5 \\(0\\le x, y&lt;b\\) \u4e14 \\(x\\neq y\\)\uff0c\u5219\u5fc5\u6709 \\(ax\\not\\equiv ay\\pmod b\\)\u3002</p> <p>\u8003\u8651\u5012\u63a8\uff0c\u82e5 \\(ax\\equiv ay\\pmod b\\)\uff0c\u5219 \\(ax-ay\\equiv 0\\pmod b\\)\u3002</p> <p>\u6709\u5f15\u7406\uff1a</p> <p>\u82e5 \\(c\\mid ab\\)\uff0c\u4e14 \\(c\\perp b\\)\uff0c\u5219 \\(c\\mid a\\)\u3002</p> <p>\u6240\u4ee5 \\(a(x-y)\\equiv 0\\pmod b\\)\uff0c\\(x\\equiv y\\pmod b\\)</p> <p>\u8be5\u8bc1\u660e\u7684\u201c\u5f15\u7406\u201d\u4e00\u6b65\u4e0e\u7b97\u6570\u57fa\u672c\u5b9a\u7406\u7b49\u4ef7\uff08\u5373\u6b27\u51e0\u91cc\u5f97\u5f15\u7406\uff09\uff0c\u4e14\u8be5\u5f15\u7406\u7684\u8bc1\u660e\u9700\u8981\u5229\u7528\u88f4\u8700\u5b9a\u7406\u3002</p> <p>\u4f46\u8fd9\u4e2a\u601d\u8def\u7ed9\u6211\u4eec\u5e26\u6765\u4e00\u4e9b\u542f\u53d1\uff0c\u8fd9\u4e2a\u8bc1\u660e\u7684\u601d\u8def\u5b9e\u8d28\u4e0a\u662f\uff1a</p> <p>\u6211\u4eec\u5e0c\u671b\u8bc1\u660e \\(f\\) \u662f\u4e00\u4e2a \\(S\\) \u5230 \\(T\\) \u7684\u53cc\u5c04\uff0c\u90a3\u4e48 \\(\\forall x,y\\in S\\) \u4e14 \\(x\\neq y\\) \u6709 \\(f(x)\\neq f(y)\\)\u3002</p> <p>\u8fd9\u53ef\u4ee5\u88ab\u7528\u6765\u8bc1\u660e \\(f\\) \u7684\u539f\u50cf\u96c6\u4e0e\u50cf\u96c6\u5927\u5c0f\u76f8\u540c\u3002</p> <p>\u5229\u7528\u53cc\u5c04\u76f8\u5173\u6765\u8bc1\u660e\u662f\u4e00\u79cd\u6781\u5176\u5e38\u7528\u7684\u601d\u8def\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-1/", "title": "\u56de\u5fc6\uff1a\u72c4\u5229\u514b\u96f7\u5377\u79ef\u4e0e\u79ef\u6027\u51fd\u6570", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-1/#_2", "title": "\u72c4\u5229\u514b\u96f7\u5377\u79ef", "text": "<p>\u6211\u4eec\u79f0\u4e00\u4e2a\u51fd\u6570 \\(f\\) \u662f\u6570\u8bba\u51fd\u6570\uff08\u7b97\u672f\u51fd\u6570\uff09\uff0c\u5f53\u4e14\u4ec5\u5f53 \\(f\\) \u7684\u5b9a\u4e49\u57df\u4e3a \\(\\mathbb N^+\\)\uff0c\u503c\u57df\u4e3a \\(\\mathbb C\\)\u3002</p> <p>\u6211\u4eec\u5b9a\u4e49\u72c4\u5229\u514b\u96f7\u5377\u79ef\u5982\u4e0b\uff1a</p> \\[ f*g(n)=\\sum_{i|n}f(i)g(\\frac{n}{i}) \\] <p>\u533a\u522b\u4e8e\u72c4\u5229\u514b\u96f7\u5377\u79ef\uff0c\u6211\u4eec\u5b9a\u4e49\u6570\u8bba\u51fd\u6570\u7684\u4e58\u6cd5\u4e3a\uff1a</p> \\[ (f\\cdot g)(n)=f(n)\\cdot g(n) \\] <p>\u76f4\u63a5\u5957\u7528\u5b9a\u4e49\uff0c\u4e0d\u96be\u8bc1\u660e\u72c4\u5229\u514b\u96f7\u5377\u79ef\u6709\u4ea4\u6362\u5f8b\uff0c\u7ed3\u5408\u5f8b\uff0c\u5bf9\u52a0\u6cd5\u7684\u5206\u914d\u5f8b\uff0c\u5e76\u4e14\u5b58\u5728\u5355\u4f4d\u5143 \\(\\epsilon(n) =[n=1]\\)\u3002\u5e76\u4e14\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a \\(f(1)\\neq 0\\) \u7684 \\(f\\)\uff0c\u603b\u5b58\u5728\u4e00\u4e2a\u9006\u5143 \\(g\\) \u4f7f\u5f97 \\(f*g=\\epsilon\\)\u3002\u5b9e\u9645\u4e0a\u6570\u8bba\u51fd\u6570\u5728\u72c4\u5229\u514b\u96f7\u5377\u79ef\u4f5c\u4e3a\u4e58\u6cd5\uff0c\u51fd\u6570\u52a0\u6cd5\u4f5c\u4e3a\u52a0\u6cd5\u7684\u60c5\u51b5\u4e0b\u6784\u6210\u6574\u73af\u3002</p> <p>\u8fd9\u91cc\u770b\u8d77\u6765\u53ea\u6709\u9006\u5143\u662f\u975e\u5e73\u51e1\u7684\uff0c\u8ba9\u6211\u4eec\u6765\u7814\u7a76\u4e00\u4e0b\u9006\u5143\uff1a</p> \\[ \\sum_{i\\mid n}f(i)g(\\frac{n}{i})= \\epsilon(n) \\] <p>\u8981\u6c42\u51fa \\(g(n)\\)\uff0c\u90a3\u4e48\uff1a</p> \\[ f(1)g(n)+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\frac{n}{i})=\\epsilon(n) \\] <p>\u663e\u7136\u6709\uff1a</p> \\[ g(n)=\\frac{1}{f(n)}\\left(\\epsilon(n)-\\sum_{i\\mid n,i\\neq 1}f(i)g(\\frac{n}{i})\\right) \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-1/#_3", "title": "\u79ef\u6027\u51fd\u6570", "text": "<p>\u5982\u679c\u5bf9\u4e8e\u4efb\u610f\u6ee1\u8db3 \\(n\\perp m\\) \u7684 \\(n,m\\in \\mathbb N^+\\)\uff0c\u6709 \\(f(n)f(m)=f(nm)\\)\uff0c\u6211\u4eec\u5219\u79f0 \\(f\\) \u662f\u79ef\u6027\u7684\u3002\u5982\u679c\u8fde \\(n\\perp m\\) \u7684\u6761\u4ef6\u4e5f\u4e0d\u9700\u8981\uff0c\u6211\u4eec\u79f0\u5176\u4e3a\u5b8c\u5168\u79ef\u6027\u7684\u3002 </p> <p>\u5982\u679c\u5c06\u6b63\u6574\u6570\u7684\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50\u89c6\u4f5c\u72ec\u7acb\u7684\u4e00\u7ef4\uff0c\u79ef\u6027\u7684\u542b\u4e49\u5c31\u662f\u53ef\u4ee5\u5c06\u4e24\u4e2a\u7ef4\u5ea6\u4e0d\u4ea4\u7684\u5411\u91cf\u5904\u7684\u4fe1\u606f\u5feb\u901f\u5408\u5e76\u8d77\u6765\u3002</p> <p>\u53ef\u4ee5\u8bc1\u660e\uff0c\u4e24\u4e2a\u79ef\u6027\u51fd\u6570\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u4ecd\u7136\u662f\u79ef\u6027\u51fd\u6570\uff0c\u79ef\u6027\u51fd\u6570\u5728\u72c4\u5229\u514b\u96f7\u5377\u79ef\u610f\u4e49\u4e0b\u7684\u9006\u4e5f\u662f\u79ef\u6027\u51fd\u6570\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-1/#_4", "title": "\u5e38\u89c1\u79ef\u6027\u51fd\u6570", "text": "<p>\u4e0b\u9762\u4e3e\u4f8b\u5217\u51fa\u4e00\u4e9b\u5e38\u89c1\u7684\u79ef\u6027\u51fd\u6570\uff1a</p> <ul> <li>\\(\\epsilon (n)=[n=1]\\) \uff08\u5143\u51fd\u6570\uff09</li> <li>\\(\\mathbf{id}^k(n)=n^k\\)</li> <li>\\(\\mathbf{I}(n)=1\\) \uff08\u6052\u7b49\u51fd\u6570\uff09</li> <li>\\(\\sigma_k(n)=\\displaystyle \\sum_{d|n}d^k\\) \uff08\\(k\\) \u6b21\u56e0\u6570\u548c\uff09</li> <li>\\(\\varphi(n)=\\displaystyle\\sum_{i=1}^{n}[\\gcd(i,n)=1]\\) \uff08\u6b27\u62c9\u51fd\u6570\uff09</li> <li>\\(\\lambda(n)=(-1)^{\\Omega (n)}\\)\uff0c\u5176\u4e2d \\(\\Omega(n)\\) \u4e3a\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u4e2d\u6240\u6709\u7d20\u6570\u7684\u5e42\u6b21\u4e4b\u548c\uff08\u5218\u7ef4\u5c14\u51fd\u6570\uff09</li> <li>\\(\\gamma(n)=(-1)^{\\omega(n)}\\)\uff0c\u5176\u4e2d \\(\\omega(n)\\) \u4e3a\u8d28\u56e0\u5b50\u4e2a\u6570\u3002</li> <li>\\(\\mu(n)=\\displaystyle\\prod_{p\\in\\mathbb P,p\\mid n}[p^2\\not\\mid n](-1)\\) \uff08\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\uff09\uff0c\u6b64\u5373\u4e3a \\(\\mathbf{I}(n)\\) \u5728\u72c4\u5229\u514b\u96f7\u5377\u79ef\u4e0b\u7684\u9006\u5143\u3002\u7528\u72c4\u5229\u514b\u96f7\u5377\u79ef\u9006\u7684\u5f0f\u5b50\u53ef\u4ee5\u8ba1\u7b97\u5f97\u5230\u3002</li> </ul>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-1/#_5", "title": "\u600e\u4e48\u7b5b\u51fa\u79ef\u6027\u51fd\u6570\uff1f", "text": "<p>\u6b64\u5185\u5bb9\u4ec5\u9002\u7528\u4e8e\u79ef\u6027\u51fd\u6570\u5728\u7d20\u6570\u5e42\u5904\u7684\u70b9\u503c\u53ef\u4ee5\u88ab\u5feb\u901f\u6c42\u51fa\u7684\u60c5\u51b5\u3002</p> <p>\u6211\u4eec\u77e5\u9053 \\(n\\) \u4ee5\u5185\u7684\u8d28\u6570\u4e2a\u6570 \\(\\pi(n)\\sim \\frac{n}{\\ln n}\\)\uff0c\u6240\u4ee5\u53ea\u8981\u6211\u4eec\u80fd\u5728 \\(\\mathcal O(\\log n)\\) \u7684\u65f6\u95f4\u5185\u6c42\u51fa\u6bcf\u4e2a\u7d20\u6570\u5e42\u5904\u7684\u51fd\u6570\u503c\uff0c\u5957\u7528\u5982\u4e0b\u65b9\u6cd5\u5c31\u53ef\u4ee5 \\(\\mathcal O(n)\\) \u6c42\u51fa \\(1\\sim n\\) \u5185\u7684\u6240\u6709\u51fd\u6570\u503c\u3002</p> <p>\u8003\u8651\u6b27\u62c9\u7b5b\uff0c\u6b27\u62c9\u7b5b\u7684\u539f\u7406\u662f\u6bcf\u4e2a \\(i\\) \u4f1a\u88ab\u5176\u6700\u5c0f\u8d28\u56e0\u5b50\u7b5b\u53bb\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u59a8\u540c\u65f6\u7ef4\u62a4\u6bcf\u4e2a\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\uff0c\u8bb0\u4e3a \\(\\mathbf{lpf}(n)\\)\uff0c\u518d\u8bb0 \\(\\delta(n)\\) \u4e3a\u6700\u5927\u7684\uff0c\u80fd\u6574\u9664 \\(n\\) \u7684\uff0c\\(\\mathbf{lpf}(n)\\) \u7684\u5e42\u3002\u90a3\u4e48 \\(\\frac{n}{\\delta(n)}\\perp \\delta(n)\\)\uff0c\u4ece\u800c\u6709 \\(f(n)=f(\\frac{n}{\\delta(n)})f(\\delta(n))\\)\uff0c\u6709\u65f6\u4e3a\u4e86\u6c42\u51fa\u8d28\u6570\u5e42\u5904\u7684\u503c\uff0c\u8fd8\u8981\u7ef4\u62a4\u6700\u5c0f\u8d28\u56e0\u5b50\u7684\u5e42\u6b21\u3002</p> <p>\u4f8b\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-1/#_6", "title": "\u7ecf\u5178\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14", "text": "<p>\u7531\u4e8e \\(\\mu(n)\\) \u4e3a \\(\\mathbf {I}(n)\\) \u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u9006\uff0c\u6240\u4ee5\uff1a</p> \\[ f*\\mathbf I=g\\Longleftrightarrow f=\\mu*g \\] <p>\u5728\u53f3\u4fa7\u5f0f\u5b50\u7684\u5de6\u53f3\u540c\u5377\u4e0a \\(\\mathbf I\\) \u5373\u53ef\u5f97\u5230\u5de6\u4fa7\u7684\u5f0f\u5b50\u3002</p> <p>\u8fd9\u53ef\u4ee5\u88ab\u7528\u6765\u89e3\u51b3 \\(f(n)\\) \u96be\u6c42\u800c \\(g(n)=\\displaystyle \\sum_{d\\mid n}f(n)\\) \u6613\u6c42\u7684\u60c5\u51b5\u3002</p> <p>\u4e8b\u5b9e\u4e0a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u8fd8\u6709\u500d\u6570\u5f62\u5f0f\uff1a</p> \\[ g(x)=\\sum_{x\\mid y}f(y)\\Longleftrightarrow f(x)=\\sum_{x\\mid y}\\mu(\\frac{y}{x})g(x) \\] <p>\u5176\u8bc1\u660e\u4ecd\u7136\u53ef\u4ee5\u53c2\u8003\u94c3\u60ac\u7684\u535a\u5ba2\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-2/", "title": "\u6574\u9664\u504f\u5e8f", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-2/#_2", "title": "\u9ad8\u7ef4\u70b9\u4e0e\u6574\u9664", "text": "<p>\u8bb0 \\(p_k\\) \u4e3a\u7b2c \\(k\\) \u4e2a\u7d20\u6570\uff0c\u90a3\u4e48\u7531\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff0c\u5bf9\u4e8e\u4efb\u610f \\(n\\) \u6709</p> \\[ n=\\prod_{i=1}^{+\\infty}p_i^{a_i} \\] <p>\u628a\u6bcf\u4e2a\u7d20\u6570\u770b\u4f5c\u662f\u4e00\u4e2a\u7ef4\u5ea6\uff0c\u90a3\u4e48\u6bcf\u4e2a\u6570 \\(n\\) \u5c31\u662f\u4e00\u4e2a\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u7684\u70b9\u3002</p> <p>\u5bf9 \\(n,m\\)\uff0c\u5206\u522b\u8bb0\u4ed6\u4eec\u7684\u552f\u4e00\u5206\u89e3\u5f0f\u4e3a</p> \\[ \\begin{aligned} n&amp;=\\prod_{i=1}^{+\\infty}p_i^{a_i}\\\\ m&amp;=\\prod_{i=1}^{+\\infty}p_i^{b_i} \\end{aligned} \\] <p>\\(\\gcd(n,m)\\) \u548c \\(\\operatorname{lcm}(n,m)\\) \u5206\u522b\u4e3a\uff1a</p> \\[ \\begin{aligned} \\gcd(n,m)&amp;=\\prod_{i=1}^{+\\infty}p_i^{\\min(a_i,b_i)}\\\\ \\operatorname{lcm}(n,m)&amp;=\\prod_{i=1}^{+\\infty}p_i^{\\max(a_i,b_i)} \\end{aligned} \\] <p>\u4e0b\u9762\u6240\u6709\u8ba8\u8bba\u63d0\u53ca \\(n,m\\) \u65f6\u90fd\u5047\u8bbe \\(m\\mid n\\)\u3002</p> <p>\u5b9a\u4e49\u51fd\u6570 \\(f\\) \u7684 zeta \u53d8\u6362 \\(f\\zeta\\)</p> \\[ f\\zeta(n)=(f*\\mathbf{I})(n)=\\sum_{d\\mid n}f(d) \\] <p>\u6211\u4eec\u77e5\u9053\uff0c\u82e5 \\(m\\mid n\\) \u5219\u6709 \\(\\forall i, b_i\\le a_i\\)\uff0c\u4e0d\u96be\u6ce8\u610f\u5230\u6574\u9664\u662f\u6784\u6210\u4e00\u4e2a\u504f\u5e8f\u5173\u7cfb\u7684\uff0c\u6211\u4eec\u79f0\u8fd9\u4e3a\u6574\u9664\u504f\u5e8f\uff0czeta \u53d8\u6362\u5b9e\u9645\u4e0a\u662f\u5728\u6574\u9664\u504f\u5e8f\u4e0a\u505a\u4e86\u4e00\u4e2a\u9ad8\u7ef4\u524d\u7f00\u548c\u3002</p> <p>\u65e2\u7136\u6709\u9ad8\u7ef4\u524d\u7f00\u548c\uff0c\u5f53\u7136\u4e5f\u8981\u6709\u9ad8\u7ef4\u5dee\u5206\u3002\u6211\u4eec\u5f53\u7136\u77e5\u9053\u8fd9\u662f\u5377\u4e0a \\(\\mu\\)\uff0c\u4f46\u4e0b\u9762\u8ba9\u6211\u4eec\u4ece\u7ec4\u5408\u610f\u4e49\u7684\u89c6\u89d2\u770b\u770b \\(\\mu\\) \u662f\u600e\u4e48\u6765\u7684\u3002</p> <p>\u8bbe \\(g=f\\zeta\\)\uff0c \u7ed9\u5b9a \\(g\\)\uff0c\u8003\u8651\u600e\u4e48\u5bf9\u6bcf\u4e2a \\(n\\) \u8fd8\u539f\u51fa \\(f(n)\\)\u3002</p> <p>\u5148\u51cf\u53bb\u6240\u6709 \\(m\\) \u6bd4 \\(n\\) \u5728\u4e00\u4e2a\u7d20\u6570\u5904\u6307\u6570\u6bd4 \\(n\\) \u5c0f \\(1\\) \u7684 \\(g(m)\\)\uff0c\u90a3\u5982\u679c \\(m\\) \u6bd4 \\(n\\) \u5728\u4e24\u4e2a\u7d20\u6570\u5904\u6307\u6570\u6bd4 \\(n\\) \u5c0f \\(1\\) \u5c31\u51cf\u591a\u4e86\uff0c\u518d\u52a0\u56de\u8fd9\u90e8\u5206\u7684 \\(g(m)\\)\uff0c\u518d\u51cf\u53bb\u4e09\u4e2a\u7d20\u6570\u5904\u6307\u6570\u6bd4 \\(n\\) \u5c0f \\(1\\) \u7684\u2026\u2026</p> <p>\u8fd9\u4e2a\u5c0f \\(1\\) \u53ea\u662f\u5728\u94a6\u5b9a\u67d0\u51e0\u7ef4\u6bd4 \\(n\\) \u5c0f\uff0c\u4e5f\u5c31\u662f\u51cf\u7684\u65f6\u5019\u4f1a\u628a\u6240\u6709\u8fd9\u51e0\u7ef4\u6bd4 \\(n\\) \u5c0f\u7684\u5168\u90e8\u51cf\u6389\uff0c\u6240\u4ee5\u4e0d\u4f1a\u6f0f\u7b97\u3002</p> <p>\u663e\u7136\uff0c\\(m\\) \u7684\u5bb9\u65a5\u7cfb\u6570\u4e3a\uff1a</p> \\[ \\left[\\frac{n}{m}\u6ca1\u6709\u5e73\u65b9\u56e0\u5b50\\right](-1)^{\\frac{n}{m}\u7684\u7d20\u56e0\u5b50\u4e2a\u6570} \\] <p>\u4e5f\u5c31\u662f\u3002</p> \\[ f(n)=(g*\\mu)(n) \\] <p>\u90a3\u4e48\u6211\u4eec\u5b9a\u4e49 \\(f\\) \u7684 M\u00f6bius \u53d8\u6362 \\(f\\mu\\) \u662f</p> \\[ f\\mu=\\sum_{d\\mid n}f(d)\\mu\\left(\\frac{n}{d}\\right) \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-2/#_3", "title": "\u66f4\u5feb\u901f\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef", "text": "<p>\u4e0d\u59a8\u5047\u8bbe \\(f\\) \u662f\u4efb\u610f\u6570\u8bba\u51fd\u6570\uff0c\u800c \\(g\\) \u662f\u4efb\u610f\u79ef\u6027\u51fd\u6570\u3002\u73b0\u5728\u6211\u4eec\u8981\u6c42</p> \\[ (f*g)(n) \\] <p>\u7684\u524d \\(n\\) \u9879\u3002\u76f4\u63a5\u6839\u636e\u5b9a\u4e49\u505a\u5c31\u53ef\u4ee5\u8fbe\u5230</p> \\[ \\sum_{i=1}^{n}\\sigma_0(i)=\\mathcal O(n\\log n) \\] <p>\u7684\u590d\u6742\u5ea6\uff0c\u4e14\u4e0d\u8981\u6c42 \\(g\\) \u7684\u79ef\u6027\u3002\u4f46\u662f\u5f53\u6211\u4eec\u5728 \\(g\\) \u662f\u67d0\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u7684\u65f6\u5019\u4f1a\u4e0d\u4f1a\u6709\u66f4\u597d\u7684\u505a\u6cd5\uff1f</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-2/#zeta", "title": "zeta \u53d8\u6362", "text": "<p>\u5148\u6765\u770b\u51e0\u4e2a\u7b80\u5355\u7684\u60c5\u51b5\uff0c\u6bd4\u5982\u6211\u4eec\u600e\u4e48\u5feb\u901f\u8ba1\u7b97</p> \\[ f\\zeta(n)=\\sum_{d\\mid n}f(d) \\] <p>\u7684\u524d \\(n\\) \u9879\u3002</p> <p>\u5f15\u7406</p> <p>\u8bbe \\(g_k(k^t)=1\\)\uff0c\u5176\u4f59\u4f4d\u7f6e\u4e3a \\(0\\)\uff0c\u90a3\u4e48 \\(g\\) \u662f\u79ef\u6027\u51fd\u6570\uff0c\u4e14\u8bbe</p> \\[ f=g_{p_1}*g_{p_2}*g_{p_3}*\\cdots *g_{p_{\\pi(n)}} \\] <p>\u90a3\u4e48\u5bf9\u6240\u6709 \\(i\\le n\\)\uff0c\u6709 \\(f(i)=1\\)\u3002</p> <p>\u8bc1\u660e\uff1a \u8003\u8651\u5f52\u7eb3\u6cd5\u3002</p> <p>\u5047\u8bbe\u5bf9\u4e8e \\(i-1\\)\uff0c\u6240\u6709\u8d28\u56e0\u5b50\u96c6\u5408\u4e3a \\(\\{p_1,p_2,\\cdots, p_{i-1}\\}\\) \u5b50\u96c6\u7684\u6570 \\(n\\)\uff0c\u5747\u6709 \\(f(n)=1\\)\uff0c\u5426\u5219 \\(f(n)=0\\)\u3002</p> <p>\u90a3\u4e48\u8003\u5bdf \\(f*g(n)\\)</p> \\[ (f*g)(n)=\\sum_{d\\mid n}f\\left(\\frac{n}{d}\\right)g\\left(d\\right) \\] <p>\u8bb0 \\(t=p_i^{v_{p_i}(n)}\\)\uff0c\u90a3\u4e48\u663e\u7136\u5f53\u4e14\u4ec5\u5f53 \\(d=t\\) \u7684\u65f6\u5019 \\(f\\left(\\frac{n}{d}\\right)=1,g\\left( d\\right)=1\\)\uff0c\u5426\u5219\u4e24\u8005\u5fc5\u6709\u4e00\u4e3a \\(0\\)\u3002</p> <p>\u4ece\u800c\u6709\u5bf9\u4e8e \\(i\\)\uff0c\u6240\u6709\u8d28\u56e0\u5b50\u96c6\u5408\u4e3a \\(\\{p_1,p-2,\\cdots, p_{i}\\}\\) \u5b50\u96c6\u7684\u6570 \\(n\\) \u5747\u6709 \\(f(n)=1\\)\uff0c\u5426\u5219 \\(f(n)=0\\)\u3002</p> <p>\u56e0\u4e3a\u6211\u4eec\u53ea\u8981\u524d \\(n\\) \u9879\uff0c\u90a3\u73b0\u5728\u5c31\u662f\u8ba1\u7b97</p> \\[ f*g_{p_1}*g_{p_2}*\\cdots *g_{p_{\\pi(n)}} \\] <p>\u8003\u8651\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u7d20\u6570\uff0c\u5f53\u524d\u7d20\u6570\u4e3a \\(p\\)\uff0c\u5df2\u77e5 \\(f\\)\uff0c\u8981\u6c42 \\(f*g_p\\)\u3002</p> \\[ f*g_p(n)=\\sum_{p^k\\mid n}f\\left(\\frac{n}{p^k}\\right) \\] <p>\u6ce8\u610f\u5230\u4e00\u4e2a\u6027\u8d28\u662f\uff0c\u6240\u6709 \\(t\\ge 1\\)\uff0c\u6709 \\(\\frac{n}{p^t}\\mid \\frac{n}{p}\\)\uff0c\u6240\u4ee5\u5c31\u6709\uff1a</p> \\[ \\begin{aligned} f*g_p\\left(\\frac{n}{p}\\right)&amp;=\\sum_{p^k\\mid \\frac{n}{p}}f\\left(\\frac{n}{p^k}\\right)\\\\ f*g_p\\left(n\\right)&amp;=f*g_p\\left(\\frac{n}{p}\\right)+f(n) \\end{aligned} \\] <p>\u6240\u4ee5\u5982\u679c\u5bf9\u6240\u6709 \\(m&lt;n\\) \u7684 \\(f(n)\\) \u90fd\u5df2\u7ecf\u7ef4\u62a4\u51fa\u4e86\u6b63\u786e\u7684\u503c\uff0c\u8f6c\u79fb\u76f4\u63a5</p> \\[ f(n)\\leftarrow f(n)+f\\left(\\frac{n}{p}\\right) \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-2/#mobius", "title": "M\u00f6bius \u53d8\u6362", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/", "title": "\u6570\u8bba\u6c42\u548c\u57fa\u7840\u6280\u5de7", "text": "<p>\u5728\u4e0a\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u770b\u5230\u4e86\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5728\u6d88\u53bb \\(\\gcd\\)\uff0c\u6216\u662f \\(\\epsilon\\) \u7684\u9650\u5236\u65f6\u5f3a\u5927\u7684\u80fd\u529b\u3002\u8fd9\u4e9b\u80fd\u529b\u540c\u6837\u53ef\u4ee5\u88ab\u7528\u6765\u5904\u7406\u66f4\u591a\u7684\u6570\u8bba\u6c42\u548c\u95ee\u9898\uff0c\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6570\u8bba\u6c42\u548c\u90fd\u6709\u7740\u7b80\u6d01\u7684\u5c01\u95ed\u5f62\u5f0f\uff08\u4e8b\u5b9e\u4e0a\uff0c\u901a\u5e38\u6ca1\u6709\uff09\uff0c\u90a3\u4e48\u9996\u5148\u8981\u95ee\u51fa\u7684\u95ee\u9898\u5c31\u662f\uff1a</p> <ul> <li>\u4ec0\u4e48\u6837\u7684\u5f62\u5f0f\u662f\u6211\u4eec\u9700\u8981\u7684 / \u662f\u53ef\u4ee5\u5feb\u901f\u8ba1\u7b97\u7684\uff1f</li> <li>\u4e3a\u4e86\u5f97\u5230\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u9700\u8981\u4f5c\u4ec0\u4e48\u6837\u7684\u53d8\u6362\uff1f</li> </ul>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_2", "title": "\u4ea4\u6362\u6c42\u548c\u53f7", "text": "<p>\u4ea4\u6362\u6c42\u548c\u53f7\uff0c\u66ff\u6362\u6c42\u548c\u5bf9\u8c61\u5bf9\u4e8e\u548c\u5f0f\u7684\u5904\u7406\u6709\u7740\u91cd\u8981\u7684\u4f5c\u7528\u3002</p> <p>\u5176\u539f\u5219\u4e3a\u201c\u5165\u5185\u6c42\u4ea4\uff0c\u51fa\u5916\u6c42\u5e76\u201d\u3002</p> <p>\u5f62\u5f0f\u5316\u5730\u8bf4\uff1a</p> \\[ \\sum_{i\\in A}\\sum_{j\\in B(i)}a_{i,j}=\\sum_{j\\in \\cup_{i\\in A}B(i)}\\sum_{i\\in\\{i\\in A\\mid j\\in B(i)\\}}a_{i,j} \\] <ul> <li> <p>\u51fa\u5916\u6c42\u5e76\uff1a\u54d1\u6307\u6807 \\(j\\) \u5728\u7531\u5185\u5c42\u79fb\u52a8\u5230\u5916\u5c42\u7684\u65f6\u5019\uff0c\u53d6\u503c\u8303\u56f4\u662f\u6240\u6709\u5185\u5c42\u53ef\u53d6\u8303\u56f4\u7684\u5e76\u96c6</p> </li> <li> <p>\u5165\u5185\u6c42\u4ea4\uff1a\u54d1\u6307\u6807 \\(i\\) \u5728\u7531\u5916\u5c42\u79fb\u52a8\u5230\u5185\u5c42\u7684\u65f6\u5019\uff0c\u53d6\u503c\u8303\u56f4\u662f\u5916\u5c42\u53ef\u53d6\u8303\u56f4\uff0c\u4ea4\u4e0a\u6240\u6709\u4f1a\u7edf\u8ba1\u5230 \\(j\\) \u7684 \\(i\\)\u3002</p> <p>\u8fd9\u4e00\u6761\u5728\u591a\u5143\u7684\u60c5\u51b5\u4e0b\u4f1a\u66f4\u52a0\u663e\u7136\uff1a</p> \\[ \\sum_{i\\in A}\\sum_{j\\in B(i)}\\sum_{k\\in C(i)} \\] <p>\u90a3\u4e48\u5728\u5c06 \\(i\\) \u79fb\u52a8\u5230\u6700\u5185\u5c42\u7684\u65f6\u5019\uff0c\u5b83\u65e2\u8981\u80fd\u7edf\u8ba1\u5230 \\(j\\)\uff0c\u53c8\u8981\u80fd\u7edf\u8ba1\u5230 \\(k\\)\uff0c\u662f\u7edf\u8ba1\u5230 \\(j\\) \u7684 \\(i\\) \u96c6\u5408\u4e0e\u7edf\u8ba1\u5230 \\(k\\) \u7684 \\(i\\) \u96c6\u5408\u7684\u5e76\u96c6\u3002</p> </li> </ul> <p>\u5de6\u8fb9\u7684\u542b\u4e49\u662f\u663e\u7136\u7684\uff0c\u5bf9\u6240\u6709\u6570\u96c6 \\(A\\) \u4e2d\u7684 \\(i\\)\uff0c\u627e\u5230\u4f9d\u8d56\u4e8e \\(i\\) \u7684\u7ea6\u675f\u7684\u6570\u96c6 \\(B(i)\\)\uff0c\u518d\u679a\u4e3e\u6bcf\u4e2a \\(j\\in B(i)\\) \u6765\u6c42\u548c\u3002</p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u8981\u5148\u679a\u4e3e\u6240\u6709 \\(j\\)\uff0c\\(j\\) \u7684\u679a\u4e3e\u8303\u56f4\u5c31\u662f\u6240\u6709 \\(B_i\\) \u4e4b\u5e76\uff0c\u5728\u786e\u5b9a\u4e86 \\(j\\) \u4e4b\u540e\uff0c\u627e\u5230\u6240\u6709 \\(j\\in B(i)\\) \u7684 \\(i\\)\uff0c\u4e5f\u5c31\u662f\u5b83\u4f1a\u88ab\u54ea\u4e9b \\(i\\) \u7edf\u8ba1\u5230\u3002</p> <p>\u53ef\u8fd9\u4e2a\u6280\u5de7\u6709\u4ec0\u4e48\u7528\uff1f</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_3", "title": "\u4f8b\u4e00", "text": "<p>\u6c42\uff1a</p> \\[ \\sum_{i=1}^{n}\\sum_{d|i}d \\] <p>\u76f4\u63a5\u66b4\u529b\u505a\u662f \\(\\mathcal O(n\\sqrt n)\\) \u7684\uff0c\u8003\u8651\u5148\u679a\u4e3e \\(d\\)\uff0c\u90a3\u4e48 \\(d\\) \u6240\u6709\u7684\u53d6\u503c\u5c31\u662f \\(1\\sim n\\) \u4e4b\u95f4\uff0c\u800c\u6bcf\u4e2a \\(d\\) \u53ea\u4f1a\u88ab\u5176\u500d\u6570\u679a\u4e3e\u5230\uff1a</p> \\[ \\sum_{d=1}^{n}\\sum_{d|i,i\\le n}d \\] <p>\u540e\u9762\u90a3\u4e2a\u6c42\u548c\u53f7\u548c \\(d\\) \u6ca1\u5173\u7cfb\uff0c\u63d0\u51fa\u6765\uff1a</p> \\[ \\sum_{d=1}^{n}d\\sum_{d|i,i\\le n}1 \\] <p>\u663e\u7136\uff0c\u8fd9\u662f\uff1a</p> \\[ \\sum_{d=1}^{n}d\\lfloor\\frac{n}{d}\\rfloor \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_4", "title": "\u4f8b\u4e8c", "text": "<p>\u6c42\uff1a</p> \\[ \\sum_{i=1}^{n}\\varphi(i)\\left\\lfloor\\frac{n}{i}\\right\\rfloor \\] <p>\\(\\left\\lfloor\\frac{n}{i}\\right\\rfloor\\) \u8ba9\u6211\u4eec\u8054\u60f3\u5230 \\(n\\) \u4ee5\u5185 \\(i\\) \u7684\u500d\u6570\uff0c\u90a3\u5c31\u53d8\u6210\u500d\u6570\uff1a</p> \\[ \\sum_{i=1}^{n}\\sum_{i|j,j\\le n}\\varphi(i) \\] <p>\u4ea4\u6362\u6c42\u548c\u53f7\uff0c\u5148\u679a\u4e3e \\(j\\)\uff0c\u90a3\u5185\u5c42\u5c31\u5e94\u8be5\u662f\u6240\u6709\u80fd\u679a\u4e3e\u5230 \\(j\\) \u7684\u54d1\u6307\u6807 \\(i\\)\u3002</p> \\[ \\sum_{j=1}^{n}\\sum_{i\\mid j}\\varphi(i) \\] <p>\u6211\u4eec\u77e5\u9053 \\(\\varphi*\\mathbf{I}=\\text{id}\\)\uff0c\u6240\u4ee5\u539f\u5f0f\u5373\u4e3a\uff1a</p> \\[ \\sum_{j=1}^nj=\\binom{n+1}{2} \\] <p>\u987a\u5e26\u4e00\u63d0\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u8fd8\u7b49\u4e8e</p> \\[ \\sum_{i=1}^{n}\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}\\varphi(j) \\] <p>\u5982\u679c\u4f60\u7b2c\u4e00\u6b65\u5c31\u5c1d\u8bd5\u53bb\u4ea4\u6362\u6c42\u548c\u53f7\u5c31\u4f1a\u7b97\u51fa\u8fd9\u4e2a\u4e1c\u897f\u3002</p> <p>\u9274\u4e8e\u524d\u51e0\u6b65\u4e2d\u6ca1\u6709\u7528\u5230\u4efb\u4f55\u7684 \\(\\varphi(n)\\) \u51fd\u6570\u6027\u8d28\uff0c\u6211\u4eec\u6709\uff1a</p> \\[ \\sum_{i=1}^{n}\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}f(i)=\\sum_{i=1}^{n}\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}f(j)=\\sum_{i=1}^{n}\\sum_{d\\mid i}f(d) \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_5", "title": "\u6574\u9664\u5206\u5757", "text": "<p>\u6211\u4eec\u65f6\u5e38\u80fd\u89c1\u5230\u5f62\u5982\uff1a</p> \\[ \\sum_{i=1}^{n}g(\\lfloor\\frac{n}{i}\\rfloor) f(i) \\] <p>\u7684\u548c\u5f0f\u3002\u5047\u8bbe \\(g\\) \u7684\u5355\u70b9\u503c\uff0c\\(f\\) \u7684\u524d\u7f00\u548c\u590d\u6742\u5ea6\u662f \\(\\mathcal O(1)\\) \u7684\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5 \\(\\mathcal O(\\sqrt n)\\) \u6c42\u51fa\u3002</p> <p>\u8fd9\u662f\u56e0\u4e3a \\(\\lfloor\\frac{n}{i}\\rfloor\\) \u81f3\u591a\u53ea\u6709 \\(2\\sqrt n\\) \u4e2a\u4e0d\u540c\u7684\u503c\uff0c\u8bc1\u660e\u7c7b\u4f3c\u7ea6\u6570\u4e2a\u6570\uff0c\u5206\u7c7b\u8ba8\u8bba\u5373\u53ef\u3002\u5f53 \\(i\\le \\sqrt n\\) \u65f6\uff0c\\(\\lfloor\\frac{n}{i}\\rfloor\\) \u663e\u7136\u53ea\u6709 \\(\\sqrt n\\) \u4e2a\u503c\uff0c\u5f53 \\(i&gt;\\sqrt n\\) \u65f6\uff0c\\(\\lfloor\\frac{n}{i}\\rfloor\\le \\sqrt n\\)\uff0c\u4e5f\u53ea\u6709 \\(\\sqrt n\\) \u4e2a\u503c\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e2a \\(\\mathcal O(\\sqrt n)\\) \u4e2a\u6570\u5206\u522b\u662f \\(1,2,3,\\cdots, \\lfloor\\sqrt n\\rfloor,\\left\\lfloor\\frac{n}{\\lfloor\\sqrt n\\rfloor}\\right\\rfloor,\\left\\lfloor\\frac{n}{\\lfloor\\sqrt n\\rfloor-1}\\right\\rfloor,\\cdots, \\left\\lfloor\\frac{n}{2}\\right\\rfloor,n\\)\u3002</p> <p>\u6709\u4e86\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u600e\u4e48\u5b9e\u73b0\u8fd9\u4e2a\u505a\u6cd5\u5462\uff1f\u6709\u7ed3\u8bba\uff1a</p> <p>\u5bf9\u4e8e\u56fa\u5b9a\u7684 \\(n,l\\)\uff0c\u4ee4 \\(\\lfloor\\frac{n}{r}\\rfloor=\\lfloor\\frac{n}{l}\\rfloor\\) \u7684\u6700\u5927\u7684 \\(r\\) \u7684\u503c\u4e3a\uff1a</p> \\[ \\left\\lfloor\\frac{n}{\\left\\lfloor\\frac{n}{l}\\right\\rfloor}\\right\\rfloor \\] <p>\u8bb0 \\(\\operatorname{segl}(n,d)\\) \u8868\u793a\u6240\u6709 \\(1\\sim n\\) \u7684\u6570 \\(k\\) \u4e2d\uff0c\\(\\lfloor\\frac{n}{k}\\rfloor=\\lfloor\\frac{n}{d}\\rfloor\\) \u7684\u6700\u5c0f\u7684 \\(k\\)\u3002\u8bb0 \\(\\operatorname{segr}(n,d)\\) \u662f\u6700\u5927\u7684\u90a3\u4e2a \\(k\\)\u3002</p> <p>\u8bc1\u660e\uff1a</p> <p>\\(\\lfloor\\frac{n}{l}\\rfloor\\le \\frac{n}{l}\\)\uff0c\u4ece\u800c\u6709 \\(\\frac{n}{\\lfloor\\frac{n}{l}\\rfloor}\\ge \\frac{n}{\\frac{n}{l}}\\)\u3002</p> <p>\u4e5f\u5c31\u662f</p> \\[ \\left\\lfloor\\frac{n}{\\left\\lfloor\\frac{n}{l}\\right\\rfloor}\\right\\rfloor\\ge \\left\\lfloor l \\right\\rfloor=l \\] <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u6ee1\u8db3 \\(\\lfloor\\frac{n}{l}\\rfloor =k\\) \u7684\u6240\u6709 \\(l\\)\uff0c\u603b\u6709 \\(\\lfloor\\frac{n}{k}\\rfloor\\ge l\\)\u3002</p> <p>\u7531\u4e8e\u8fd9\u4e2a\u6280\u5de7\u5c06 \\(1\\sim n\\) \u4e2d\u7684\u6570 \\(i\\) \u6309 \\(\\lfloor\\frac{n}{i}\\rfloor\\) \u5206\u6210\u4e86\u82e5\u5e72\u4e2a\u5757\uff08\u533a\u95f4\uff09\uff0c\u6240\u4ee5\u88ab\u79f0\u4e3a\u6574\u9664\u5206\u5757\uff0c\u6216\u6570\u8bba\u5206\u5757\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#p2511-problem-b", "title": "\u4f8b\u4e09 / P2511 Problem B", "text": "<p>\u7ed9\u51fa \\(N,M\\)\uff0c\u6c42\uff1a</p> \\[ \\sum_{i=1}^{N}\\sum_{j=1}^{M}[\\gcd(i,j)=1] \\] Solution <p>\\(\\epsilon(\\gcd(i,j))\\) \u662f\u96be\u6c42\u7684\uff0c\u4f46 \\(\\displaystyle \\sum_{d\\mid \\gcd(i,j)}\\epsilon(d)\\) \u663e\u7136\u4e3a \\(\\mathbf {I}\\)\u3002\u5c06\u6c42\u548c\u5bf9\u8c61\u53d8\u6362\u4e3a \\(\\mu*\\mathbf{I}\\)\uff1a</p> \\[ \\sum_{i=1}^{N}\\sum_{j=1}^{M}\\displaystyle \\sum_{d\\mid \\gcd(i,j)}\\mu(d) \\] <p>\u7ee7\u7eed\u4f5c\u53d8\u6362\uff1a</p> \\[ \\begin{aligned} &amp;\\phantom{;=}\\sum_{i=1}^{N}\\sum_{j=1}^{M}\\displaystyle \\sum_{d\\mid \\gcd(i,j)}\\mu(d)\\\\ &amp;=\\sum_{i=1}^{N}\\sum_{j=1}^{M}\\sum_{d\\mid i,d\\mid j}\\mu(d)\\\\ &amp;=\\sum_{d=1}^{\\min(N,M)}\\mu(d)\\sum_{i=1}^{\\lfloor\\frac{N}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{M}{d}\\rfloor}1&amp;\u4ea4\u6362\u6c42\u548c\u53f7\\\\ &amp;=\\sum_{d=1}^{\\min(N,M)}\\mu(d)\\lfloor\\frac{N}{d}\\rfloor\\lfloor\\frac{M}{d}\\rfloor \\end{aligned} \\] <p>\u5bf9\u4e8e \\([\\gcd(i,j)=k]\\) \u7684\u66f4\u4e3a\u4e00\u822c\u7684\u60c5\u51b5\uff0c\u53ea\u8981\u6211\u4eec\u5168\u90e8\u679a\u4e3e\u7684\u90fd\u662f \\(k\\) \u7684\u500d\u6570\u5373\u53ef\u3002\u4e5f\u5c31\u662f\uff0c\u53d8\u4e3a</p> \\[ \\sum_{i=1}^{\\lfloor\\frac{N}{k}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{M}{k}\\rfloor}\\displaystyle [\\gcd(i,j)=1] \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_6", "title": "\u4e8c\u91cd\u6574\u9664\u5206\u5757", "text": "<p>\u6709\u65f6\u6211\u4eec\u4f1a\u9047\u5230\u8fd9\u79cd\u6c42\u548c\uff1a</p> \\[ \\sum_{i=1}^{n}f(i)\\sum_{j=1}^{\\left\\lfloor\\frac{n}{i}\\right\\rfloor}g\\left(\\left\\lfloor\\frac{n}{ij}\\right\\rfloor\\right) \\] <p>\u6211\u4eec\u77e5\u9053\uff0c\\(\\left\\lfloor\\frac{n}{ij}\\right\\rfloor=\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{i}\\right\\rfloor}{j}\\right\\rfloor\\)\u3002\u6240\u4ee5\u8fd9\u4e5f\u53ef\u4ee5\u5199\u6210\uff1a</p> \\[ \\sum_{i=1}^{n}f(i)\\sum_{j=1}^{\\left\\lfloor\\frac{n}{i}\\right\\rfloor}g\\left(\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{i}\\right\\rfloor}{j}\\right\\rfloor\\right) \\] <p>\u4e00\u4e2a\u76f4\u767d\u7684\u60f3\u6cd5\u662f\uff0c\u5185\u5c42\u7528\u5230\u7684\u503c\u90fd\u53ea\u4e0e \\(\\lfloor\\frac{n}{i}\\rfloor\\) \u76f8\u5173\uff0c\u90a3\u4e48\u6211\u4eec\u5bf9\u5916\u5c42\u6574\u9664\u5206\u5757\uff0c\u5bf9\u6bcf\u4e2a\u5185\u5c42 \\(\\lfloor\\frac{n}{i}\\rfloor\\) \u5c31\u56fa\u5b9a\u4e86\uff0c\u518d\u65bd\u4e00\u6b21\u6574\u9664\u5206\u5757\u5373\u53ef\u3002\u4f46\u95ee\u9898\u662f\uff0c\u8fd9\u79cd\u505a\u6cd5\u7684\u590d\u6742\u5ea6\u662f\u4ec0\u4e48\uff1f</p> <p>\u6211\u4eec\u4ecd\u7136\u8bbe \\(f,g\\) \u7684\u6c42\u503c\u90fd\u662f \\(\\mathcal O(1)\\) \u7684\u3002\u6309\u7167 \\(i\\le \\sqrt n\\) \u4e0e \\(i&gt; \\sqrt n\\) \u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a</p> <p>\u8ba1\u7b97\uff1a</p> \\[ \\begin{aligned} T(n)&amp;=\\sum_{i=1}^{\\sqrt {n}}\\mathcal O\\left(\\sqrt \\frac{n}{i}\\right)+\\sum_{i=1}^{\\sqrt n}\\mathcal O\\left(\\sqrt i\\right)\\\\ &amp;\\le \\mathcal O\\left(\\int_1^{\\sqrt n}\\left(\\sqrt i+\\sqrt\\frac{n}{i}\\right)\\operatorname{d}i\\right)\\\\ &amp;=\\mathcal O(n^{\\frac{3}{4}}) \\end{aligned} \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_7", "title": "\u53ea\u80fd\u7528\u6765\u8ba1\u7b97\u5417\uff1f", "text": "<p>\u6574\u9664\u5206\u5757\u4e3a\u6211\u4eec\u63ed\u793a\u4e86\u6574\u4e2a\u5e8f\u5217 \\(g(i)=f(\\lfloor\\frac{n}{i}\\rfloor)\\) \u53ea\u6709 \\(\\mathcal O(\\sqrt n)\\) \u4e2a\u4f4d\u7f6e\u7684\u503c\u662f\u975e\u5e73\u51e1\u7684\uff0c\u5373 \\(g(i)\\neq g(i-1)\\)\u3002\u5f53\u6211\u4eec\u5728\u5904\u7406\u4e00\u957f\u4e32\u7684 \\(\\texttt{=}\\) \u53f7\u65f6\uff0c\u5dee\u5206\u603b\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002\u6211\u4eec\u5c06\u5e8f\u5217\u5dee\u5206\u6389\uff0c\u73b0\u5728\u5b83\u53ea\u6709 \\(\\mathcal O(\\sqrt n)\\) \u4e2a\u4f4d\u7f6e \\(\\neq 0\\) \u4e86\uff01</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_8", "title": "\u603b\u7ed3", "text": "<p>\u91cd\u65b0\u6e05\u70b9\u4e00\u4e0b\uff0c\u6211\u4eec\u73b0\u5728\u62e5\u6709\u7684\u6c42\u548c\u624b\u6bb5\u5df2\u7ecf\u6709\uff1a</p> <ol> <li>\u6c42\u6570\u8bba\u51fd\u6570 \\(g\\) \u4e0e\u79ef\u6027\u51fd\u6570 \\(f\\) \u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u524d \\(n\\) \u9879 - \\(\\mathcal O(n\\log \\log n)\\)\u3002</li> <li>\u6c42\u79ef\u6027\u51fd\u6570\u7684\u524d \\(n\\) \u9879 - \\(\\mathcal O(n)\\)\u3002</li> <li>\u6c42\u6570\u8bba\u51fd\u6570 \\(f\\) \u4e0e \\(g\\) \u7684 \\(\\gcd\\) \u5377\u79ef\u4e0e \\(\\operatorname{lcm}\\) \u5377\u79ef\u3002</li> <li>\u6574\u9664\u5206\u5757 - \\(\\mathcal O(\\sqrt n)\\)\u3002</li> <li>\u6c42\u79ef\u6027\u51fd\u6570\u7684\u7b2c \\(n\\) \u9879\u524d\u7f00\u548c - \\(\\mathcal O(n)\\)\uff0c\u4f46\u5728\u4e0b\u4e00\u8282\u4e2d\u4f1a\u63d0\u5230\u66f4\u597d\u7684\u505a\u6cd5\u3002</li> </ol> <p>\u6709\u4e86\u8fd9\u4e9b\u5de5\u5177\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u5f00\u59cb\u5c1d\u8bd5\u89e3\u51b3\u5f88\u591a\u95ee\u9898\u3002</p> <p>\u5728\u5b9e\u8df5\u4e2d\uff0c\u6211\u4eec\u5229\u7528\u548c\u5f0f\u53d8\u6362\u51d1\u51fa\u4e0a\u8ff0\u7684\u5f62\u5f0f\uff0c\u540c\u65f6\u5c1d\u8bd5\u65bd\u4e0a\u8ff0\u65b9\u6cd5\u5373\u53ef\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_9", "title": "\u9644\u6ce8\uff1a\u7279\u6b8a\u51fd\u6570\u7684\u6027\u8d28", "text": "<ol> <li>\\(\\varphi*\\mathbf{I}=\\mathbf{id}\\)\u3002</li> <li>\\(d(\\prod_{i=1}^{n}a_i)=\\displaystyle\\sum_{p_1|a_1}\\displaystyle\\sum_{p_2|a_2}\\cdots\\sum_{p_n|a_n}[\\forall i,j,\\gcd(p_i,p_j)=1]\\)\u3002\u5176\u4e2d \\(d(n)\\) \u662f \\(n\\) \u7684\u56e0\u6570\u4e2a\u6570\u3002</li> </ol>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_10", "title": "\u9644\u6ce8\uff1a\u53cd\u6f14\u4e00\u5b9a\u66f4\u597d\u5417\uff1f", "text": "<p>\u8003\u8651\u6700\u5f00\u59cb\u7684\u7ec3\u4e60\u4e00\uff0c\u5bf9\u4e8e \\(N=M\\) \u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u4e0d\u53cd\u6f14\uff1a</p> \\[ \\begin{aligned} &amp;\\phantom{;=}\\sum_{i=1}^{N}\\sum_{j=1}^{N}[\\gcd(i,j)=1]\\\\ &amp;=2\\times(\\sum_{i=1}^{N}\\sum_{j=1}^{i}[\\gcd(i,j)=1])-1\\\\ &amp;=2\\times(\\sum_{i=1}^{N}\\varphi(i))-1 \\end{aligned} \\] <p>\u4ece\u800c\u9884\u5904\u7406\u540e\u53ef\u4ee5 \\(\\mathcal O(1)\\) \u56de\u7b54\u8be2\u95ee\uff0c\u800c\u4e0d\u7528\u518d\u6b21\u6574\u9664\u5206\u5757\u3002\u7ecf\u8fc7\u4e00\u4e9b\u8ba8\u8bba\uff0c\u8fd9\u540c\u6837\u53ef\u4ee5\u5904\u7406 \\(N\\ge M\\) \u7684\u60c5\u51b5\u3002\u6240\u4ee5\u4e00\u5b9a\u8981\u5728\u5145\u5206\u5206\u6790\u6027\u8d28\u540e\u518d\u8003\u8651\u53cd\u6f14\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#_11", "title": "\u7ec3\u4e60", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#1-p5221-product", "title": "\u7ec3\u4e60 1 / P5221. Product", "text": "<p>\u7ed9\u4f60\u4e00\u4e2a\u6570 \\(n\\)\uff0c\u6c42\uff1a</p> \\[ \\prod_{i=1}^{n}\\prod_{j=1}^{n}\\frac{\\operatorname{lcm}(i,j)}{\\gcd(i,j)}\\pmod {104857601} \\] <p>\\(1\\le n\\le 10^6\\)\uff0c\\(104857601\\) \u662f\u4e00\u4e2a\u8d28\u6570\u3002\u539f\u672c\u7684\u65f6\u9650\u4e3a \\(200\\text{ms}\\)\uff0c\u7a7a\u95f4\u9650\u5236\u4e3a \\(16\\text{MB}\\)\u3002</p> Solution \\[ \\begin{aligned} \\prod_{i=1}^{n}\\prod_{i=1}^{n}\\frac{\\operatorname{lcm}(i,j)}{\\gcd(i,j)} &amp;= \\prod_{i=1}^{n}\\prod_{i=1}^{n}\\frac{ij}{\\gcd^2(i,j)}\\\\ &amp;= \\frac{\\prod_{i=1}^{n}i^n\\prod_{j=1}^{n}j}{\\gcd^2(i,j)}\\\\ &amp;= \\frac{(n!)^{2n}}{\\gcd^2(i,j)}\\\\ \\end{aligned} \\] <p>\u4e0a\u9762\u7684\u90e8\u5206\u662f\u5e73\u51e1\u7684\uff0c\u63a5\u4e0b\u6765\u5904\u7406\u4e58\u79ef</p> \\[ \\prod_{i=1}^{n}\\prod_{j=1}^{n} \\gcd(i,j) \\] <p>\u7ecf\u5178\u5730\uff0c\u679a\u4e3e \\(\\gcd\\) \u6709</p> \\[ \\prod_{d=1}^{n}d^{\\sum_{i=1}^{n}\\sum_{j=1}^{n}[\\gcd(i,j)=d]} \\] <p>\u90a3\u4e48\u8ba8\u8bba\u6307\u6570\u5c31\u597d\u4e86\uff0c\u6211\u4eec\u8981\u5bf9 \\(1\\sim N\\) \u5185\u7684\u6bcf\u4e2a \\(d\\) \u6c42\u51fa</p> \\[ \\sum_{i=1}^{n}\\sum_{j=1}^{n}[\\gcd(i,j)=d] \\] <p>\u76f4\u63a5\u5957\u7528 Problem B \u7684\u505a\u6cd5\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a \\(\\mathcal O(n\\sqrt n)\\) \u7684\u505a\u6cd5\uff0c\u7528 \\(\\sum_{i=1}^{n}2\\varphi(n)-\\epsilon(n)\\) \u6765\u6c42\u5c31\u76f4\u63a5\u7ebf\u6027\u4e86\uff0c\u4f46\u8fd9\u4f1a\u88ab\u5361\u7a7a\u95f4\u3002\u6211\u4eec\u5feb\u8fdb\u5230 Problem B \u6700\u540e\u7684\u5f0f\u5b50</p> \\[ \\sum_{k=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(k)\\left\\lfloor\\frac{n}{k}\\right\\rfloor^{2} \\] <p>\u6211\u4eec\u8981\u5bf9\u6bcf\u4e2a \\(d\\) \u6c42\u4e00\u6b21\uff0c\u6240\u4ee5\u8fd9\u662f\u4e8c\u91cd\u6574\u9664\u5206\u5757\uff0c\u8fd9\u90e8\u5206\u590d\u6742\u5ea6\u662f \\(\\mathcal O(n^{3/4})\\)\u3002\u975e\u5e38\u597d\u7684\u4e00\u70b9\u662f\uff0c\\(\\mu(n)\\) \u7684\u524d\u7f00\u548c\u975e\u5e38\u5c0f\uff0c\u53ef\u4ee5\u7528 <code>int16_t</code> \u5b58\uff0c\u8fd9\u6837\u7a7a\u95f4\u5c31\u591f\u4e86\u3002</p> <p>\u56de\u5230\u539f\u6765\u7684\u5f0f\u5b50\uff0c\u73b0\u5728\u53d8\u6210\u4e86</p> \\[ \\prod_{d=1}^{n}d^{\\sum_{k=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(k)\\left\\lfloor\\frac{n}{k}\\right\\rfloor^{2}} \\] <p>\u5bf9\u4e8e \\(\\lfloor\\frac{n}{d}\\rfloor\\) \u76f8\u540c\u7684\u6bcf\u4e00\u6bb5\uff0c\u4e5f\u5c31\u662f\u6307\u6570\u76f8\u540c\u7684\u6bcf\u4e00\u6bb5\uff0c\u5e95\u6570\u8d21\u732e\u662f</p> \\[ \\frac{\\operatorname{segr}(n,d)!}{(\\operatorname{segl}(n,d)-1)!} \\] <p>\u56e0\u4e3a\u540c\u65f6\u9884\u5904\u7406\u9636\u4e58\u548c\u9636\u4e58\u9006\u4e5f\u4f1a\u88ab\u5361\u7a7a\u95f4\uff0c\u6240\u4ee5\u8fb9\u6574\u9664\u5206\u5757\uff0c\u8fb9\u53cc\u6307\u9488\u5373\u53ef \\(\\mathcal O(n)\\) \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u4ece \\(1\\) \u5230 \\(n\\) \u679a\u4e3e \\(d\\)\uff0c\u6574\u9664\u5206\u5757\u7684\u533a\u95f4\u7aef\u70b9\u662f\u4ece \\(1\\) \u5230 \\(n\\) \u9012\u589e\u7684\u3002\u60f3\u8981\u7ebf\u6027\u5c31\u8981\u9884\u5904\u7406\u7684\u662f\u9636\u4e58\u9006\uff0c\u9636\u4e58\u8fb9\u8d70\u8fb9\u7b97\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-3/#2-p2257-yygcd", "title": "\u7ec3\u4e60 2 / P2257. YY\u7684GCD", "text": "<p>\u7ed9\u4f60 \\(n,m\\)\uff0c\u6c42</p> \\[ \\sum_{i=1}^{n}\\sum_{j=1}^{m}[\\gcd(i,j)\\in \\mathbb P] \\] <p>\u5176\u4e2d \\(\\mathbb P\\) \u662f\u7d20\u6570\u96c6\u5408\uff0c\\(T\\) \u7ec4\u6d4b\u8bd5\u6570\u636e\u3002</p> <p>\\(T\\le 10^4\\)\uff0c\\(1\\le n,m\\le 10^7\\)</p> Solution \\[ \\begin{aligned} \\sum_{i=1}^{n}\\sum_{j=1}^{m}[\\gcd(i,j)\\in\\mathbb P] &amp;= \\sum_{i=1}^{n}\\sum_{j=1}[\\gcd(i,j)\\in\\mathbb P]\\\\ &amp;= \\end{aligned} \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/", "title": "\u4e9a\u7ebf\u6027\u7b5b\u6cd5\u521d\u6b65", "text": "<p>\u6211\u4eec\u5728\u672c\u8282\u4e2d\u7ea6\u5b9a\uff0c\u7b26\u53f7 \\(\\operatorname{S}_f(n)\\) \u8868\u793a\u6570\u8bba\u51fd\u6570 \\(f\\) \u7684\u524d \\(n\\) \u9879\u548c\uff0c\u5373\uff1a</p> \\[ \\newcommand\\fl[1]{\\left\\lfloor#1\\right\\rfloor} \\sum_{i=1}^{n}f(i) \\] <p>\u6574\u9664\u5206\u5757\u4e3a\u6211\u4eec\u63ed\u793a\u4e86\u6574\u4e2a\u5e8f\u5217\u4ec5\u4ec5\u53ea\u6709 \\(\\mathcal O(\\sqrt n)\\) \u4e2a\u4f4d\u7f6e\u662f\u975e\u5e73\u51e1\u7684\uff0c\u90a3\u6211\u4eec\u7684\u524d\u7f00\u548c\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u505a\u5230\u66f4\u597d\u5462\uff1f</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/#_2", "title": "\u675c\u6559\u7b5b", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/#_3", "title": "\u5757\u7b5b", "text": "<p>\u6574\u9664\u5206\u5757\u91cc\uff0c\u6211\u4eec\u7ecf\u5e38\u89c1\u5230\u8fd9\u6837\u7684\u5f0f\u5b50</p> \\[ \\operatorname{S}_f(\\lfloor\\frac{n}{k}\\rfloor) \\] <p>\u6211\u4eec\u79f0 \\(f\\) \u5173\u4e8e \\(n\\) \u7684\u5757\u7b5b\u662f\u5bf9\u4e8e\u6240\u6709 \\(k\\) \u6ee1\u8db3 \\(1\\le k\\le n\\) \u65f6\uff0c\\(\\operatorname{S}_f(\\lfloor\\frac{n}{k}\\rfloor)\\) \u7684\u503c\u7ec4\u6210\u7684\u96c6\u5408\u3002\u4e5f\u5c31\u662f\u6574\u9664\u5206\u5757\u7684\u65f6\u5019\u6211\u4eec\u8981\u7684\u503c\u3002</p> <p>\u6574\u9664\u7684\u96c6\u5408\u6709\u7740\u5982\u4e0b\u7684\u6027\u8d28\uff1a</p> <ul> <li> <p>\u6027\u8d28 1: \u8bbe \\(R(n)=\\{\\lfloor\\frac{n}{k}\\rfloor: 1\\le k\\le n\\}\\)\uff0c\u90a3\u4e48\u82e5 \\(m\\in R(n)\\)\uff0c\u5219 \\(R(m)\\subseteq R(n)\\)\u3002</p> <p>\u8fd9\u662f\u56e0\u4e3a \\(\\lfloor\\frac{\\lfloor\\frac{n}{i}\\rfloor}{j}\\rfloor=\\lfloor\\frac{n}{ij}\\rfloor\\)\u3002\u4e5f\u5c31\u662f\uff0c\u60f3\u8981\u5f97\u5230\\(f\\) \u5173\u4e8e \\(n\\) \u7684\u5757\u7b5b\uff0c\u5f97\u5230 \\(kn\\) \u7684\u5373\u53ef\u3002</p> </li> <li> <p>\u6027\u8d28 2: \u8bbe \\(\\{r: \\lfloor\\frac{n}{r}\\rfloor\\neq \\lfloor\\frac{n}{r+1}\\rfloor\\}\\)\uff0c\u90a3\u4e48\u8be5\u96c6\u5408\u5373\u4e3a \\(\\{\\lfloor\\frac{n}{k}\\rfloor: 1\\le k\\le n\\}\\)\u3002</p> <p>\u4e5f\u5c31\u662f\u6574\u9664\u5206\u5757\u7684\u8fb9\u754c\u6070\u597d\u662f \\(\\{\\lfloor\\frac{n}{k}\\rfloor:1\\le k\\le n\\}\\)\uff0c\u4f7f\u7528\u6027\u8d28 1 \u5373\u53ef\u8bc1\u660e\u3002</p> </li> </ul>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/#_4", "title": "\u675c\u6559\u7b5b\u7684\u4e24\u4e2a\u5f62\u5f0f", "text": "<ul> <li> <p>\u4e58\u79ef\u5f0f\uff1a</p> <p>\u6709\u6570\u8bba\u51fd\u6570\uff08\u4e0d\u5fc5\u662f\u79ef\u6027\uff09 \\(f,g,h\\) \u6ee1\u8db3 \\(h=f*g\\)\uff0c\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 \\(f,g\\) \u7684\u5757\u7b5b\u7ed3\u679c\uff0c\u73b0\u5728\u8981\u6c42 \\(h\\) \u7684\u5757\u7b5b\u7ed3\u679c\u3002</p> \\[ \\begin{aligned} \\operatorname{S}_h(n)&amp;=\\sum_{i=1}^{n}\\sum_{d\\mid i}f(d)g\\qty(\\frac{i}{d})\\\\ &amp;=\\sum_{d=1}^{n}f(d)\\sum_{d\\mid i,i\\le n}^{}g\\qty(\\frac{i}{d})\\\\ &amp;=\\sum_{d=1}^{n}f(d)\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}g(i)\\\\ &amp;=\\sum_{d=1}^{n}f(d)\\operatorname{S}_g\\qty(\\left\\lfloor\\frac{n}{d}\\right\\rfloor) \\end{aligned} \\] <p>\u5bf9\u6bcf\u4e2a \\(\\lfloor\\frac{n}{d}\\rfloor\\) \u6c42\u4e00\u6b21\u5c31\u662f\u7c7b\u4f3c\u4e8c\u91cd\u6574\u9664\u5206\u5757\u7684\u5f62\u5f0f\u4e86\uff0c\u5373\u590d\u6742\u5ea6\u662f \\(\\mathcal O(n^{3/4})\\)\u3002</p> <p>\u5982\u679c \\(f,g\\) \u90fd\u662f\u79ef\u6027\u51fd\u6570\uff0c\u90a3 \\(h\\) \u4e5f\u662f\u79ef\u6027\u51fd\u6570\u3002\u901a\u8fc7\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u524d \\(\\mathcal O(n^{2/3})\\) \u9879\u7684\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u628a\u590d\u6742\u5ea6\u964d\u4f4e\u81f3 \\(\\mathcal O(n^{2/3})\\)\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\\(f\\) \u5e76\u4e0d\u4e00\u5b9a\u9700\u8981\u975e\u5e38\u5bb9\u6613\u8ba1\u7b97\u524d\u7f00\u548c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5b83\u7684\u5757\u7b5b\u7ed3\u679c\uff08\u524d\u8005\u663e\u7136\u9690\u542b\u4e86\u540e\u8005\uff09\u3002\u56e0\u4e3a\u6211\u4eec\u5bf9\u4e8e\u67d0\u4e00\u9879 \\(\\operatorname{S}_g(\\lfloor\\frac{n}{d}\\rfloor)\\)\uff0c\u8fd0\u7528\u6027\u8d28 2\uff0c\u6240\u9700\u8981\u7684 \\(\\operatorname{S}_f(d)\\) \u7684 \\(d\\) \u7684\u503c\u5b9e\u9645\u4e0a\u6709 \\(d\\in\\{r: \\lfloor\\frac{n}{r}\\rfloor\\neq \\lfloor\\frac{n}{r+1}\\rfloor\\}\\)\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u53ea\u9700\u8981\u5b83\u7684\u5757\u7b5b\u5c31\u591f\u4e86\u3002</p> </li> <li> <p>\u9664\u5f0f\uff1a</p> <p>\u6709\u6570\u8bba\u51fd\u6570\uff08\u4e0d\u5fc5\u662f\u79ef\u6027\uff09 \\(f,g,h\\) \u6ee1\u8db3 \\(h=f*g\\)\uff0c\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 \\(g\\) \u7684\u5757\u7b5b\u7ed3\u679c\uff0c\\(h\\) \u662f\u4e00\u4e2a\u5bb9\u6613\u6c42\u5355\u9879\u524d\u7f00\u548c\u7684\u51fd\u6570\uff0c\u73b0\u5728\u8981\u6c42 \\(f\\) \u7684\u5757\u7b5b\u7ed3\u679c\u3002</p> <p>\u6839\u636e\u4e0a\u9762\u7684\u63a8\u5bfc\u6211\u4eec\u5df2\u7ecf\u77e5\u9053</p> \\[ \\operatorname{S}_h(n)=\\sum_{d=1}^{n}g(d)\\operatorname{S}_f(\\left\\lfloor\\frac{n}{d}\\right\\rfloor) \\] <p>\u6211\u4eec\u8981\u6c42 \\(\\operatorname{S}_f(n)\\)\uff0c\u6240\u4ee5\u5355\u72ec\u628a\u8fd9\u4e00\u9879\u62ff\u51fa\u6765</p> \\[ \\begin{aligned} \\operatorname{S}_h(n)&amp;=g(1)\\operatorname{S}_f(n)+\\sum_{d=2}^{n}g(d)\\operatorname{S}_f(\\left\\lfloor\\frac{n}{d}\\right\\rfloor)\\\\ g(1)\\operatorname{S}_f(n)&amp;=\\operatorname{S}_h(n)-\\sum_{d=2}^{n}g(d)\\operatorname{S}_f(\\left\\lfloor\\frac{n}{d}\\right\\rfloor) \\end{aligned} \\] <p>\u8fd0\u7528\u6027\u8d28 \\(1\\)\uff0c\u6211\u4eec\u8bb0\u5fc6\u5316\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u5373\u53ef\u5728 \\(\\mathcal O(n^{2/3})\\) \u7684\u65f6\u95f4\u5185\u6c42\u51fa \\(f\\) \u7684\u5757\u7b5b\u7ed3\u679c\u3002</p> </li> </ul> <p>\u8fd9\u4e24\u4e2a\u5f62\u5f0f\u7684\u590d\u6742\u5ea6\u8bc1\u660e\u6ca1\u6709\u4e0d\u540c\uff0c\u90fd\u53ef\u4ee5\u76f4\u63a5\u7528 OI-wiki \u4e0a\u7684\u8fd9\u4e2a\u63a8\u5bfc\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff0c\u5982\u679c\u6b32\u6c42 \\(f\\) \u7684\u5757\u7b5b\uff0c\u53ef\u4ee5\u8bd5\u7740\u6784\u9020\u4e00\u4e2a\u6613\u6c42\u5757\u7b5b\u7684\u51fd\u6570 \\(g\\)\uff0c\u4f7f\u5f97 \\(f/g\\) \u6613\u6c42\u5757\u7b5b\uff0c\u6216 \\(f*g\\) \u6613\u6c42\u524d\u7f00\u548c\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/#_5", "title": "\u72c4\u5229\u514b\u96f7\u53cc\u66f2\u7ebf\u6cd5", "text": "<p>\u7ed9\u51fa \\(f,g\\) \u7684\u5757\u7b5b\uff0c\u8bbe \\(h=f*g\\)\uff0c\u6c42 \\(\\operatorname{S}_{h}(n)\\)\u3002</p> <p>\u663e\u7136\uff0c\u6211\u4eec\u77e5\u9053</p> \\[ \\operatorname{S}_h(n)=\\sum_{xy\\le n}f(x)g(y) \\] <p>\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u4e1c\u897f\u5199\u6210</p> \\[ \\operatorname{S}_h(n)=\\sum_{x=1}^{n}f(x)\\operatorname{S}_g\\qty(\\Big\\lfloor\\frac{n}{x}\\Big\\rfloor) \\] <p>\u5bf9\u4e8e \\(x&gt;\\lfloor\\sqrt n\\rfloor\\) \u7684\u60c5\u51b5\uff0c\u80fd\u8d21\u732e\u5230 \\(f(x)\\) \u7684 \\(g(y)\\) \u5c31\u80af\u5b9a\u6709 \\(y\\le \\lfloor\\sqrt n\\rfloor\\) \u4e86\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u7684 \\(f,g\\) \u90fd\u53ea\u679a\u4e3e\u5230\u524d \\(\\lfloor\\sqrt n\\rfloor\\)\uff0c\u5c31\u80af\u5b9a\u80fd\u8986\u76d6\u6240\u6709\u8981\u6c42\u7684\u4f4d\u7f6e\u7684\u503c\u4e86\u3002</p> \\[ \\sum_{x=1}^{\\fl{\\sqrt{n}}}f(x)\\operatorname{S}_g\\qty(\\fl{\\frac{n}{x}})+\\sum_{x=1}^{\\fl{\\sqrt{n}}}g(x)\\operatorname{S}_f\\qty(\\fl{\\frac{n}{x}}) \\] <p>\u4f46\u662f\u8fd9\u6837\u5728\u4e24\u8005\u90fd \\(\\le \\lfloor\\sqrt n\\rfloor\\) \u7684\u65f6\u5019\u5c31\u4f1a\u7b97\u91cd\uff0c\u6240\u4ee5\u6700\u7ec8\u7684\u5f0f\u5b50\u5c31\u662f</p> \\[ \\operatorname{S}_h(n)=\\sum_{x=1}^{\\fl{\\sqrt{n}}}f(x)\\operatorname{S}_g\\qty(\\fl{\\frac{n}{x}})+\\sum_{x=1}^{\\fl{\\sqrt{n}}}g(x)\\operatorname{S}_f\\qty(\\fl{\\frac{n}{x}})-\\operatorname{S}_f(\\fl{\\sqrt{n}})\\operatorname{S}_g(\\fl{\\sqrt{n}}) \\] <p>\u501f\u52a9 Command_Block \u77e5\u4e4e\u4e0a\u7684\u56fe</p> <p></p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/#pn", "title": "PN \u7b5b", "text": "<p>\u53ef\u4ee5\u8bf4\u662f\u675c\u6559\u7b5b\uff08\u4e58\u79ef\u5f0f\uff09\u7684\u4e00\u4e2a\u6269\u5c55\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/#powerful-number", "title": "Powerful Number", "text": "<p>\u6211\u4eec\u79f0\u4e00\u4e2a\u6b63\u6574\u6570\u662f\u4e00\u4e2a Powerful Number(PN)\uff0c\u5f53\u4e14\u4ec5\u5f53\u5176\u6240\u6709\u8d28\u56e0\u6570\u7684\u6307\u6570\u90fd \\(\\ge 2\\)\uff0c\u7279\u522b\u7684\uff0c\\(1\\) \u662f PN\u3002</p> <p>\u5f15\u7406 1\uff1a</p> <p>\u6240\u6709 PN \u5747\u80fd\u88ab\u5199\u6210\u5f62\u5982 \\(a^2b^3\\) \u7684\u5f62\u5f0f\u3002</p> <p>\u8bc1\u660e\uff1a</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a \\(p^k\\)\uff0c\u5982\u679c \\(k\\) \u662f\u5076\u6570\uff0c\u90a3\u4e48\u628a \\(p^{k/2}\\) \u653e\u5230 \\(a\\) \u91cc\uff0c\u5426\u5219\u628a \\(p\\) \u653e\u5230 \\(b\\) \u91cc\uff0c\\(p^{(k-3)/2}\\) \u653e\u5230 \\(a\\) \u91cc\u3002</p> <p>\u6216\u8005\u66f4\u5f62\u5f0f\u5316\u5730\u8bf4\uff1a</p> <p>$$   a=\\prod p_i^{(k_i-3[k\\bmod 2=1]) / 2}, b=\\prod p_i^{[k_i\\bmod 2 = 1]}   $$</p> <p>\u53e6\u5916\uff0c\u8fd9\u6784\u6210\u4e86\u4e00\u4e2a PN \u5230 \\((a,b)\\) \u7684\u5355\u5c04\uff08\u5e76\u4e0d\u662f\u6240\u6709 \\((a,b)\\) \u90fd\u80fd\u5bf9\u5e94\u4e00\u4e2a PN\uff09\u3002</p> <p>\u8fd9\u770b\u8d77\u6765\u8bf4\u660e PN \u7684\u4e2a\u6570\u4e0d\u4f1a\u592a\u591a</p> <p>\u5b9a\u7406 1\uff1a</p> <p>PN \u7684\u4e2a\u6570\u4e3a \\(\\mathcal O(\\sqrt n)\\) \u4e2a\u3002</p> <p>\u8bc1\u660e\uff1a</p> <p>\u653e\u7f29\u4e00\u4e0b\uff0c\u8ba1\u7b97\u6570\u5bf9 \\((a,b)\\) \u7684\u4e2a\u6570\uff0c\u8fd9\u663e\u7136\u662f   $$   \\sum_{x=1}^{\\sqrt n}\\qty(\\frac{n}{x^2})^{1/3}   $$</p> <p>\u6211\u4eec\u8f6c\u800c\u8ba1\u7b97\u79ef\u5206   $$   \\begin{aligned}   &amp;\\phantom{=}\\int_{1}^{\\sqrt n}\\qty(\\frac{n}{x^2})^{1/3}\\operatorname{d}x\\   \\end{aligned}   $$</p> <p>\u6c42\u4e0d\u5b9a\u79ef\u5206</p> <p>$$   \\begin{aligned}   &amp;\\phantom{=}\\int\\qty(\\frac{n}{x^2})^{1/3}\\operatorname{d}x\\   &amp;=\\sqrt[3]n\\int x^{-2/3}\\operatorname{d}x\\   &amp;=\\sqrt[3]n\\cdot \\frac{1}{\\frac{1}{3}}\\sqrt[3]x+C\\   &amp;=3\\sqrt[3]n\\sqrt[3]x+C   \\end{aligned}   $$</p> <p>\u5b9a\u79ef\u5206\u7684\u7ed3\u679c\u663e\u7136\u662f</p> <p>$$   3\\sqrt n-3\\sqrt[3]n   $$ </p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/#pn_1", "title": "PN \u7b5b", "text": "<p>\u6211\u4eec\u5e0c\u671b\u6c42\u51fa\u79ef\u6027\u51fd\u6570 \\(f(n)\\) \u7684\u5757\u7b5b\uff0cPN \u7b5b\u7684\u60f3\u6cd5\u662f\uff0c\u6784\u9020\u4e00\u4e2a\u79ef\u6027\u51fd\u6570 \\(g\\)\uff0c\u6ee1\u8db3\u5728\u6240\u6709\u8d28\u6570 \\(p\\) \u5904\uff0c\u6709 \\(g(p)=f(p)\\)\uff0c\u7136\u540e\u5229\u7528 PN \u5206\u6790 \\(h=f/g\\) \u7684\u6027\u8d28\uff0c\u6700\u540e\u5229\u7528 \\(f=g*h\\) \u8ba1\u7b97 \\(f\\)\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u6765\u8bd5\u7740\u5206\u6790\u4e00\u4e0b \\(h=f/g\\) \u7684\u6027\u8d28\u3002\u5bf9\u4e8e\u8d28\u6570 \\(p\\)\uff0c\u6211\u4eec\u6709\uff1a $$ f(p)=g(1)h(p)+g(p)h(1) $$ \u90a3\u4e48\u7531\u4e8e \\(g(p)=f(p)\\)\uff0c\u663e\u7136\u53ea\u80fd\u6709 \\(h(p)=0\\)\u3002</p> <p>\u8003\u8651\u7531\u4e8e \\(h\\) \u662f\u79ef\u6027\u7684\uff0c\u90a3\u4e48\u53ea\u80fd\u5728 PN \u5904\u6709\u503c\uff0c\u5176\u4f59\u4f4d\u7f6e\u90fd\u5fc5\u4e3a \\(0\\)\u3002 $$ \\operatorname{S}f(n)=\\sum\\right\\rfloor) $$ \u8fd9\u5c31\u6709\u4e86\u4e00\u4e2a }(n)}h(i)\\operatorname{S}_g\\qty(\\left\\lfloor\\frac{n}{i\\(\\mathcal O(n^{2/3})\\) \u7684\u505a\u6cd5\uff0c\u4f46\u6211\u4eec\u80fd\u505a\u5230 \\(\\mathcal O(n^{3/5})\\)\u3002</p> <p>\u5b9a\u7406 2\uff1a</p> <p>\\(h\\) \u5173\u4e8e \\(n\\) \u7684\u5757\u7b5b\u53ea\u6709 \\(\\mathcal O(n^{1/3})\\) \u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u503c\u3002</p> <p>\u8bc1\u660e\uff1a</p> <p>\u8003\u8651 \\(\\operatorname{S}_h\\qty(\\left\\lfloor\\frac{n}{x}\\right\\rfloor)\\)\uff0c\u82e5 \\(x\\le \\mathcal n^{1/3}\\)\uff0c\u90a3\u4e48\u663e\u7136\u5c31\u53ea\u6709 \\(\\mathcal O(n^{1/3})\\) \u4e2a\u503c\u3002</p> <p>\u82e5 \\(x&gt; n^{1/3}\\)\uff0c\u90a3\u4e48 \\(\\left\\lfloor\\frac{n}{x}\\right\\rfloor\\le n^{2/3}\\)\uff0c\u54ea\u6015\u53d6\u904d \\(1\\sim n^{2/3}\\) \u4e5f\u53ea\u6709 \\(\\mathcal O(\\sqrt{n^{2/3}})=\\mathcal O(n^{1/3})\\) \u4e2a\u6709\u503c\u7684 \\(h\\)\u3002</p> <p>\u90a3\u4e48\u5904\u7406\u5355\u70b9\u7684 $$ \\operatorname{S}f(n)=\\sum\\right\\rfloor) $$ \u5355\u6b21\u590d\u6742\u5ea6\u53ef\u4ee5\u964d\u81f3 }^{n}g(i)\\operatorname{S}_h\\qty(\\left\\lfloor\\frac{n}{i\\(\\mathcal O(n^{1/3})\\)\u3002</p> <p>\u7c7b\u4f3c\u675c\u6559\u7b5b\u90a3\u6837\u8fdb\u884c\u590d\u6742\u5ea6\u5e73\u8861\uff0c\u6211\u4eec\u5148\u7ebf\u6027\u7b5b\u81f3 \\(t\\)\u3002 $$ \\mathcal O\\qty(t+\\sum_{i=1}^{n/t}\\qty(n/i)^{1/3}) $$ \u53d6 \\(t=n^{3/5}\\)\uff0c\u5e73\u8861\u5f97\u590d\u6742\u5ea6\u4e3a \\(\\mathcal O(n^{3/5})\\)\u3002</p>"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-4/#min25", "title": "Min25 \u7b5b", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-5/", "title": "\u63a8\u5bfc\u7684\u5de5\u5177", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-5/#_2", "title": "\u8d1d\u5c14\u7ea7\u6570", "text": "<p>\u6784\u9020\u675c\u6559\u7b5b\u6709\u70b9\u592a\u96be\u4e86\uff01\u8003\u8651\u7c7b\u4f3c\u591a\u9879\u5f0f\u8ba1\u6570\u90a3\u6837\uff0c\u7528\u4e00\u4e2a\u65e0\u7a77\u7ea7\u6570\u6765\u523b\u753b\u6570\u8bba\u51fd\u6570\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u3002</p> <p>\u6211\u4eec\u8bf4\uff0c\u79ef\u6027\u51fd\u6570 \\(f\\) \u5bf9\u4e8e\u8d28\u6570 \\(p\\) \u7684\u8d1d\u5c14\u7ea7\u6570\u5b9a\u4e49\u4e3a</p> \\[ F_p(z)=\\sum_{k\\ge 0}f(p^k)z^k \\] <p>\u663e\u7136\u5bf9\u6bcf\u4e2a\u8d28\u6570 \\(p\\)\uff0c\u8fd9\u4e2a\u591a\u9879\u5f0f\u5728\u5e38\u8bc6\u6570\u636e\u8303\u56f4\u4e0b\u90fd\u53ea\u6709 \\(\\mathcal O(\\log n)\\) \u9879\uff0c\u5bf9\u5176\u76f4\u63a5\u8fdb\u884c\u66b4\u529b\u7684\u591a\u9879\u5f0f\u64cd\u4f5c\u662f\u53ef\u884c\u7684\u3002\u800c\u4e24\u4e2a\u51fd\u6570\u7684\u8d1d\u5c14\u7ea7\u6570\u7684\u4e58\u6cd5\u5c31\u5bf9\u5e94\u6570\u8bba\u51fd\u6570\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u3002</p> <p>\u90a3\u4e48\u5f88\u5feb\u6211\u4eec\u5c31\u80fd\u5199\u51fa\u4e00\u6279\u5e38\u89c1\u6570\u8bba\u51fd\u6570\u7684\u8d1d\u5c14\u7ea7\u6570</p> \\[ \\begin{aligned} &amp;\\epsilon(n) \\longrightarrow E_p(z)=1 \\\\ &amp;\\mathbf{I}(n)\\longrightarrow I_p(z)=\\frac{1}{1-z}\\\\ &amp;\\mu(n)\\longrightarrow \\mathrm{M}_p(z)=1-z\\\\ &amp;\\mu^2(n)\\longrightarrow \\operatorname{M}^2_p(z)=1+z\\\\ &amp;\\varphi(n)\\longrightarrow \\Phi_p(n)=1+\\qty(1-\\frac{1}{p})\\sum_{i\\ge 1}p^iz^i=\\frac{1-z}{1-pz}\\\\ &amp;\\operatorname{id}^k(n)\\longrightarrow \\operatorname{ID}^k(n)=\\sum_{i\\ge 0}p^{ik}z^i=\\frac{1}{1-p^kz}\\\\ &amp;\\operatorname{} \\end{aligned} \\]"}, {"location": "Algorithms/NumberTheory/Number_Theory_2-5/#dgf", "title": "\u72c4\u5229\u514b\u96f7\u751f\u6210\u51fd\u6570\uff08DGF\uff09", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-6/", "title": "\u9644\u6ce8\u4e0e\u62fe\u9057", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-6/#_2", "title": "\u62fe\u9057", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_2-6/#_3", "title": "\u52a0\u6027\u51fd\u6570", "text": ""}, {"location": "Algorithms/NumberTheory/Number_Theory_3/", "title": "\\(\\mathbb Z/p\\mathbb Z\\) \u7684\u7ed3\u6784", "text": "<p>\u6211\u4eec\u5bf9\u4e8e\u5b9e\u6570\u57df \\(\\mathbb R\\) \u7684\u7ed3\u6784\u5df2\u7ecf\u6709\u4e86\u76f8\u5f53\u7a0b\u5ea6\u7684\u4e86\u89e3\uff0c\u8fd9\u4e9b\u7ed3\u6784\u80fd\u5426\u88ab\u8fc1\u79fb\u5230 \\(\\mathbb Z/p\\mathbb Z\\) \u4e2d\u6765\uff1f</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/", "title": "DP 1", "text": "<p>SMAWK, Wilber, Eppstein \u548c\u5176\u4ed6\u7684\u795e\u79d8\u4e1c\u897f\u5927\u6982\u662f\u4e0d\u4f1a\u8865\u7684\u3002</p> <p>\u4e0b\u9762\u8bb2\u7684\u90fd\u662f\u6700\u5c0f\u5316\uff0c\u8981\u6700\u5927\u5316\u5c31\u628a\u4e0d\u7b49\u53f7\u53cd\u5411\u4e00\u4e0b\u3002</p> <p>\u7ea6\u5b9a\u4e00\u4e0b\uff0c\\(\\operatorname{argmin}f(x)\\) \u6307\u7684\u662f\u4f7f \\(f(x)\\) \u53d6\u5230\u6700\u5c0f\u503c\u7684 \\(x\\)\uff0c\\(\\operatorname{argmax}f(x)\\) \u540c\u7406\u3002</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/#_1", "title": "\u51b3\u7b56\u5355\u8c03\u6027", "text": "<p>\u987e\u540d\u601d\u4e49\uff0c\u5176\u5b9e\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u8f6c\u79fb\u65b9\u7a0b</p> \\[ f_i=\\min_{j&lt;i}f_j+w(j,i) \\] <p>\u6211\u4eec\u6709 \\(\\operatorname{argmin}f(i)\\) \u5173\u4e8e \\(i\\) \u5355\u8c03\u4e0d\u964d\u3002</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/#_2", "title": "\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f", "text": "<p>\u8003\u8651\u4e00\u4e2a\u4e8c\u5143\u51fd\u6570 \\(w(l,r)\\)\uff0c\u5982\u679c\u8fd9\u4e2a\u51fd\u6570\u6ee1\u8db3\u5bf9\u4e8e\u4efb\u610f\u7684 \\(p_1\\le p_2\\le p_3\\le p_4\\) \u5747\u6709</p> \\[ w(p_1,p_3)+w(p_2, p_4)\\le w(p_1,p_4)+w(p_2,p_3) \\] <p>\u4e5f\u5c31\u662f\u4ea4\u53c9\u4f18\u4e8e\u5305\u542b\uff0c\u6211\u4eec\u5c31\u79f0\u5b83\u662f\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u7684\u3002</p> <p>\u5728\u8bc1\u660e\u7684\u65f6\u5019\u6211\u4eec\u901a\u5e38\u4f7f\u7528\u5b83\u7684\u53e6\u4e00\u4e2a\u5f62\u5f0f</p> \\[ w(l-1,r)+w(l,r+1)\\le w(l, r)+w(l-1,r+1) \\] <p>\u7aef\u70b9\u53ea\u79fb\u52a8\u4e86 \\(1\\)\uff0c\u8d21\u732e\u66f4\u597d\u7b97\u4e00\u70b9\u3002</p> <p>\u5982\u679c\u4ee3\u4ef7\u51fd\u6570\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff0c\u90a3\u4e48\u5b83\u5c31\u4e00\u5b9a\u6ee1\u8db3\u51b3\u7b56\u5355\u8c03\u6027\u3002</p> <p>\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff0c\u628a\u4e0a\u9762\u7684\u5f0f\u5b50\u6362\u6210</p> \\[ w(l,r)-w(l-1,r)\\ge w(l,r+1)-w(l-1,r+1) \\] <p>\u6211\u4eec\u628a\u53f3\u8fb9\u79f0\u4e3a\u51b3\u7b56\u4f4d\u7f6e\uff0c\u5de6\u8fb9\u79f0\u4e3a\u51b3\u7b56\u70b9\u3002\u8003\u8651\u51b3\u7b56\u4f4d\u7f6e\u7684\u53d8\u52a8\u3002</p> <p>\u6b64\u65f6\uff0c\u51b3\u7b56\u70b9\u9760\u53f3\u7684\uff0c\u5411\u6700\u503c\u4fa7\u7684\u589e\u957f\u901f\u5ea6\u4e0d\u6162\u4e8e\u9760\u5de6\u7684\u3002</p> <p>\u6240\u4ee5\u9760\u5de6\u7684\u4e00\u65e6\u88ab\u9760\u53f3\u7684\u51fb\u8d25\uff0c\u90a3\u65e2\u7136\u589e\u957f\u901f\u5ea6\u6162\u4e8e\u9760\u53f3\u7684\uff0c\u90a3\u5c31\u4e0d\u4f1a\u518d\u80dc\u8fc7\u9760\u53f3\u7684\uff0c\u4ece\u800c\u6709\u51b3\u7b56\u70b9\u5355\u8c03\u3002</p> <p>\u4e8b\u5b9e\u4e0a\u6839\u636e LCA \u7684 PPT\uff0c\u6761\u4ef6\u7684\u5f3a\u5ea6\u5e94\u8be5\u662f\u8fd9\u6837\u4ece\u5f31\u5230\u5f3a\u6392\u7684\uff1a</p> <ol> <li>\u51b3\u7b56\u5355\u8c03\u6027\uff1a\u51b3\u7b56\u70b9\u5173\u4e8e\u51b3\u7b56\u4f4d\u7f6e\u5355\u8c03</li> <li>\u534a\u5b8c\u5168\u5355\u8c03\u6027\uff1a\u5bf9\u4e8e\u4efb\u610f\u51b3\u7b56\u70b9 \\(x,y\\)\uff0c\u603b\u5b58\u5728\u4e00\u4e2a\u51b3\u7b56\u4f4d\u7f6e \\(p\\)\uff08\u53ef\u4ee5\u662f\u6b63\u8d1f\u65e0\u7a77\uff09\uff0c\u4f7f\u5f97 \\(p\\) \u7684\u4e00\u4fa7\u7684\u51b3\u7b56\u4f4d\u7f6e\uff0c\u7528 \\(x\\) \u66f4\u4f18\uff0c\u53e6\u4e00\u4fa7\u7684\u51b3\u7b56\u4f4d\u7f6e\uff0c\u7528 \\(y\\) \u66f4\u4f18\u3002</li> <li>\u5b8c\u5168\u5355\u8c03\u6027\uff1a\u53ea\u8003\u8651\u4efb\u610f\u4e24\u4e2a\u51b3\u7b56\u548c\u4efb\u610f\u4e24\u4e2a\u4f4d\u7f6e\uff0c\u6700\u4f18\u51b3\u7b56\u70b9\u90fd\u5173\u4e8e\u51b3\u7b56\u4f4d\u7f6e\u662f\u5355\u8c03\u7684\u3002</li> <li>\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f</li> <li>\u53cc\u7ebf\u6027\uff1a\\(w(i,j)=A_iB_j+C_i+D_j\\)\uff0c\u5176\u4e2d\u8fd9\u56db\u4e2a\u90fd\u662f\u56fa\u5b9a\u7684\uff08\u659c\u7387\u4f18\u5316\uff09\u3002</li> </ol> <p>\u5176\u4e2d\u6bcf\u4e2a\u90fd\u5305\u542b\u4e0a\u4e00\u4e2a\u3002</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/#_3", "title": "\u5206\u6cbb / \u6574\u4f53\u4e8c\u5206", "text": "<p>\u4f60\u8bf4\u5f97\u5bf9\uff0c\u4f46\u4e0a\u9762\u7684\u4e1c\u897f\u6709\u4ec0\u4e48\u7528\uff1f</p> <p>\u4ece\u7b80\u5355\u7684\u60c5\u51b5\u5f00\u59cb\uff0c\u5047\u8bbe\u6211\u4eec\u8981\u89e3\u51b3\u4e00\u4e2a\u79bb\u7ebf\u7684\u95ee\u9898\u3002\u4e5f\u5c31\u662f \\(w(i,j)\\) \u7684\u8ba1\u7b97\u548c \\(f(i)\\) \u6ca1\u6709\u5173\u7cfb\u3002\u4e5f\u5c31\u662f</p> \\[ f(i)=\\min_{j=1}^{i}g(j)+w(i,j) \\] <p>\u5176\u4e2d \\(g\\) \u7ed9\u5b9a\u3002</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/#_4", "title": "\u6240\u4ee5\u548b\u505a\u6765\u7740", "text": "<p>\u56e0\u4e3a\u6709\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9\u51b3\u7b56\u4f4d\u7f6e \\(i\\) \u627e\u5230\u5b83\u7684\u6700\u4f18\u51b3\u7b56\u70b9 \\(j\\)\uff0c\u90a3\u4e48 \\([1,i)\\) \u7684\u6700\u4f18\u51b3\u7b56\u70b9\u6240\u5728\u7684\u8303\u56f4\u662f \\([1,j]\\)\uff0c\\((i,n]\\) \u7684\u6700\u4f18\u51b3\u7b56\u70b9\u6240\u5728\u7684\u8303\u56f4\u662f \\([j,n]\\)\u3002\u5229\u7528\u8fd9\u4e2a\u6027\u8d28\uff0c\u53ef\u4ee5\u6574\u4f53\u4e8c\u5206\u3002</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/#loj2035-sdoi2016", "title": "\u4f8b\u9898\u4e00 / LOJ#2035. [SDOI2016] \u5f81\u9014", "text": "<p>\u7b80\u8981\u9898\u610f\u662f\u628a\u5e8f\u5217\u5212\u5206\u6210 \\(m\\) \u6bb5\uff0c\u6bcf\u6bb5\u548c\u7684\u65b9\u5dee\u6700\u5c0f\u3002</p> <p>\u5148\u8981\u523b\u753b\u8fd9\u4e2a \\(v\\times m^2\\)\uff0c\u6211\u4eec\u77e5\u9053\u65b9\u5dee\u7684\u5b9a\u4e49\u5f0f\u662f</p> \\[ v=\\sum_{i=1}^{m}\\frac{(x_i-\\overline{x})^2}{k} \\] <p>\u8fd9\u91cc\u7684 \\(\\overline{x}=\\frac{\\sum_{i=1}^{m}x_i}{m}\\)\u3002</p> <p>\u7b80\u5355\u63a8\u4e00\u4e0b\u5f0f\u5b50</p> \\[ \\begin{aligned} \\sum_{i=1}^{m}\\frac{(x_i-\\overline{x})^2}{m}&amp;=\\sum_{i=1}^{m}\\qty(\\frac{x_i^2-2x_i\\cdot \\overline{x}+\\overline{x}^2}{m}) \\end{aligned} \\] <p>\u8bb0 \\(X=\\sum_{i=1}^{m}x_i\\)\uff0c\u90a3\u4e48\u5c31\u6709</p> \\[ \\begin{aligned}     v\\times m^2=\\qty(\\sum_{i=1}^{m}mx_i^2)-2X^2+X^2=-X^2+m\\sum_{i=1}^{m}x_i^2 \\end{aligned} \\]"}, {"location": "Algorithms/Optimization/DP/DP_1/#_5", "title": "\u4e8c\u5206\u961f\u5217", "text": "<p>\u901a\u5e38\u5927\u591a\u6570\u51b3\u7b56\u5355\u8c03\u6027\u8fd8\u6ee1\u8db3\u534a\u5b8c\u5168\u5355\u8c03\u6027\u3002\u4e5f\u5c31\u662f\u5bf9\u4efb\u610f\u51b3\u7b56\u70b9 \\(i&lt;j\\)\uff0c\u80af\u5b9a\u6709\u4e00\u4e2a\u51b3\u7b56\u4f4d\u7f6e \\(k\\) \u4f7f\u5f97 \\(k\\) \u4e00\u4fa7\u7684\u51b3\u7b56\u4f4d\u7f6e\uff0c\u7528 \\(i\\) \u66f4\u4f18\uff0c\u53e6\u4e00\u4fa7\u7684\u51b3\u7b56\u4f4d\u7f6e\uff0c\u7528 \\(j\\) \u66f4\u4f18\u3002</p> <p>\u4e5f\u5c31\u662f\u6bcf\u4e2a\u70b9 \\(p\\) \u5bf9\u5e94\u7684\u6700\u4f18\u51b3\u7b56\u4f4d\u7f6e\u662f\u4e00\u6bb5\u533a\u95f4\u3002</p> <p>\u4e00\u4e2a\u5927\u81f4\u7684\u60f3\u6cd5\u662f\uff0c\u5f00\u4e00\u4e2a\u5355\u8c03\u961f\u5217\u72b6\u7269\uff0c\u5f53\u524d\u961f\u9996\u6700\u4f18\uff0c\u67d0\u4e2a\u65f6\u523b\u8fc7\u540e\u4e0b\u4e00\u4e2a\u66f4\u4f18\uff0c\u518d\u63a5\u4e0b\u6765\u518d\u4e0b\u4e00\u4e2a\u66f4\u4f18\u2026\u2026</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\u3002</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/#p1912-noi2009-g", "title": "P1912 [NOI2009] \u8bd7\u4eba\u5c0fG", "text": "<p>\u8bbe \\(S_i=i+\\sum_{j=1}^{i}\\operatorname{len}(j)\\)\uff0c\u6211\u4eec\u76f4\u63a5\u5feb\u8fdb\u5230 DP \u5f0f\u5b50</p> \\[ f_{i}=\\min_{j=0}^{i-1}\\{f_j+\\abs{s_i-s_j-1-L}^{P}\\} \\] <p>\u8fd9\u4e1c\u897f\u6709\u51b3\u7b56\u5355\u8c03\u6027\u3002</p> <p>\u8003\u8651\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217\uff0c\u5bf9\u961f\u5217\u6bcf\u5bf9\u76f8\u90bb\u7684\u4f4d\u7f6e \\(i,i+1\\) \u6c42\u51fa\u4e00\u4e2a \\(k\\)\uff0c\u8868\u793a\u5f53\u51b3\u7b56\u4f4d\u7f6e \\(\\ge k\\) \u7684\u65f6\u5019 \\(i+1\\) \u8981\u4f18\u4e8e \\(i\\)\u3002</p> <p>\u63d2\u5165\u65f6\uff0c\u8bbe \\(q\\) \u4e3a\u672b\u5c3e \\(-1\\)\uff0c\\(p\\) \u4e3a\u672b\u5c3e\uff0c\\(i\\) \u4e3a\u8981\u63d2\u5165\u7684\u6570\u3002\u5982\u679c \\(i\\) \u8d85\u8fc7 \\(p\\) \u7684\u4f4d\u7f6e\u6bd4 \\(p\\) \u8d85\u8fc7 \\(q\\) \u7684\u4f4d\u7f6e\u8fd8\u8981\u5c0f\uff0c\u90a3\u4e48 \\(p\\) \u663e\u7136\u5c31\u6ca1\u6709\u7528\u4e86\uff0c\u56e0\u4e3a\u4f60\u53ef\u4ee5\u76f4\u63a5\u7528 \\(i\\) \u4ee3\u66ff\u5b83\u3002</p> <p>\u6574\u4e2a\u8f6c\u79fb\u5982\u4ee3\u7801\u6240\u793a</p> <pre><code>for (int i = 1; i &lt;= n; i++) {\n    while (hh &lt; tt &amp;&amp; divide[hh] &lt;= i)  hh++;\n    f[i] = w(i, q[hh]);\n    from[i] = q[hh];\n    // divide[tt - 1] \u524d q[tt - 1] \u4f18\uff0c\u540e q[tt] \u4e25\u683c\u4f18\n    // bound(q[tt], i) \u524d q[tt] \u4f18\uff0c\u540e i \u4e25\u683c\u4f18\n    while (hh &lt; tt &amp;&amp; divide[tt - 1] &gt;= bound(q[tt], i))\n        tt--;\n    divide[tt] = bound(q[tt], i);\n    q[++tt] = i;\n}\n</code></pre> <p><code>bound(i, j)</code> \u662f\u6c42 \\(i,j\\) \u7684\u5206\u754c\u70b9 \\(k\\)\uff0c\u5728 \\(k\\) \u4e4b\u540e \\(j\\) \u88ab \\(i\\) \u8d85\u8fc7\u3002\u901a\u8fc7\u4e8c\u5206\uff0c\u53ef\u4ee5\u7b80\u5355\u6c42\u51fa\u8fd9\u4e2a \\(k\\)\uff0c\u5b9e\u73b0\u5982\u4e0b\u3002</p> <pre><code>// \u7b2c\u4e00\u4e2a y \u6bd4 x \u4f18\u7684\u51b3\u7b56\u4f4d\u7f6e\ninline int bound(int x, int y) {\n    int l = x, r = n + 1;\n    while (l &lt; r) {\n        int mid = (l + r) &gt;&gt; 1;\n        if (w(mid, x) &lt; w(mid, y))\n            l = mid + 1;\n        else\n            r = mid;\n    }\n    return l;\n}\n</code></pre>"}, {"location": "Algorithms/Optimization/DP/DP_1/#p3515-poi2011-lightning-conductor", "title": "P3515 [POI2011] Lightning Conductor", "text": "<p>\u6b63\u53cd\u5404\u505a\u4e00\u904d\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u7edd\u5bf9\u503c\u6d88\u6389\u4e86\u3002</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u65f6\u5019\uff0c\u5728\u4e8c\u5206\u7684\u65f6\u5019\uff0c\u82e5 \\(w(i, j)\\) \u76f4\u63a5\u7528\u53d6\u6574\u540e\u7684\u7ed3\u679c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u627e\u5230\u9519\u8bef\u7684\u51fd\u6570\u4ea4\u70b9\u3002\u4e00\u4e2a\u53ef\u80fd\u7684\u89e3\u91ca\u662f\uff0c\u5728\u51fd\u6570\u503c\u5927\u65f6\uff0c\u7531\u4e8e\u5f00\u6839\u589e\u957f\u7684\u901f\u5ea6\u4e0d\u5feb\uff0c\u6240\u4ee5\u5f88\u591a \\(a_j+\\sqrt{i-j}\\) \u662f\u4e00\u6bb5\u5f88\u957f\u7684\u5e73\u53f0\uff0c\u5982\u679c\u76f4\u63a5\u5229\u7528\u53d6\u6574\uff0c\u4f1a\u5bfc\u81f4\u8fd9\u4e9b\u51fd\u6570\u5728\u5e73\u53f0\u6bb5\u7684\u503c\u5168\u90e8\u76f8\u540c\uff0c\u6c42\u4e0d\u51fa\u6b63\u786e\u7684\u6700\u5927\u503c\u3002</p> <p>Code Link</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/#_6", "title": "\u4e8c\u5206\u6808", "text": "<p>\u901a\u5e38\u6765\u8bb2\u8fd8\u6709\u4e00\u4e2a\u53eb\u201c\u4e8c\u5206\u6808\u201d\u7684\u4e1c\u897f\uff0c\u4f46\u662f\u5176\u5b9e\u771f\u6b63\u662f\u4e8c\u5206\u6808\u7684\u9898\u76ee\u5f88\u7a00\u6709\uff0c\u5927\u90e8\u5206\u65f6\u5019\u58f0\u79f0\u662f\u4e8c\u5206\u6808\u7684\u5176\u5b9e\u662f\u4e8c\u5206\u961f\u5217\uff0c\u56e0\u4e3a\u6700\u4f18\u51b3\u7b56\u8fd8\u662f\u5728\u53d6\u6808\u5e95\u3002</p> <p>\u5927\u90e8\u5206\u65f6\u5019\u89c1\u5230\u8fd9\u79cd\u90fd\u662f\u6ee1\u8db3\u53cd\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff0c\u5c31\u662f\u5305\u542b\u4f18\u4e8e\u4ea4\u53c9\u3002</p>"}, {"location": "Algorithms/Optimization/DP/DP_1/#p5504-jsoi2011", "title": "P5504 [JSOI2011] \u67e0\u6aac", "text": ""}, {"location": "Algorithms/Optimization/DP/DP_2/", "title": "DP 2", "text": ""}, {"location": "Algorithms/Optimization/DP/DP_2/#wqs", "title": "WQS \u4e8c\u5206", "text": ""}, {"location": "Algorithms/Optimization/DP/DP_2/#minkowski", "title": "Minkowski \u548c", "text": ""}, {"location": "Algorithms/Optimization/DP/DP_2/#slope-trick", "title": "Slope Trick", "text": ""}, {"location": "Algorithms/Optimization/DP/DP_EX/", "title": "DP EX", "text": "<p>\u5c0f\u7ec3\u4e60\u3002</p>"}, {"location": "Algorithms/Optimization/LinearProgramming/LP_2/", "title": "LP 2", "text": "<p>\u5982\u679c <code>\\boldsymbol</code> \u6ca1\u52a0\u8f7d\u51fa\u6765\u53ef\u4ee5 <code>Ctrl + F5</code> \u5237\u65b0\u4e00\u4e0b\u9875\u9762\u2026\u2026</p>"}, {"location": "Algorithms/Optimization/LinearProgramming/LP_2/#_1", "title": "\u5b9e\u73b0", "text": "<p>\u6211\u4eec\u5148\u6765\u8ba8\u8bba\uff0c\u5982\u679c\u6240\u6709 \\(\\boldsymbol{b}\\) \u4e2d\u7684\u5143\u7d20\u90fd \\(\\ge 0\\) \u4f1a\u600e\u4e48\u6837\u3002</p>"}, {"location": "Algorithms/Optimization/LinearProgramming/LP_2/#init", "title": "init", "text": "<pre><code>inline void init(int _n, int _m) {\n    n = _n, m = _m;\n    for (int i = 0; i &lt;= m; i++)\n        for (int j = 0; j &lt;= n; j++)\n            A[i][j] = 0;\n    for (int i = 1; i &lt;= n; i++)\n        id[i] = i;\n    for (int i = 1; i &lt;= m; i++)\n        id[n + i] = 0;\n    result = 0;\n    for (int i = 1; i &lt;= n; i++)\n        ans[i] = 0;\n}\n</code></pre> <p>\u9996\u5148\u6211\u4eec\u80af\u5b9a\u8f6c\u6210\u4e86\u677e\u5f1b\u578b\uff0c\u6240\u4ee5\u4f1a\u65b0\u5efa \\(m\\) \u4e2a\u53d8\u91cf \\(x_{n+1},x_{n+2},x_{n+3},\\cdots, x_{n+m}\\)\u3002\u7136\u540e\u6839\u636e\u677e\u5f1b\u578b\u7684\u77e9\u9635\uff0c\u8fd9\u5f53\u7136\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u7ec4\u57fa\u3002</p> <p>\u53e6\u5916\uff0c\u56e0\u4e3a\u57fa\u53d8\u91cf\u7684\u60c5\u51b5\u7cfb\u6570\u662f\u5e73\u51e1\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4e0d\u5b58\uff0c\u53ea\u5b58\u975e\u57fa\u53d8\u91cf\u7684\u7cfb\u6570\u3002</p> <p>\u7279\u522b\u5730\uff0c\u6211\u4eec\u94a6\u5b9a\u77e9\u9635\u7684\u7b2c \\(0\\) \u5217\u662f\u9650\u5236\u7684\u5411\u91cf \\(\\boldsymbol{b}\\)\uff0c\u7b2c \\(0\\) \u884c\u662f\u8d21\u732e\u7cfb\u6570\u5411\u91cf \\(\\boldsymbol{c}^T\\)\uff0c\u7136\u540e\uff1a</p> \\[ A_{0,0}=z=-z_0+\\sum_{i=1}^{n}c_i\\cdot x_i=-z_0 \\] <p>\u6700\u540e\u4e00\u4e2a\u7b49\u53f7\u662f\u56e0\u4e3a\u6211\u4eec\u4f1a\u94a6\u5b9a\u975e\u57fa\u53d8\u91cf\u5168\u4e3a \\(0\\)\uff0c\u800c\u8fd9\u4e2a \\(z_0\\) \u5c31\u662f\u6211\u4eec\u5728\u4e0b\u9762\u7684 \\(\\operatorname{Pivot}\\) \u8fc7\u7a0b\u4e2d\u7ed9\u5b83\u6dfb\u52a0\u7684\u5e38\u6570\u9879\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0a\u9762\u7684\u4e1c\u897f\u5168\u90fd\u662f\u4f1a\u53d8\u7684\uff0c\u4e0d\u4f1a\u53ea\u662f\u521d\u59cb\u7684\u90a3\u4e00\u4e2a\u3002</p> <p>\u56e0\u4e3a\u6709 \\(\\boldsymbol{b}\\) \u4e2d\u7684\u5143\u7d20\u90fd \\(\\ge 0\\)\uff0c\u90a3\u4e48\u521d\u59cb \\(x\\) \u5168 \\(0\\) \u5c31\u662f\u4e00\u7ec4\u53ef\u884c\u89e3\u3002\u5f53\u7136\uff0c\u7b54\u6848 \\(\\mathrm{res}\\) \u4e5f\u4e3a \\(0\\)\u3002</p> <p>\\(\\operatorname{id}(u)\\) \u8868\u793a\u6700\u7ec8\u7684\u77e9\u9635\u91cc\u7b2c \\(u\\) \u4e2a\u53d8\u91cf\u5728\u521d\u59cb\u7684\u65f6\u5019\u4f4d\u4e8e\u7684\u662f\u54ea\u4e00\u5217\uff08\u7528\u6765\u6784\u9020\u89e3\uff09\u3002\u5bf9\u4e8e\u677e\u5f1b\u90a3\u4e00\u7ec4\u57fa\u53d8\u91cf\uff0c\u5b83\u4eec\u7684\u503c\u4e0d\u4f1a\u51fa\u73b0\u5728\u6700\u7ec8\u6784\u9020\u7684\u89e3\u91cc\uff0c\u6240\u4ee5\u628a\u5b83\u4eec\u7684 \\(\\operatorname{id}\\) \u90fd\u94a6\u5b9a\u6210 \\(0\\) \u662f\u65e0\u6240\u8c13\u7684\u3002</p>"}, {"location": "Algorithms/Optimization/LinearProgramming/LP_2/#pivot", "title": "Pivot", "text": "<p>\u4e0a\u9762\u7684\u8fc7\u7a0b\u57fa\u4e8e\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u4e1c\u897f\uff0c\u5373 <code>Pivot(x, y)</code>\uff0c\u8868\u793a\u628a\u7b2c \\(x\\) \u4e2a\u57fa\u53d8\u91cf\u66ff\u6362\u6210\u7b2c \\(y\\) \u4e2a\u975e\u57fa\u53d8\u91cf\u3002</p> <p>\u7531\u4e8e\u57fa\u53d8\u91cf\u7684\u7cfb\u6570\u975e\u5e38\u5e73\u51e1\uff0c\u65e0\u975e\u5c31\u662f\u53ea\u6709\u4e00\u4e2a \\(1\\)\uff0c\u6240\u4ee5\u6211\u4eec\u4e3a\u4e86\u5b9e\u73b0\u7684\u7b80\u4fbf\uff0c\u53ea\u7ef4\u62a4\u975e\u57fa\u53d8\u91cf\u7684\u7cfb\u6570\u3002</p> <p>\u7ed9\u51fa\u4e00\u4e2a <code>Pivot</code> \u8fc7\u7a0b\u7684\u4ee3\u7801</p> <pre><code>inline void pivot(int x, int y) {\n    std::swap(id[n + x], id[y]);\n\n    f128 t = A[x][y];\n    A[x][y] = 1;\n    for (int i = 0; i &lt;= n; i++)\n        A[x][i] /= t;\n\n    for (int i = 0; i &lt;= m; i++) {\n        if (i != x &amp;&amp; fabs(A[i][y]) &gt; eps) {\n            t = A[i][y], A[i][y] = 0;\n            for (int j = 0; j &lt;= n; j++)\n                A[i][j] -= t * A[x][j];\n        }\n    }\n}\n</code></pre> <p>\u7b2c\u4e00\u884c\u7684\u5185\u5bb9\u5c31\u662f\u4ea4\u6362\u7b2c \\(x\\) \u4e2a\u57fa\u53d8\u91cf\u548c\u7b2c \\(y\\) \u4e2a\u975e\u57fa\u53d8\u91cf\u5bf9\u5e94\u7684\u521d\u59cb\u53d8\u91cf\u3002</p> <p>\u63a5\u4e0b\u6765\u7684\u8fd9\u51e0\u884c\u65e0\u975e\u662f\u9ad8\u65af\u6d88\u5143\uff0c\u4f46\u662f\u5728\u88ab\u66ff\u6362\u7684\u7b2c \\(y\\) \u5217\u5374\u662f\u7279\u6b8a\u5904\u7406\u7684\u3002\u8fd9\u5176\u5b9e\u662f\u76f4\u63a5\u5728\u7b2c \\(y\\) \u5217\u8fdb\u884c\u4e86\u7b2c \\(n+x\\) \u5217\u53d8\u6362\u3002</p> <p>\u6216\u8005\u8bf4\u7684\u66f4\u6e05\u695a\u4e00\u4e9b\uff0c\u8003\u8651\u7b2c \\(x+n\\) \u5217\uff0c\u5b83\u53ea\u6709\u5728\u7b2c \\(x\\) \u884c\u624d\u4e3a \\(1\\)\uff0c\u5176\u4ed6\u884c\u5168\u90e8\u4e3a \\(0\\)\u3002\u4e5f\u5c31\u662f\u53ea\u770b\u8fd9\u4e24\u5217\uff0c\u77e9\u9635\u662f\u8fd9\u6837\u7684</p> \\[ \\begin{bmatrix} \\cdots &amp;a_{0,y} &amp;\\cdots &amp;0 &amp;\\cdots\\\\ \\cdots &amp;a_{1,y} &amp;\\cdots &amp;0 &amp;\\cdots\\\\ \\cdots &amp;a_{2,y} &amp;\\cdots &amp;0 &amp;\\cdots\\\\ \\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots\\\\ \\cdots &amp;a_{x,y} &amp;\\cdots &amp;1 &amp; \\cdots\\\\ \\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots\\\\ \\cdots &amp;a_{m,y} &amp;\\cdots &amp;0 &amp; \\cdots\\\\ \\end{bmatrix} \\] <p>\u5bf9\u7b2c \\(y\\) \u5217\u6d88\u5143\uff0c\u7136\u540e\u8003\u5bdf\u7b2c \\(x+n\\) \u5217\u7684\u53d8\u5316\u3002</p> <p>\u6211\u4eec\u6d88\u5143\u5148\u5728\u7b2c \\(x\\) \u884c\u5168\u90e8\u540c\u9664 \\(a_{x,y}\\)\uff0c\u7136\u540e\u5176\u4ed6\u7684\u6bcf\u4e2a\u884c \\(i\\) \u51cf\u53bb \\(a_{i,y}\\) \u500d\u7684\u7b2c \\(x\\) \u884c\u3002</p> \\[ \\begin{bmatrix} \\cdots &amp;0 &amp;\\cdots &amp;-\\dfrac{a_{0,y}}{a_{x,y}} &amp;\\cdots\\\\ \\cdots &amp;0 &amp;\\cdots &amp;-\\dfrac{a_{1,y}}{a_{x,y}} &amp;\\cdots\\\\ \\cdots &amp;0 &amp;\\cdots &amp;-\\dfrac{a_{2,y}}{a_{x,y}} &amp;\\cdots\\\\ \\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots\\\\ \\cdots &amp;1 &amp;\\cdots &amp;\\dfrac{1}{a_{x,y}} &amp; \\cdots\\\\ \\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots\\\\ \\cdots &amp;0 &amp;\\cdots &amp;-\\dfrac{a_{m,y}}{a_{x,y}} &amp; \\cdots\\\\ \\end{bmatrix} \\] <p>\u7136\u540e\uff0c\u6211\u4eec\u4ea4\u6362\u4e24\u5217\u3002\u4f46\u662f\u6ce8\u610f\u5230\u4ea4\u6362\u540e\u7684\u7b2c \\(n+x\\) \u5217\u548c\u539f\u6765\u4e00\u6a21\u4e00\u6837\uff0c\u53ea\u6709\u7b2c \\(y\\) \u5217\u53d8\u4e86\u3002\u90a3\u6211\u4eec\u5c31\u5728\u7b2c \\(y\\) \u5217\u539f\u5730\u4fee\u6539\u5c31\u597d\u4e86\u3002\u4ece\u800c\u6709\u4e86\u4e0a\u9762\u7684\u4ee3\u7801\u3002</p>"}, {"location": "Algorithms/Optimization/LinearProgramming/LP_2/#simplex", "title": "Simplex", "text": "<p>\u7136\u540e\uff0c\u662f\u6574\u4e2a\u7a0b\u5e8f\u7684\u4e3b\u4f53\u8fc7\u7a0b</p> <pre><code>inline bool simplex() {\n    while (true) {\n        int u = 0, v = 0;\n        f128 minval = 1e18;\n        for (int i = 1; i &lt;= n; i++)\n            if (A[0][i] &gt; eps) {\n                v = i;\n                break;\n            }\n\n        if (!v)\n            break;\n\n        for (int i = 1; i &lt;= m; i++)\n            if (A[i][v] &gt; eps &amp;&amp; (!u || A[i][0] / A[i][v] &lt; minval))\n                minval = A[i][0] / A[i][v], u = i;\n\n        if (!u) {\n            std::cout &lt;&lt; \"Unbounded\" &lt;&lt; '\\n';\n            return false;\n        } else\n            pivot(u, v);\n    }\n    return true;\n}\n</code></pre> <p>\u524d\u51e0\u884c\u5c31\u662f\u968f\u4fbf\u627e\u4e00\u4e2a\u8d21\u732e\u7cfb\u6570 \\(&gt;0\\) \u7684\u975e\u57fa\u53d8\u91cf\uff0c\u8bbe\u5176\u7f16\u53f7\u4e3a \\(v\\)\uff0c\u7136\u540e\u63a5\u4e0b\u6765\u662f\u8981\u627e\u5230\u67d0\u4e00\u4e2a\u57fa\u53d8\u91cf\uff0c\u8bbe\u5176\u7f16\u53f7\u4e3a \\(u\\)\uff0c\u4ece\u800c\u4f7f\u5f97 \\(\\operatorname{Pivot}(u,v)\\) \u540e \\(v\\) \u53d8\u6210\u7684\u57fa\u53d8\u91cf\u7684\u503c\u6700\u5c0f\u3002</p> <p>\u5047\u8bbe\u7ea6\u675f\u5411\u91cf\u662f \\(\\boldsymbol{b}\\)\uff0c\u56de\u5fc6\u4e0a\u9762 \\(\\operatorname{Pivot}(x,y)\\) \u7684\u6d88\u5143\u540e\u7684\u77e9\u9635\uff0c\u662f\uff1a</p> \\[ \\begin{bmatrix} b_1-\\dfrac{b_x\\cdot a_{0,y}}{a_{x,y}}&amp;\\cdots &amp;-\\dfrac{a_{0,y}}{a_{x,y}} &amp;\\cdots &amp;0 &amp;\\cdots\\\\ b_2-\\dfrac{b_x\\cdot a_{1,y}}{a_{x,y}}&amp;\\cdots &amp;-\\dfrac{a_{1,y}}{a_{x,y}} &amp;\\cdots &amp;0 &amp;\\cdots\\\\ b_3-\\dfrac{b_x\\cdot a_{2,y}}{a_{x,y}}&amp;\\cdots &amp;-\\dfrac{a_{2,y}}{a_{x,y}} &amp;\\cdots &amp;0 &amp;\\cdots\\\\ \\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots\\\\ \\dfrac{b_{x}}{a_{x,y}}&amp;\\cdots &amp;\\dfrac{1}{a_{x,y}} &amp;\\cdots &amp;1 &amp; \\cdots\\\\ \\vdots&amp;\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots\\\\ b_{m}-\\dfrac{b_x\\cdot a_{m,y}}{a_{x,y}}&amp;\\cdots &amp;-\\dfrac{a_{m,y}}{a_{x,y}} &amp;\\cdots &amp;0 &amp; \\cdots\\\\ \\end{bmatrix} \\] <p>\u7740\u773c\u4e8e\u7b2c \\(x\\) \u884c\uff0c\u56e0\u4e3a\u975e\u57fa\u53d8\u91cf\u5168\u90fd\u4e3a \\(0\\)\uff0c\u800c\u4e14\u6240\u6709\u57fa\u53d8\u91cf\uff08\u9664\u4e86\u7b2c \\(x\\) \u4e2a\u81ea\u8eab\uff09\u7684\u7b2c \\(x\\) \u884c\u7cfb\u6570\u90fd\u4e3a \\(0\\)\uff0c\u4e0d\u96be\u53d1\u73b0\u65b0\u7684\u57fa\u53d8\u91cf \\(x\\) \u7684\u503c\u5c31\u662f\u7b2c \\(0\\) \u5217\u7684 \\(\\dfrac{b_x}{a_{x,y}}\\)\u3002\u8fd9\u4e5f\u662f\u7b26\u5408\u6211\u4eec\u4e0a\u9762\u7684\u63a8\u7406\u7684\uff08\u6bcf\u4e2a\u57fa\u53d8\u91cf\u90fd\u80fd\u88ab\u8868\u8fbe\u6210\u4e00\u7ec4\u975e\u57fa\u53d8\u91cf\u7684\u548c\uff0c\u5e76\u4e14\u80fd\u591f\u94a6\u5b9a\u975e\u57fa\u53d8\u91cf\u90fd\u4e3a \\(0\\)\uff09</p> <p>\u5982\u679c\u627e\u4e0d\u5230\u8fd9\u6837\u7684 \\(u\\)\uff0c\u90a3\u5c31\u8bf4\u660e\u4e86\u6211\u4eec\u6709\u4e00\u4e2a\u5168 \\(0\\) \u884c\uff0c\u5b83\u5b8c\u5168\u4e0d\u53d7\u6240\u6709\u7b49\u5f0f\u7684\u7ea6\u675f\uff0c\u53ef\u4ee5\u53d6\u5230\u4efb\u610f\u5927\u7684\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u7ebf\u6027\u89c4\u5212\u65e0\u754c\uff0c\u53ea\u8981\u8ba9\u8fd9\u4e2a\u53d8\u91cf\u53d6\u5230 \\(+\\infty\\) \u5c31\u597d\u4e86\u3002</p>"}, {"location": "Algorithms/Optimization/LinearProgramming/LP_2/#check", "title": "check", "text": "<p>\u6211\u4eec\u4e0a\u9762\u7684\u8ba8\u8bba\u90fd\u5efa\u7acb\u5728\u7ed9\u5b9a\u4e00\u4e2a\u521d\u59cb\u89e3\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u5bf9\u4e8e\u4e00\u4e2a\u4efb\u610f\u7684\u7ebf\u6027\u89c4\u5212\uff0c\u6211\u4eec\u4e0d\u4e00\u5b9a\u6709 \\(\\boldsymbol{b}\\ge 0\\)\uff0c\u90a3\u4e48\u600e\u4e48\u6784\u9020\u51fa\u8fd9\u4e2a\u521d\u59cb\u89e3\uff1f</p> <pre><code>inline bool check() {\n    while (true) {\n        int u = 0, v = 0;\n        for (int i = 1; i &lt;= m; i++)\n            if (A[i][0] &lt; -eps &amp;&amp; (!u || rng() &amp; 1))\n                u = i;\n        if (!u)\n            break;\n        for (int i = 1; i &lt;= n; i++)\n            if (A[u][i] &lt; -eps &amp;&amp; (!v || rng() &amp; 1))\n                v = i;\n        if (!v) {\n            std::cout &lt;&lt; \"Infeasible\" &lt;&lt; '\\n';\n            return false;\n        }\n        pivot(u, v);\n    }\n    return true;\n}\n</code></pre> <p>\u8fd9\u4e2a\u4e8b\u60c5\u5176\u5b9e\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u968f\u4fbf\u627e\u5230\u4e00\u4e2a \\(\\boldsymbol{b}_i&lt;0\\) \u7684 \\(i\\)\uff0c\u5982\u679c\u627e\u4e0d\u5230\u5c31\u8bf4\u660e\u5df2\u7ecf\u6784\u9020\u51fa\u4e00\u7ec4\u521d\u59cb\u89e3\u4e86\u3002</p> <p>\u7136\u540e\u518d\u627e\u6709\u6ca1\u6709\u67d0\u4e00\u4e2a\u975e\u57fa\u53d8\u91cf \\(v\\) \u5728\u66ff\u6362\u6210\u57fa\u53d8\u91cf\u7684\u65f6\u5019\u80fd\u591f\u8ba9\u8fd9\u4e00\u9879 \\(\\boldsymbol{b_i}\\) \u53d8\u6210\u975e\u8d1f\u6570\u7684\u3002\u8fd9\u91cc\u7684\u539f\u7406\u53ef\u4ee5\u53c2\u7167\u4e0a\u4e00\u8282\u3002</p> <p>\u5982\u679c\u627e\u4e0d\u5230\u8fd9\u6837\u7684 \\(v\\)\uff0c\u90a3\u80af\u5b9a\u5c31\u65e0\u89e3\u4e86\u3002\u5426\u5219 \\(\\operatorname{Pivot}(u,v)\\)\u3002</p> <p>\u4f7f\u7528\u4e00\u70b9\u70b9\u968f\u673a\u5316\uff0c\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u8dd1\u5f97\u66f4\u5feb\uff08\u867d\u7136\u80af\u5b9a\u8fd8\u662f\u8fc7\u4e0d\u53bb \\(\\text{UOJ}\\) \u7684 \\(\\text{hack}\\)\uff09\u3002</p>"}, {"location": "Algorithms/Optimization/NetworkFlow/EX_Simulation/", "title": "EX Simulation", "text": "<p>\u53c2\u8003\u8d44\u6599\uff1a</p> <p>\u6a21\u62df\u8d39\u7528\u6d41\u5c0f\u8bb0 - command_block\uff0c\u6a21\u62df\u8d39\u7528\u6d41\u9898\u96c6 - Alpha1022</p>"}, {"location": "Algorithms/Optimization/NetworkFlow/NetworkFlow_1/", "title": "NetworkFlow 1", "text": "<p>\u5927\u5bb6\u80af\u5b9a\u90fd\u4f1a \\(\\text{Dinic}\\)\uff0c\u4e5f\u77e5\u9053\u5565\u662f\u6700\u5927\u6d41\u6700\u5c0f\u5272\u5b9a\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u5feb\u8fdb\u5230\u5efa\u56fe\u3002\u53e6\u5916\u5199 \\(\\text{ISAP}\\) \u6ca1\u6709 \\(\\text{Dinic}\\) \u5728\u5355\u4f4d\u56fe\u548c\u4e8c\u5206\u5355\u4f4d\u56fe\u4e0a\u7684\u590d\u6742\u5ea6\u4f18\u5316\uff0c\u6240\u4ee5\u6700\u597d\u522b\u5199 \\(\\text{ISAP}\\)\u3002</p> <p>\u4e0b\u9762\u7edf\u4e00\u628a \\(S\\) \u4fa7\u79f0\u4e3a\u5de6\u8fb9\uff0c\\(T\\) \u4fa7\u79f0\u4e3a\u53f3\u8fb9\u3002</p>"}, {"location": "Algorithms/Optimization/NetworkFlow/NetworkFlow_1/#_1", "title": "\u6700\u5927\u6d41\u7684\u5efa\u56fe", "text": ""}, {"location": "Algorithms/Optimization/NetworkFlow/NetworkFlow_1/#_2", "title": "\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d", "text": "<p>\u7ed9\u51fa\u4e00\u5f20\u4e8c\u5206\u56fe\uff0c\u9009\u51fa\u5c3d\u53ef\u80fd\u591a\u7684\u8fb9\uff0c\u4f7f\u5f97\u4efb\u610f\u4e24\u6761\u8fb9\u6ca1\u6709\u516c\u5171\u7aef\u70b9</p> <p>\u663e\u7136\uff0c\u5728 \\(S\\) \u5411\u6240\u6709\u5de6\u90e8\u70b9\u8fde\u6743\u503c\u4e3a \\(1\\) \u7684\u8fb9\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8fb9 \\((u,v)\\)\uff0c\u7531\u5de6\u90e8\u70b9 \\(u\\) \u5411\u53f3\u90e8\u70b9 \\(v\\) \u8fde\u6743\u503c\u4e3a \\(1\\) \u7684\u8fb9\uff0c\u6240\u6709\u53f3\u90e8\u70b9\u5411 \\(T\\) \u8fde\u4e00\u6761\u6743\u503c\u4e3a \\(1\\) \u7684\u8fb9\u3002</p> <p>\u4e8c\u5206\u5355\u4f4d\u56fe\uff0c\u590d\u6742\u5ea6 \\(\\mathcal O(m\\sqrt n)\\)\u3002</p>"}, {"location": "Algorithms/Optimization/NetworkFlow/NetworkFlow_1/#dag", "title": "DAG \u6700\u5c0f\u8def\u5f84\u8986\u76d6", "text": "<p>\u7ed9\u51fa\u4e00\u5f20\u6709\u5411\u56fe\uff0c\u4f60\u9700\u8981\u9009\u62e9\u51fa\u5c3d\u53ef\u80fd\u5c11\u7684\u70b9\u4e0d\u4ea4\u7684\u7b80\u5355\u8def\u5f84\uff0c\u4f7f\u5f97\u6bcf\u4e2a DAG \u4e0a\u7684\u70b9\u90fd\u5728\u67d0\u6761\u8def\u5f84\u4e0a\u3002</p> <p>\u6240\u6709\u70b9\u89c6\u4f5c\u72ec\u7acb\u7684\u4e00\u6761\u8def\u5f84\uff0c\u7136\u540e\u8003\u8651\u628a\u82e5\u5e72\u4e2a\u70b9\u5408\u5e76\u6210\u4e00\u6761\u8def\u5f84\uff0c\u5177\u4f53\u5730\uff0c\u6bcf\u4e2a\u70b9\u53ef\u4ee5\u548c\u5b83\u51fa\u8fb9\u8fde\u5230\u7684\u70b9\u5408\u5e76\u3002</p> <p>\u5bf9\u6bcf\u4e2a\u70b9\u5efa\u4e24\u4e2a\u70b9 \\(u\\) \u548c \\(u'\\)\uff0c\u5bf9\u4e8e\u539f\u56fe\u91cc\u9762\u7684\u6bcf\u6761\u8fb9 \\((u,v)\\)\uff0c\u8fde \\((u,v')\\)\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u5c31\u662f\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\u4e86\u3002</p>"}, {"location": "Algorithms/Optimization/NetworkFlow/NetworkFlow_1/#dag_1", "title": "DAG \u6700\u5c0f\u94fe\u8986\u76d6", "text": "<p>\u540c\u4e0a\u4e00\u9898\uff0c\u4f46\u662f\u6ca1\u6709\u70b9\u4e0d\u4ea4\u7684\u9650\u5236\u3002</p> <p>\u5148\u6c42\u51fa\u6bcf\u4e2a\u70b9 \\(x\\) \u80fd\u5230\u8fbe\u6240\u6709\u70b9 \\(y\\)\uff0c\\(x\\) \u5411\u8fd9\u4e9b\u70b9\u5206\u522b\u8fde\u4e00\u6761\u8fb9\uff0c\u76f4\u63a5\u5957\u7528\u4e0a\u4e00\u9898\u7684\u505a\u6cd5\u3002</p> <p>\u91cd\u590d\u7ecf\u8fc7\u7684\u70b9\u5c31\u76f8\u5f53\u4e8e\u88ab\u8df3\u8fc7\u4e86\uff0c\u6b63\u786e\u6027\u8bc1\u660e\u6211\u4e5f\u4e0d\u77e5\u9053\u3002</p> <p>\u663e\u7136\u6211\u4eec\u6709\u4e00\u4e9b\u66f4\u52a0\u5bf9\u7684\u505a\u6cd5\uff0c\u8003\u8651\uff08\u540e\u9762\u7684\uff09\u4e0a\u4e0b\u754c\u7f51\u7edc\u6d41\u3002</p> <p>\u5bf9\u6bcf\u4e2a\u70b9 \\(u\\)\uff0c\u6240\u4ee5 \\(S\\) \u5411 \\(u\\) \u8fde\u4e00\u6761\u6d41\u91cf\u4e3a \\(1\\) \u7684\u8fb9\u3002</p> <p>\u6bcf\u4e2a \\(u\\) \u521d\u59cb\u90fd\u662f\u4e00\u6761\u8def\u5f84\uff0c\u4f46\u662f\u4e00\u4e2a\u70b9\u53ef\u4ee5\u88ab\u591a\u4e2a\u70b9\u5339\u914d\uff0c\u6240\u4ee5 \\(u\\) \u5411 \\(u'\\) \u8fde\u4e00\u6761\u4e0b\u754c\u4e3a \\(1\\)\uff0c\u4e0a\u754c\u4e3a \\(+\\infty\\) \u7684\u8fb9\u3002</p> <p>\u5bf9\u4e8e\u539f\u56fe\u4e2d\u7684\u6bcf\u6761\u8fb9 \\((u,v)\\)\uff0c\u8fde\u6d41\u91cf\u4e3a \\(1\\) \u7684 \\((u',v)\\)\u3002\u6c42\u6709\u6e90\u6c47\u4e0a\u4e0b\u754c\u6700\u5927\u6d41\u5373\u53ef\u3002</p> <p>\u590d\u6742\u5ea6 \\(\\mathcal O(m(n+m))\\)\u3002</p>"}, {"location": "Algorithms/Optimization/NetworkFlow/NetworkFlow_1/#_3", "title": "\u6700\u5c0f\u5272\u7684\u5efa\u56fe", "text": ""}, {"location": "Algorithms/Optimization/NetworkFlow/NetworkFlow_1/#_4", "title": "\u4e8c\u5206\u56fe\u6700\u5c0f\u70b9\u8986\u76d6", "text": "<p>\u53d6\u51fa\u6700\u5c11\u7684\u70b9\uff0c\u4f7f\u5f97\u6bcf\u6761\u8fb9\u81f3\u5c11\u6709\u4e00\u4e2a\u7aef\u70b9\u88ab\u9009\u62e9</p> <p>\u7b49\u4e8e\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\u3002</p> <p>\u8003\u8651\u548c\u6700\u5927\u6d41\u540c\u6837\u4e00\u4e2a\u56fe\u7684\u6700\u5c0f\u5272\uff0c\u8003\u8651\u53f3\u8fb9\u6240\u6709\u88ab\u9009\u7684\u70b9\u8868\u793a\u88ab\u8986\u76d6\u4e86\uff0c</p>"}, {"location": "Algorithms/Optimization/NetworkFlow/NetworkFlow_1/#_5", "title": "\u6700\u5927\u6743\u95ed\u5408\u5b50\u56fe", "text": "<p>\u6709\u4e00\u5f20\u6709\u5411\u56fe\uff0c\u70b9\u6743\u6709\u6b63\u6709\u8d1f\uff0c\u5982\u679c\u4e00\u4e2a\u70b9\u9009\u4e86\uff0c\u6240\u6709\u4ece\u5b83\u51fa\u53d1\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9\u90fd\u5fc5\u987b\u88ab\u9009\uff0c\u6c42\u6700\u5927\u7684\u6743\u503c\u3002</p> <p>\u5728\u539f\u56fe\u7684\u57fa\u7840\u4e0a\uff0c\\(S\\) \u5411\u6240\u6709\u6b63\u6743\u70b9\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a\u70b9\u6743\u7684\u8fb9\uff0c\u6240\u6709\u8d1f\u6743\u70b9\u5411 \\(T\\) \u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a\u70b9\u6743\u7684\u76f8\u53cd\u6570\u7684\u8fb9\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u8dd1\u6700\u5c0f\u5272\uff0c\u5de6\u8fb9\u5272\u6389\u7684\u8fb9\u8868\u793a\u4e0d\u9009\u5bf9\u5e94\u70b9\uff0c\u53f3\u8fb9\u5272\u6389\u7684\u8fb9\u8868\u793a\u9009\u5bf9\u5e94\u70b9\u3002</p> <p>\u56e0\u4e3a \\(S\\) \u548c \\(T\\) \u4e0d\u8fde\u901a\uff0c\u6240\u4ee5\u4ece\u5de6\u8fb9\u7684\u4efb\u4f55\u4e00\u4e2a\u4fdd\u7559\u7684\u70b9\u51fa\u53d1\uff0c\u53ea\u80fd\u5230\u8fbe\u88ab\u9009\u62e9\u4e86\u7684\u70b9\u3002\u8fd9\u786e\u5b9e\u662f\u4e00\u4e2a\u95ed\u5408\u5b50\u56fe\u3002</p> <p>\u7b54\u6848\u663e\u7136\u662f\uff0c\u6240\u6709\u6b63\u6743\u4e4b\u548c\u51cf\u53bb\u6700\u5c0f\u5272\u3002</p>"}, {"location": "Algorithms/Strings/Basic-String-Theory/Border_and_Palindrome/", "title": "Border and Palindrome", "text": "\\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\Endpos{\\operatorname{Endpos}} \\newcommand\\Startpos{\\operatorname{Startpos}} \\newcommand\\height{\\operatorname{height}} \\newcommand\\SA{\\operatorname{SA}} \\newcommand\\len{\\operatorname{len}} \\newcommand\\chkmax{\\operatorname{chkmax}} \\newcommand\\chkmin{\\operatorname{chkmin}} \\newcommand\\siz{\\operatorname{siz}} \\newcommand\\fa{\\operatorname{fa}} \\newcommand\\LCP{\\operatorname{LCP}} \\newcommand\\EGF{\\operatorname{EGF}} \\newcommand\\OGF{\\operatorname{OGF}} \\newcommand\\bd{\\operatorname{Border}} \\newcommand\\mbd{\\operatorname{MaxBorder}} \\] <p>KMP \u7684\u90e8\u5206\u7565\u3002</p> <p>\\(\\bd\\) \u7684\u5b9a\u4e49\uff1a\u6211\u4eec\u79f0\u4e00\u4e2a\u5b57\u7b26\u4e32 \\(T\\) \u662f\u5b57\u7b26\u4e32 \\(S\\) \u7684\u4e00\u4e2a \\(\\bd\\)\uff0c\u5f53\u4e14\u4ec5\u5f53 \\(T\\) \u65e2\u662f \\(S\\) \u7684\u524d\u7f00\u53c8\u662f \\(S\\) \u7684\u540e\u7f00\u3002\u7279\u522b\u5730\uff0c\\(S\\) \u4e0d\u662f \\(S\\) \u7684 \\(\\bd\\)\u3002</p> <p>\u6211\u4eec\u79f0\u5b57\u7b26\u4e32 \\(S\\) \u7684 \\(\\mbd\\) \u662f\u4e32 \\(S\\) \u6240\u6709 \\(\\bd\\) \u4e2d\u6700\u957f\u7684\u4e00\u4e2a\u3002</p> <p>\u82e5\u6709\u6b63\u6574\u6570 \\(p\\) \u6ee1\u8db3 \\(\\forall i\\in [1,|S|-p],S[i]=S[i+p]\\)\uff0c\u90a3\u4e48 \\(p\\) \u5219\u662f \\(S\\) \u7684\u4e00\u4e2a\u5468\u671f\u3002\u82e5 \\(p\\mid n\\)\uff0c\u5219 \\(p\\) \u4e3a \\(S\\) \u7684\u4e00\u4e2a\u6574\u5468\u671f\u3002</p> <p>\u663e\u7136\uff0c\\(p\\) \u4e3a \\(S\\) \u7684\u5468\u671f\u7684\u5145\u5206\u5fc5\u8981\u6761\u4ef6\u662f\u5b58\u5728\u4e00\u4e2a \\(S\\) \u7684 \\(\\bd\\) \u4e3a \\(T\\)\uff0c\u6ee1\u8db3 \\(|S|-|T|=p\\)\u3002</p> <p>\u663e\u7136\uff0c\u5bf9\u5b57\u7b26\u4e32\u505a KMP\uff0c\\(\\text{Fail}\\) \u6570\u7ec4\uff08\u6216\u79f0 \\(\\text{Next}\\) \u6570\u7ec4\uff09\u5373\u4e3a\u6bcf\u4e2a\u524d\u7f00\u7684 \\(\\mbd\\) \u7684\u957f\u5ea6\u3002</p> <p>\u4e0b\u9762\u8bbe \\(\\bd(S)\\) \u4e3a \\(S\\) \u7684 \\(\\bd\\) \u96c6\u5408\uff0c\\(\\mbd(S)\\) \u4e3a \\(S\\) \u7684 \\(\\mbd\\)\u3002</p>"}, {"location": "Algorithms/Strings/Basic-String-Theory/Border_and_Palindrome/#border", "title": "Border \u7684\u4e00\u4e9b\u6027\u8d28", "text": "<ol> <li> <p>\\(\\bd(S)=\\{\\mbd(S)\\}\\cup \\bd(\\mbd(S))\\)</p> <p>\u5373\uff0c\\(\\bd(S)\\) \u662f \\(S\\) \u7684 \\(\\mbd\\) \u518d\u52a0\u4e0a \\(\\mbd\\) \u7684 \\(\\bd\\) \u96c6\u5408\u3002</p> <p>\u8fd9\u4e2a\u8bc1\u660e\u662f\u5e73\u51e1\u7684\uff0c\u8003\u8651\u6bd4 \\(\\mbd\\) \u77ed\u7684 \\(\\bd\\) \u662f\u8fd9\u6837\u7684</p> <pre><code>   Border: [----                  ----]\nMaxBorder: [------              ------]\n String S: [--------------------------]\n</code></pre> <p>\u800c\u524d\u540e\u7f00\u76f8\u540c\uff0c\u6240\u4ee5\u6b64 \\(\\bd\\) \u65e2\u662f \\(\\mbd\\) \u7684\u524d\u7f00\u53c8\u662f \\(\\mbd\\) \u7684\u540e\u7f00\uff0c\u6240\u4ee5 \\(\\mbd\\) \u4e5f\u5177\u6709\u6b64 \\(\\bd\\)\u3002</p> <p>\u6240\u4ee5 KMP \u7684\u8fc7\u7a0b\u4e2d\u4e0d\u65ad\u8df3 \\(\\text{Fail}\\)\uff0c\u5230\u8fbe\u7684\u6240\u6709\u524d\u7f00\u7ec4\u6210\u7684\u96c6\u5408\u5c31\u662f \\(\\bd(S)\\)\u3002</p> </li> <li> <p>\u5f3a/\u5f31\u5468\u671f\u5f15\u7406</p> <p>\u5f31\u5468\u671f\u5f15\u7406(Weak Periodicity Lemma, WPL):</p> <p>\u82e5 \\(p,q\\) \u4e3a \\(S\\) \u7684\u5468\u671f\uff0c\u4e14 \\(p+q\\le |S|\\)\uff0c\u90a3\u4e48 \\(\\gcd(p,q)\\) \u540c\u6837\u4e3a \\(S\\) \u7684\u5468\u671f\u3002</p> <p>\u4e0d\u59a8\u94a6\u5b9a \\(p&gt;q\\)\uff0c\u8bbe \\(d=p-q\\)\uff0c\u90a3\u4e48\uff1a</p> <ol> <li>\u82e5 \\(i&gt;q\\)\uff0c\u5219 \\(S[i]=S[i-q]=S[i-q+p]=S[i+d]\\)\u3002</li> <li>\u82e5 \\(i&lt;p\\)\uff0c\u5219 \\(S[i]=S[i+p]=S[i+p-q]=S[i+d]\\)\u3002</li> </ol> <p>\u663e\u7136\u8fd9\u8986\u76d6\u4e86\u6240\u6709\u7684 \\(i\\)\uff0c\u90a3\u4e48 \\(d\\) \u5fc5\u7136\u4e5f\u662f \\(S\\) \u7684\u4e00\u4e2a\u5468\u671f\uff0c\u5982\u6b64\u8f97\u8f6c\u76f8\u51cf\u5373\u6709 \\(\\gcd(p,q)\\) \u4e3a \\(S\\) \u7684\u5468\u671f\u3002</p> <p>\u5468\u671f\u5f15\u7406(Periodicity Lemma, PL):</p> <p>\u82e5 \\(p,q\\) \u4e3a \\(S\\) \u7684\u5468\u671f\uff0c\u4e14 \\(p+q-\\gcd(p,q)\\le |S|\\)\uff0c\u90a3\u4e48 \\(\\gcd(p,q)\\) \u540c\u6837\u4e3a \\(S\\) \u7684\u5468\u671f\u3002</p> <p>\u8bc1\u660e\u4e0d\u4f1a\u3002</p> </li> </ol>"}, {"location": "Algorithms/Strings/Basic-String-Theory/Border_and_Palindrome/#border_1", "title": "Border \u4e0e\u5468\u671f\u7684\u7b49\u5dee\u6570\u5217\u6027\u8d28", "text": "<p>\u6027\u8d28 1:</p> <p>\u82e5 \\(2|S|\\ge |T|\\)\uff0c\u90a3\u4e48 \\(S\\) \u5728 \\(T\\) \u4e2d\u7684\u5339\u914d\u4f4d\u7f6e(\\(T\\) \u4e2d \\(S\\) \u7684\u6240\u6709\u8d77\u70b9)\u7ec4\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002\u82e5\u6b64\u7b49\u5dee\u6570\u5217\u6709\u81f3\u5c11\u4e09\u9879\uff0c\u5219\u516c\u5dee\u4e3a \\(S\\) \u7684\u6700\u5c0f\u5468\u671f\u3002</p> <p>\u9996\u5148\u5c06 \\(T\\) \u524d\uff0c\u540e\u6ca1\u6709\u5339\u914d \\(S\\) \u7684\u90e8\u5206\u53bb\u6389\u3002</p> <p></p> <p>\u7b2c\u4e00\u6761\u7ebf\u4ee3\u8868\u7684\u662f \\(S\\) \u7684\u7b2c\u4e00\u6b21\u5339\u914d\uff0c\u7b2c\u4e09\u6761\u7ebf\u662f\u6700\u540e\u4e00\u6b21\u5339\u914d\uff0c\u4e2d\u95f4\u7684\u7ebf\u662f\u7b2c\u4e8c\u6b21\u5339\u914d\u3002\u663e\u7136\uff0c\\(p,q\\) \u90fd\u662f \\(S\\) \u7684\u5468\u671f\u3002</p> <p>\u7531\u4e8e \\(2|S|\\ge |T|\\)\uff0c\u6211\u4eec\u6709 \\(|S|+p+q=|T|\\)\uff0c\u90a3\u4e48\u5c31\u6709 \\(p+q=|T|-|S|\\le |S|\\)\uff0c\u6839\u636e WPL\uff0c\\(d=\\gcd(p,q)\\) \u540c\u6837\u662f \\(S\\) \u7684\u5468\u671f\u3002</p> <p>\u6211\u4eec\u4e0d\u59a8\u8bbe \\(m\\) \u662f \\(S\\) \u7684\u6700\u5c0f\u5468\u671f\uff0c\u90a3\u4e48 \\(m\\le d\\le p\\le |S_1\\cap S_2|\\)\uff0c\\(m\\) \u5e94\u5f53\u4e3a \\(S_1\\cup S_2\\) \u7684\u5468\u671f\u3002\u90a3\u4e48\u5982\u679c \\(m&lt;p\\)\uff0c\u5c06 \\(S_1\\) \u53f3\u79fb \\(p\\) \u540c\u6837\u4e5f\u4f1a\u4ea7\u751f\u5339\u914d\uff0c\u4e0e \\(S_2\\) \u662f\u7b2c\u4e8c\u6b21\u5339\u914d\u77db\u76fe\u3002\u90a3\u4e48\u5c31\u5fc5\u7136\u6709 \\(p\\) \u662f\u6700\u5c0f\u7684\u5468\u671f\u3002</p> <p>\u6240\u4ee5 \\(\\gcd(p,q)=d=p\\)\uff0c\u5373 \\(p\\mid q\\)\u3002\u6240\u4ee5\u7b2c\u4e00\u4e2a\u95f4\u9694 \\(p\\) \u5c31\u4e00\u5b9a\u662f \\(S\\) \u7684\u6700\u5c0f\u5468\u671f\u3002</p> <p>\u4e0d\u96be\u53d1\u73b0\u4ee5\u4e0a\u63a8\u7406\u6ca1\u6709\u7528\u5230 \\(S_1\\) \u662f\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u6027\u8d28\uff0c\u5982\u6b64\u5373\u53ef\u63a8\u7406\u5f97\u4efb\u4f55\u4e00\u4e2a\u95f4\u9694\u90fd\u5fc5\u5b9a\u662f \\(S\\) \u7684\u6700\u5c0f\u5468\u671f\u3002\u6240\u4ee5\u6240\u6709\u5339\u914d\u4f4d\u7f6e\u4e00\u5b9a\u7ec4\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u6027\u8d28 2:</p> <p>\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u6240\u6709 \\(\\bd\\) \u7684\u957f\u5ea6\u6784\u6210 \\(\\mathcal O(\\log n)\\) \u4e2a\u7b49\u5dee\u6570\u5217\u3002\u5177\u4f53\u5730\uff0c\u8bbe \\(2^k\\) \u662f \\(&lt;|S|\\) \u7684\u6700\u5927\u7684 \\(2\\) \u7684\u5e42\uff0c\u957f\u5ea6\u5728\u533a\u95f4 \\([2^0,2^1)\\) \u5185\u7684 \\(\\bd\\) \u957f\u5ea6\u6784\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\\([2^1,2^2)\\) \u7684\u6784\u6210\u53e6\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u2026\u2026\u6700\u540e\u957f\u5ea6\u5728\u533a\u95f4 \\([2^k,|S|)\\) \u5185\u7684 \\(\\bd\\) \u6784\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u4e3a\u4e86\u8bc1\u660e\u6b64\u6027\u8d28\uff0c\u6211\u4eec\u5148\u8bc1\u660e\u4e00\u4e2a\u5f15\u7406\u3002</p> <p>\u5f15\u7406\uff1a</p> <p>\u5bf9\u4e8e\u5b57\u7b26\u4e32 \\(S\\)\uff0c\u5176\u957f\u5ea6 \\(\\ge \\frac{|S|}{2}\\) \u7684 \\(\\bd\\) \u957f\u5ea6\u6784\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e\u6240\u6709 \\(\\le \\frac{|S|}{2}\\) \u7684\u5468\u671f\u6784\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u8bbe\u5b57\u7b26\u4e32 \\(S\\) \u7684\u6700\u77ed\u5468\u671f\u4e3a \\(p\\)\uff0c\u53e6\u6709\u4e00\u5468\u671f \\(q\\) \u6ee1\u8db3\u5176\u662f\u6240\u6709 \\(\\le \\frac{|S|}{2}\\) \u7684\u5468\u671f\u4e2d\u6700\u5927\u7684\u4e00\u4e2a\uff0c\u90a3\u4e48 \\(|S|-p,|S|-q\\) \u5206\u522b\u662f\u67d0 \\(\\bd\\) \u7684\u957f\u5ea6\uff0c\u6839\u636e  WPL\uff0c\u6211\u4eec\u53c8\u6709 \\(\\gcd(p,q)\\) \u662f \\(S\\) \u7684\u4e00\u4e2a\u5468\u671f\u3002\u56e0\u4e3a \\(\\gcd(p,q)\\le p\\)\uff0c\u800c \\(p\\) \u53c8\u662f\u6700\u77ed\u5468\u671f\uff0c\u90a3\u5fc5\u7136\u5c31\u53ea\u80fd\u6709 \\(p\\mid q\\)\u3002\u6839\u636e\u5468\u671f\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u77e5\u9053 \\(p\\) \u662f\u5468\u671f\uff0c\\(2p\\) \u662f\u5468\u671f\uff0c\u2026\u2026\uff0c\\((\\frac{q}{p}-1)p\\) \u662f\u5468\u671f\uff0c\\(q\\) \u662f\u5468\u671f\uff0c\u6240\u4ee5\u5b83\u4eec\u7ec4\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u6211\u4eec\u53c8\u80fd\u8bc1\u660e\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u5468\u671f \\(q\\le \\frac{|S|}{2}\\)\uff0c\u5747\u6ee1\u8db3 \\(p\\mid q\\)\uff0c\u6240\u4ee5\u8fd9\u5c31\u662f\u6240\u6709\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e \\(\\frac{|S|}{2}\\) \u7684\u5468\u671f\u3002</p> <p>\u63a5\u4e0b\u6765\u7684\u8bc1\u660e\u5c31\u975e\u5e38\u5e73\u51e1\u4e86\uff01</p> <p>\u9996\u5148 \\([2^k,n)\\) \u7684\u90e8\u5206\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\uff0c\u56e0\u4e3a \\(\\frac{|S|}{2}\\le 2^k\\)\u3002</p> <p>\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u662f\u5bf9\u4efb\u610f\u4e00\u4e2a \\(x&lt;k\\)\uff0c\u90fd\u6709\u957f\u5ea6\u5728 \\([2^x,2^{x+1})\\) \u7684 \\(\\bd\\) \u957f\u5ea6\u6784\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u4e0d\u59a8\u8bbe\u5176\u4e2d\u957f\u5ea6\u6700\u5927\u7684 \\(\\bd\\) \u957f\u5ea6\u4e3a \\(l\\)\uff0c\u5219\u6240\u6709\u539f\u4e32\u4e2d\u957f\u5ea6 \\(&lt;2^{x+1}\\) \u7684 \\(\\bd\\) \u8981\u4e48\u662f\u8fd9\u4e2a\u6700\u5927\u7684 \\(\\bd\\)\uff0c\u8981\u4e48\u662f\u8fd9\u4e2a\u6700\u5927 \\(\\bd\\) \u7684 \\(\\bd\\)\u3002</p> <p>\u5bf9\u8fd9\u4e2a\u957f\u5ea6\u4e3a \\(l\\) \u7684 \\(\\bd\\) \u65bd\u7528\u5f15\u7406\uff0c\u6240\u6709\u957f\u5ea6\u5728 \\([\\frac{l}{2},l)\\) \u7684 \\(\\bd\\) \u957f\u5ea6\u53c8\u6784\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\u6839\u636e\u5f15\u7406\uff0c\u957f\u5ea6\u7684\u516c\u5dee\u4e3a\u6700\u957f \\(\\bd\\) \u7684\u5468\u671f\uff0c\u6240\u4ee5 \\(l\\) \u53ef\u4ee5\u653e\u5728\u8fd9\u4e2a\u7b49\u5dee\u6570\u5217\u7684\u672b\u5c3e\u3002\u56e0\u4e3a \\(\\frac{l}{2}\\le 2^x\\)\uff0c\u6240\u4ee5\u957f\u5ea6\u5728 \\([2^x,2^{x+1}]\\) \u4e4b\u95f4\u7684 \\(\\bd\\) \u53c8\u6784\u6210\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u8fd8\u6709\u4e00\u4e2a\u6027\u8d28\uff1a</p> <p>\u6027\u8d28 3:</p> <p>\u5bf9\u4e8e\u5b57\u7b26\u4e32 \\(S\\)\uff0c\u5176\u516c\u5dee \\(\\ge d\\) \u7684 \\(\\bd\\) \u7b49\u5dee\u5e8f\u5217\u603b\u957f\u662f \\(\\mathcal O\\qty(\\frac{|S|}{d})\\)\u3002</p> <p>\u8bc1\u660e\u4e0d\u4f1a\u3002</p>"}, {"location": "Algorithms/Strings/Basic-String-Theory/Border_and_Palindrome/#_1", "title": "\u5e94\u7528", "text": ""}, {"location": "Algorithms/Strings/Basic-String-Theory/Border_and_Palindrome/#wc2016", "title": "[WC2016] \u8bba\u6218\u6346\u7af9\u7aff", "text": "<p>\u9996\u5148\u663e\u7136\u9664\u4e86\u7b2c\u4e00\u6b65\u5fc5\u987b\u5ef6\u5c55 \\(n\\) \u4ee5\u5916\uff0c\u5176\u4ed6\u90fd\u53ef\u4ee5\u5ef6\u5c55 \\(S\\) \u7684\u4e00\u4e2a\u5468\u671f\u7684\u957f\u5ea6\uff0c\u4f60\u53ef\u4ee5\u5ef6\u5c55\u4efb\u610f\u591a\u6b21\uff0c\u95ee \\([0,w-n]\\) \u91cc\u6709\u54ea\u4e9b\u6570\u662f\u53ef\u4ee5\u88ab\u51d1\u51fa\u6765\u7684\u3002</p> <p>\u663e\u7136\u95ee\u9898\u5c31\u662f\u5b8c\u5168\u80cc\u5305\uff0c\u56e0\u4e3a \\(w\\) \u5f88\u5927\u6240\u4ee5\u4e0a\u4e2a\u540c\u4f59\u6700\u77ed\u8def\u3002</p> <p>\u590d\u6742\u5ea6\u662f\u6700\u5c0f\u5468\u671f\u957f\u5ea6\u4e58\u5468\u671f\u6570\u91cf\uff0c\u663e\u7136\u662f \\(\\mathcal O(n^2)\\)\u3002</p> <p>\u8003\u8651\u600e\u4e48\u4f18\u5316\uff0c\u663e\u7136\u6240\u6709\u5468\u671f\u6784\u6210 \\(\\mathcal O(\\log n)\\) \u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u663e\u7136\u8003\u8651\u5bf9\u6bcf\u4e2a\u7b49\u5dee\u6570\u5217\u5355\u72ec\u5904\u7406\uff0c\u4e0d\u59a8\u8bbe\u5f53\u524d\u7b49\u5dee\u6570\u5217\u662f \\(l_i,l_i+d_i,l_i+2d_i,\\cdots, l_i+kd_i\\)\u3002\u6211\u4eec\u5728\u6a21 \\(l_i\\) \u7684\u610f\u4e49\u4e0b\u5904\u7406\u8fd9\u4e2a\u7b49\u5dee\u6570\u5217\u3002</p> <p>\u5f53\u7136\u5904\u7406\u7684\u65b9\u6cd5\u4e0d\u53ef\u80fd\u662f\u628a\u8fd9\u91cc\u9762\u6bcf\u4e2a\u4e1c\u897f\u90fd\u585e\u8fdb\u53bb\u8f6c\u79fb\u4e00\u904d\u3002\u8003\u8651\u4ee4 \\(x\\rightarrow x+d_i\\) \u8fde\u8fb9\u4f1a\u5f62\u6210 \\(\\gcd(l_i,d_i)\\) \u4e2a\u73af\u3002\u4e0d\u7ba1\u7528\u54ea\u4e2a \\(l_i+pd_i\\) \u8f6c\u79fb\uff0c\u90fd\u4e0d\u53ef\u80fd\u5728\u4e24\u4e2a\u73af\u4e4b\u95f4\u76f8\u4e92\u8f6c\u79fb\u3002</p> <p>\u5bf9\u6bcf\u4e2a\u73af\u5355\u72ec\u8003\u8651\uff0c\u73af\u91cc\u7684\u6700\u5c0f\u503c\u4e0d\u4f1a\u88ab\u4efb\u4f55\u4e00\u4e2a\u5176\u4ed6\u70b9\u8f6c\u79fb\u5230\u3002\u6211\u4eec\u4ece\u6700\u5c0f\u503c\u5f00\u59cb\uff0c\u8f6c\u4e24\u5708\u3002\u5177\u4f53\u7684\u8bf4\uff0c\u6211\u4eec\u4ece\u6700\u5c0f\u503c\u5f00\u59cb\uff08\u8bbe\u5176\u5bf9\u5e94\u7684\u662f\u6a21 \\(l_i\\) \u4e0b\u7684 \\(s\\)\uff09\uff0c\u65ad\u73af\u6210\u94fe\uff0c\u94fe\u4e0a\u7684\u6bcf\u4e2a\u4f4d\u7f6e \\(q\\) \u4ee3\u8868 \\((s+qd)\\bmod l_i\\)\uff0c\u6bcf\u4e2a\u4f4d\u7f6e \\(x\\) \u53ef\u4ee5\u88ab\u4ece \\(x-p\\) \u7528 \\(l_i+pd\\) \u7684\u4ee3\u4ef7\u8f6c\u79fb\u8fc7\u6765\uff0c\u6b64\u5904 \\(0\\le p\\le k\\)\u3002\u5355\u8c03\u961f\u5217\u4f18\u5316\u5373\u53ef\u3002</p> <p>\u90a3\u4e48\u95ee\u9898\u5c31\u662f\u600e\u4e48\u4ece\u6a21 \\(l_i\\) \u8f6c\u79fb\u5230\u6a21 \\(l_j\\) \u4e86\u3002\u8bbe \\(f_{p,x}\\) \u6a21 \\(p\\) \u610f\u4e49\u4e0b\u6700\u5c0f\u7684\uff0c\u540c\u4f59 \\(x\\) \u7684\u6570\uff0c\u90a3\u4e48 \\(f_{l_j,x}=\\displaystyle\\min_{f_{l_i,y}\\bmod l_j=x}f_{l_i,y}\\)\u3002\u7136\u540e\u539f\u5148\u6240\u6709\u6a21 \\(l_i\\) \u76f8\u540c\u7684\u90fd\u89c6\u4e3a\u662f\u540c\u4e00\u4e2a\u72b6\u6001\uff0c\u6240\u4ee5\u8fd8\u8981\u518d\u5f80\u540c\u4f59\u6700\u77ed\u8def\u91cc\u52a0\u4e00\u4e2a\u7269\u54c1 \\(l_i\\)\u3002</p>"}, {"location": "Algorithms/Strings/Basic-String-Theory/Z-function/", "title": "Z function", "text": "<p>\u672c\u6587 \\(\\text{0-indexed}\\)\u3002</p>"}, {"location": "Algorithms/Strings/Basic-String-Theory/Z-function/#z", "title": "Z \u51fd\u6570", "text": "<p>\u7ed9\u5b9a\u4e00\u4e2a\u4e32 \\(s\\)\uff0c\u5176 Z \u51fd\u6570 \\(z_i=\\left|\\operatorname{LCP}(\\operatorname{suf}(i), s)\\right|\\)\uff0c\u7279\u522b\u5730 \\(z_0=0\\)\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/", "title": "EX exercise", "text": "<p>\u5207\u308a\u958b\u3051 Star Divine</p> <p>\u8b72\u308c\u306a\u3044\u672a\u6765\u3078</p> <p>\u8ca0\u3051\u306a\u3044\u3067 Star Divine</p> <p>\u672a\u6765\u3092\u898b\u6368\u3066\u306a\u3044\u3067</p> <p>\u7acb\u3061\u4e0a\u304c\u308c Star Divine</p> <p>\u4f55\u5ea6\u50b7\u3064\u3044\u3066\u3082</p> <p>\u821e\u53f0\u306b\u751f\u304b\u3055\u308c\u3066\u3044\u308b</p> <p>\u5207\u3063\u5148\u306b\u6804\u5149\u6b62\u307e\u308c</p> \\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\Endpos{\\operatorname{Endpos}} \\newcommand\\Startpos{\\operatorname{Startpos}} \\newcommand\\height{\\operatorname{height}} \\newcommand\\SA{\\operatorname{SA}} \\newcommand\\len{\\operatorname{len}} \\newcommand\\chkmax{\\operatorname{chkmax}} \\newcommand\\chkmin{\\operatorname{chkmin}} \\newcommand\\siz{\\operatorname{siz}} \\newcommand\\fa{\\operatorname{fa}} \\newcommand\\LCP{\\operatorname{LCP}} \\] <p>\u9664\u4e86\u4e00\u4e9b\u6bd4\u8f83\u91cd\u8981\u7684 Trick\uff0c\u57fa\u672c\u662f SAM \u548c SA \u968f\u673a\u9009\u62e9\u4e00\u4e2a\u505a\u7684\u3002</p> <p>\u53c2\u8003\u8d44\u6599\uff1a</p> <ul> <li>\u5b57\u7b26\u4e32\u57fa\u7840 - qAlex_Weiq</li> <li>\u540e\u7f00\u81ea\u52a8\u673a\u5b66\u4e60\u7b14\u8bb0(\u5e94\u7528\u7bc7) - command_block</li> <li>\u4f60\u559c\u6b22\u505a\u5b57\u7b26\u4e32\u5de5\u4e1a\u9898\u5417\uff1f - MaxBlazeResFire</li> </ul>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#_1", "title": "\u57fa\u7840\u5185\u5bb9", "text": ""}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#p2408", "title": "P2408 \u4e0d\u540c\u5b50\u4e32\u4e2a\u6570", "text": ""}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#sa", "title": "SA", "text": "<p>\u5efa\u51fa \\(\\SA\\) \u548c \\(\\height\\)\uff0c\u5728 \\(\\SA\\) \u4e0a\u626b\u4e00\u904d\uff0c\u8003\u8651 \\(\\SA(i)\\) \u548c \\(\\SA(i-1)\\) \u7684\u91cd\u5408\u60c5\u51b5\uff0c\u53ea\u6709 \\(\\height(i)\\) \u4e2a\u5b50\u4e32\u662f\u91cd\u590d\u7684\uff0c\u52a0\u4e0a \\(n-\\SA(i)+1-\\height(i)\\) \u5373\u53ef\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#sam", "title": "SAM", "text": "<p>\u663e\u7136\u8fd9\u662f SAM \u7684 DAG \u4e0a\u4ece\u6839\u8282\u70b9\u51fa\u53d1\u7684\u8def\u5f84\u6570\u3002\u4e5f\u662f Link \u6811\u7684 \\(\\displaystyle\\sum_{u}\\len(u)-\\len(\\fa (u))\\)\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#p2178-noi2015", "title": "P2178 [NOI2015] \u54c1\u9152\u5927\u4f1a", "text": ""}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#sa_1", "title": "SA", "text": "<p>\u6211\u4eec\u5012\u5e8f\u6c42\u51fa\u6240\u6709\u7b54\u6848\uff0c\u6309 \\(\\height\\) \u4ece\u5927\u5230\u5c0f\u626b\u63cf\uff0c\u5047\u8bbe\u5f53\u524d\u7684\u4e3a \\(k\\)\uff0c\u90a3\u4e48\u53ea\u4fdd\u7559\u6240\u6709 \\(\\height(i)=k\\) \u7684\u6240\u6709\u4f4d\u7f6e \\(i\\)\uff0c\u4ee4\u8fd9\u4e9b\u4f4d\u7f6e\u7684 \\(\\SA(i)\\) \u4e0e \\(\\SA(i-1)\\) \u8fde\u8fb9\u3002\u6bcf\u4e2a\u8fde\u901a\u5757\u4e2d\u4e24\u4e2a\u70b9 \\(p,q\\) \u4e00\u5b9a\u90fd\u662f \\(k\\) \u76f8\u4f3c\u7684\u3002\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u5373\u53ef\uff0c\u5bf9\u6bcf\u4e2a\u8fde\u901a\u5757\u7ef4\u62a4\u6700\u5927\uff0c\u6700\u5c0f\uff0c\u6b21\u5927\uff0c\u6b21\u5c0f\uff0c\u5269\u4e0b\u7684\u90fd\u662f\u5bb9\u6613\u7684\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#sam_1", "title": "SAM", "text": "<p>\u9996\u5148\u5efa\u51fa\u540e\u7f00\u6811\u3002\u5728\u540e\u7f00\u6811\u4e0a DFS\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9 \\(u\\)\uff0c\\(u\\) \u5b50\u6811\u5185\u7684\u6240\u6709\u540e\u7f00\u4e00\u5b9a\u81f3\u591a\u662f \\(\\len(u)\\) \u76f8\u4f3c\u7684\u3002</p> <p>\u6211\u4eec\u53ea\u9700\u8981\u5bf9 \\([\\len(fa_u)+1,\\len(u)]\\) \u8fd9\u4e2a\u533a\u95f4\u66f4\u65b0\u7b54\u6848\uff0c\u5269\u4e0b\u7684\u4f1a\u5728\u4e0a\u9762\u66f4\u65b0\u3002\u66f4\u65b0\u5b9e\u9645\u4e0a\u5c31\u662f\u533a\u95f4 \\(\\chkmax\\) \u548c\u533a\u95f4\u52a0 \\(\\dfrac{\\siz(u)(\\siz(u)-1)}{2}\\)\u3002\u7ebf\u6bb5\u6811\u7ef4\u62a4\u5373\u53ef\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#p4070-sdoi2016", "title": "P4070 [SDOI2016] \u751f\u6210\u9b54\u5492", "text": "<p>SAM \u505a\u6cd5\u662f\u5e73\u51e1\u7684\uff0c\u6211\u4eec\u6765\u8ba8\u8bba SA \u7684\u505a\u6cd5\u3002</p> <p>\u5c1d\u8bd5\u7167\u642c P2408 \u7684\u505a\u6cd5\uff0c\u4ece\u524d\u5f80\u540e\u52a0\u5165\u5b57\u7b26\uff0c\u7b54\u6848\u662f \\(\\displaystyle\\sum_{i=1}^n\\displaystyle n-\\SA(i)+1-\\height(i)\\)\u3002</p> <p>\u6211\u4eec\u7684\u505a\u6cd5\u662f\u5c1d\u8bd5\u5728\u539f\u6765\u7684\u5e8f\u5217\u4e0a\u6309 \\(1\\sim n\\) \u626b\u4e00\u904d\uff0c\u6bcf\u6b21\u628a \\(\\SA\\) \u4e0a\u7684 \\(\\rank(i)\\) \u8bbe\u7f6e\u4e3a\u53ef\u7528\u7684\uff0c\u7136\u540e\u8ba1\u7b97 \\(\\rank(i)\\) \u7684\u524d\u9a71\u548c\u540e\u7ee7\u7684\u8d21\u732e\u3002</p> <p>\u8fd9\u4e2a\u505a\u6cd5\u770b\u8d77\u6765\u6ca1\u4ec0\u4e48\u95ee\u9898\uff0c\u4f46\u662f\u968f\u7740\u5b57\u7b26\u4e32\u4e0d\u65ad\u5411\u540e\u6dfb\u52a0\u5b57\u7b26\uff0c\u6709\u4e9b\u4f4d\u7f6e\u7684 \\(\\height\\) \u4e5f\u4f1a\u53d1\u751f\u53d8\u5316\u3002</p> <p>\u8003\u8651\u4ece\u540e\u5f80\u524d\u6dfb\u52a0\u5b57\u7b26\uff0c\u8fd9\u6837\u6bcf\u4e2a\u4f4d\u7f6e\u88ab\u6dfb\u52a0\u8fdb\u6765\u65f6\uff0c\u540e\u7f00\u7684\u6240\u6709\u5b57\u7b26\u4e5f\u88ab\u6dfb\u52a0\u8fdb\u6765\u4e86\uff0c\\(\\height\\) \u5c31\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u3002</p> <p>\u6211\u4eec\u628a\u539f\u4e32 \\(S\\) \u7ffb\u8f6c\uff0c\u4ece \\(n\\rightarrow 1\\) \u9010\u4e2a\u6dfb\u52a0\u5b57\u7b26\uff0c\u8ba1\u7b97 \\(\\rank(i)\\) \u548c\u524d\u9a71\u540e\u7ee7\u7684\u8d21\u732e\u5373\u53ef\u3002</p> <p>\u63d0\u4ea4\u8bb0\u5f55 #2213380 - LibreOJ</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#p5341-tjoi2019", "title": "P5341 [TJOI2019] \u7532\u82ef\u5148\u751f\u548c\u5927\u4e2d\u950b\u7684\u5b57\u7b26\u4e32", "text": "<p>\u540e\u7f00\u6811\u505a\u6cd5\u540c\u6837\u662f\u7b80\u5355\u7684\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#sa_2", "title": "SA", "text": "<p>\u8ba8\u8bba \\(k\\ge 2\\) \u7684\u60c5\u51b5\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u5b50\u4e32\u6070\u597d\u51fa\u73b0 \\(k\\) \u6b21\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b50\u4e32\u7684 \\(\\Startpos\\) \u96c6\u5408\u5728 \\(\\SA\\) \u4e0a\u4e00\u5b9a\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a \\(k\\) \u7684\u533a\u95f4\u3002</p> <p>\u8003\u8651\u679a\u4e3e\u4e00\u4e2a\u957f\u5ea6\u4e3a \\(k\\) \u7684\u533a\u95f4\uff0c\u8ba1\u7b97 \\(\\Startpos\\) \u96c6\u5408\u6070\u597d\u4e3a\u8fd9\u4e2a\u533a\u95f4\u7684\u5b50\u4e32\u7684\u8d21\u732e\uff0c\u8bbe\u533a\u95f4\u4e3a \\([l,r]\\)\uff0c\u5219\u6240\u6709 \\(\\Startpos\\) \u96c6\u5408\u4e3a\u8fd9\u4e2a\u533a\u95f4\uff0c\u957f\u5ea6 \\(L\\) \u6ee1\u8db3\uff1a $$ \\max(\\height(l),\\height(r+1))+1\\le L\\le \\min_{l+1}^{r}{\\height(i)} $$ \u7684\u5b50\u4e32\u90fd\u5728\u5e8f\u5217\u4e2d\u6070\u597d\u51fa\u73b0\u4e86 \\(k\\) \u6b21\u3002</p> <p>\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u6ed1\u52a8\u7a97\u53e3\u5373\u53ef \\(\\mathcal O(T(n+|\\Sigma|))\\)\u3002</p> <p>\u63d0\u4ea4\u8bb0\u5f55 #2213732 - LibreOJ</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#jzpgyz-sevenk-love-oimaster", "title": "JZPGYZ - Sevenk Love Oimaster", "text": ""}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#sam_2", "title": "SAM", "text": "<p>\u9996\u5148\u5efa\u51fa\u6a21\u677f\u4e32\u7684\u5e7f\u4e49 SAM\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u4e32\uff0c\u5728\u5e7f\u4e49 SAM \u4e0a\u6cbf\u7740\u8f6c\u79fb\u8fb9\u8f6c\u79fb\uff0c\u6240\u5230\u7684\u8282\u70b9\u4ee3\u8868\u7684 \\(\\Endpos\\) \u96c6\u5408\u5c31\u662f\u8fd9\u4e2a\u5b50\u4e32\u51fa\u73b0\u4f4d\u7f6e\u7684 \\(\\Endpos\\) \u96c6\u5408\u3002\u6211\u4eec\u53ea\u9700\u8981\u6570\u8fd9\u4e9b \\(\\Endpos\\) \u6765\u81ea\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u4e32\u5373\u53ef\uff0c\u5373\u5b50\u6811\u6570\u989c\u8272\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#sa_3", "title": "SA", "text": "<p>\u9996\u5148\u7528\u5206\u5272\u7b26\u628a\u6240\u6709\u5b57\u7b26\u4e32\u4e32\u5728\u4e00\u8d77\uff0c\u5bf9\u6574\u4e2a\u4e32\u5efa SA\uff0c\u5bf9\u7b2c \\(i\\) \u4e2a\u8be2\u95ee\u4e32 \\(t_i\\)\uff0c\u8bbe\u5176\u5f00\u5934\u5728\u6574\u4e2a\u4e32\u4e2d\u7684\u4f4d\u7f6e\u4e3a \\(p_i\\)\u3002</p> <p>\u8be5\u8be2\u95ee\u4e32\u4e3a\u67d0\u4e2a\u6a21\u677f\u4e32\u7684\u5b50\u4e32\u7684\u6761\u4ef6\u662f\uff0c\u4e0e\u8be5\u6a21\u677f\u4e32\u7684\u67d0\u4e2a\u540e\u7f00 \\(\\LCP\\) \u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e\u81ea\u8eab\u3002</p> <p>\u6211\u4eec\u627e\u5230 \\(\\rank(p_i)\\) \u524d\u540e\u7b2c\u4e00\u4e2a \\(\\height\\) \u5c0f\u4e8e \\(\\len(t_i)\\) \u7684\uff0c\u5b83\u4eec\u4e2d\u6240\u5939\u7684\u8fd9\u4e2a\u533a\u95f4\u5c31\u662f\u4e0e \\(t_i\\) \u7684 \\(\\LCP\\) \u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e\u81ea\u8eab\u7684\u540e\u7f00\uff0c\u6211\u4eec\u53ea\u8981\u6570\u51fa\u8fd9\u4e9b\u540e\u7f00\u6765\u81ea\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u6a21\u677f\u4e32\u5373\u53ef\uff0c\u5373\u533a\u95f4\u6570\u989c\u8272\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#p3975-tjoi2015", "title": "P3975 [TJOI2015] \u5f26\u8bba", "text": ""}, {"location": "Algorithms/Strings/Suffix-Structures/EX_exercise/#sa_4", "title": "SA", "text": "<p>\u6765\u70b9\u7eaf\u6b63 \\(\\mathcal O(n)\\) \u505a\u6cd5\uff01</p> <p>\u9996\u5148 \\(t=0\\) \u4f1a\u505a\u672c\u8d28\u4e0d\u540c\u5b50\u4e32\u4e2a\u6570\u7684\u90fd\u4f1a\u3002\u63a5\u4e0b\u6765\u8ba8\u8bba \\(t=1\\) \u600e\u4e48\u505a\u3002</p> <p>\u6839\u636e\u672c\u8d28\u4e0d\u540c\u5b50\u4e32\u4e2a\u6570\u7684\u7ecf\u9a8c\uff0c\\(\\SA(i)\\) \u540e\u7f00\u4e2d\uff0c\u957f\u5ea6 \\(&gt;\\height(i)\\) \u7684\u524d\u7f00\u624d\u662f\u65b0\u51fa\u73b0\u7684\u5b50\u4e32\u3002</p> <p>\u4ece\u5c0f\u5230\u5927\u626b\u63cf\u6574\u4e2a \\(\\SA\\)\uff0c\u5728\u6bcf\u4e2a\u5b50\u4e32\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u65f6\u5019\u7edf\u8ba1\u8d21\u732e\u3002</p> <p>\u6211\u4eec\u7ef4\u62a4\u6bcf\u4e2a\u70b9\u5411\u53f3 \\(\\height\\) \u7684\u5355\u8c03\u6808\uff0c\u628a\u8fd9\u4e9b\u5355\u8c03\u6808\u753b\u51fa\u6765\uff1a</p> <p></p> <p>\u6bd4\u5982\u9ed1\u7ebf\u5904\u7684\u5355\u8c03\u6808\u4e3a\u7ea2\u7ebf\u8fd9\u4e00\u6761\uff0c\u5411\u53f3\u79fb\u52a8\u5230\u7eff\u8272\u7684\u4f4d\u7f6e\uff0c\u6709\u82e5\u5e72\u4e2a\u539f\u5148\u88ab\u5220\u6389\u7684\u4f4d\u7f6e\u6062\u590d\u4e86\uff0c\u7ea2-\u84dd\u7ebf\u5939\u7740\u7684\u8fd9\u90e8\u5206\u4f4d\u7f6e\u5bf9\u5e94\u7684\u5b50\u4e32\u5c31\u662f\u4e4b\u524d\u6ca1\u6709\u88ab\u7edf\u8ba1\u8fc7\u7684\uff0c\u4e5f\u5c31\u662f\u7eff\u7ebf\u4ee3\u8868\u7684\u4e32\u957f\u5ea6 \\(&gt;\\height\\) \u7684\u90e8\u5206\u3002\u8fd9\u90e8\u5206\u7684\u9762\u79ef \\(p\\) \u5c31\u662f\u65b0\u7684\u5b50\u4e32\u4e2a\u6570\u3002</p> <p>\u5982\u679c \\(k\\le p\\)\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u6240\u6c42\u7684\u5b50\u4e32\u6b63\u662f\u843d\u5728\u8fd9\u4e00\u7ec4\u65b0\u589e\u7684\u9762\u79ef\u4e4b\u4e2d\u3002\u679a\u4e3e\u5355\u8c03\u6808\u91cc\u7684\u5143\u7d20\u5c31\u80fd\u627e\u51fa\u6240\u6c42\u7684\u5b50\u4e32\u3002\u5426\u5219\uff0c\u4ee4 \\(k\\leftarrow k-p\\)\uff0c\u5728\u679a\u4e3e\u7684\u4e32\u4e2d\u7ee7\u7eed\u53f3\u79fb\u3002</p> <p>\u63d0\u4ea4\u8bb0\u5f55 #2216286 - LibreOJ</p> <p>\u6253\u4e0d\u8fc7 \\(\\mathcal O(n\\log n)\\)\uff0c\u6004\u706b\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SAM/", "title": "SAM", "text": "<p>\u305d\u3093\u306a\u660e\u65e5\u304c\u6765\u305f\u306a\u3089</p> <p>\u5982\u679c\u6709\u90a3\u4e48\u4e00\u5929\u7684\u8bdd</p> <p>\u713c\u304d\u5c3d\u304f\u3057\u3066\u5f57\u661f\u3088</p> <p>\u5f57\u661f\u554a\uff0c\u70e7\u5c3d\u4e00\u5207\u5427</p> \\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\] <p>\u5e76\u4e0d\u63a8\u8350\u9605\u8bfb\u672c\u6587\uff0c\u672c\u6587\u8d28\u91cf\u975e\u5e38\u5dee\uff0c\u672c\u6587\u4ec5\u4f5c\u5907\u5fd8\uff0c\u8bf7\u9605\u8bfb CMD \u7684\u6587\u7ae0\u3002</p> <p>\u6284\u5199\u81ea \u540e\u7f00\u81ea\u52a8\u673a(\u5e72\u8d27\u7bc7) - Command_Block\u3002</p> <p>\u5176\u5b9e\u6211\u89c9\u5f97\u5e94\u8be5\u5148\u5b66\u540e\u7f00\u6811\u518d\u5b66\u8fd9\u73a9\u610f\u3002</p> <p>SAM \u662f\u4e00\u4e2a\u53ef\u4ee5\u63a5\u53d7\u5b57\u7b26\u4e32 \\(s\\) \u6240\u6709\u5b50\u4e32\u7684\u6700\u5c0f\u81ea\u52a8\u673a\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SAM/#endpos", "title": "Endpos \u96c6\u5408", "text": "<p>\u6211\u4eec\u79f0 \\(s\\) \u7684\u67d0\u4e2a\u5b50\u4e32\u7684 \\(\\text{Endpos}\\) \u96c6\u5408\uff0c\u662f \\(s\\) \u4e3a\u540e\u7f00\u7684\u524d\u7f00\u7ec8\u70b9\u7684\u96c6\u5408\uff0c\u6216\u8005\u8bf4 \\(s\\) \u5728\u539f\u4e32\u4e2d\u7684\u7ec8\u6b62\u4f4d\u7f6e\u7684\u96c6\u5408\uff0c\u8bb0\u4f5c \\(\\edp(s)\\)\u3002</p> <p>\u4f8b\u5982\uff0c\u5728 \\(\\texttt{abbaab}\\) \u4e2d\uff0c\u5219 \\(\\edp(\\texttt{ab})\\) \u662f \\(\\{2,6\\}\\)\uff0c\u800c \\(\\edp(\\texttt{a})\\) \u662f \\(\\{1,4,5\\}\\)\u3002</p> <p>\u6211\u4eec\u79f0\u6240\u6709 \\(\\text{Endpos}\\) \u96c6\u5408\u76f8\u540c\u7684\u5b50\u4e32\u7ec4\u6210\u7684\u96c6\u5408\u4e3a\u4e00\u4e2a \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SAM/#_1", "title": "\u6027\u8d28", "text": "<ol> <li> <p>\u5bf9\u4e8e\u4e24\u4e2a\u5b50\u4e32 \\(s_1,s_2\\)\uff0c\u82e5 \\(s_1\\) \u662f \\(s_2\\) \u7684\u4e00\u4e2a\u540e\u7f00\uff0c\u90a3\u4e48 \\(\\edp(s_2)\\subseteq \\edp(s_1)\\)\u3002</p> <p>Proof: \u8003\u8651\u6240\u6709 \\(s_2\\) \u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\\(s_1\\) \u90fd\u4e00\u5b9a\u4f1a\u51fa\u73b0\uff0c\u6ce8\u610f\u53cd\u4e4b\u5219\u4e0d\u7136\u3002</p> </li> <li> <p>\u82e5\u4e24\u4e2a\u5b50\u4e32 \\(s_1,s_2\\) \u6709 \\(\\edp(s_1)\\cap \\edp(s_2)\\neq \\varnothing\\)\uff0c\u90a3\u4e48\u5fc5\u7136\u6709\u4e00\u4e2a\u662f\u53e6\u4e00\u4e2a\u7684\u540e\u7f00\u3002</p> <p>Proof: \u56e0\u4e3a\u4e24\u8005 \\(\\text{Endpos}\\) \u96c6\u5408\u6709\u4ea4\uff0c\u6240\u4ee5\u5fc5\u7136\u6709\u67d0\u4e2a\u5730\u65b9\u4e24\u8005\u540c\u65f6\u51fa\u73b0\uff0c\u5219\u4e00\u8005\u4e3a\u53e6\u4e00\u8005\u7684\u540e\u7f00\u3002</p> </li> <li> <p>\u5728\u4e00\u4e2a \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u4e2d\uff0c\u6240\u6709\u7684\u4e32\u5fc5\u4e3a\u6700\u957f\u4e32\u7684\u540e\u7f00\uff0c\u4e14\u8bbe\u6700\u77ed\u4e32\u957f\u5ea6\u4e3a \\(l\\)\uff0c\u6700\u957f\u4e32\u7684\u957f\u5ea6\u4e3a \\(r\\)\uff0c\u5219\u7b49\u4ef7\u7c7b\u5927\u5c0f\u4e3a \\(r-l+1\\)\uff0c\u4e14\u5bf9\u4e8e\u6bcf\u4e2a \\(k\\in [l,r]\\)\uff0c\u5747\u6070\u6709\u4e00\u4e2a\u5b50\u4e32\u957f\u5ea6\u4e3a \\(k\\)\u3002</p> <p>Proof: \u7531 \\(2\\) \u663e\u7136\u53ef\u4ee5\u5f97\u5230\u6240\u6709\u4e32\u90fd\u662f\u6700\u957f\u4e32\u7684\u540e\u7f00\uff0c\u8bbe\u957f\u5ea6\u6700\u77ed\u7684\u5b50\u4e32\u4e3a \\(t_l\\)\uff0c\u6700\u5927\u7684\u4e3a \\(t_r\\)\uff0c\u5bf9\u4e8e\u6bcf\u4e2a \\(k\\in [l,r]\\)\uff0c\u8bbe \\(t_r\\) \u957f\u5ea6\u4e3a \\(k\\) \u7684\u540e\u7f00\u662f \\(t_k\\)\uff0c\u663e\u7136\u6709 \\(t_k\\) \u4e3a \\(t_r\\) \u7684\u540e\u7f00\uff0c\\(t_l\\) \u4e3a \\(t_r\\) \u7684\u540e\u7f00\uff0c\u6545\uff1a</p> \\[ \\edp(t_r)\\subseteq \\edp(t_k)\\subseteq \\edp(t_l) \\] <p>\u53c8 \\(\\edp(t_l)=\\edp(t_r)\\)\uff0c\u6545 \\(\\edp(t_k)=\\edp(t_r)\\)\u3002</p> </li> </ol>"}, {"location": "Algorithms/Strings/Suffix-Structures/SAM/#suffix-link-tree", "title": "Suffix Link Tree", "text": "<p>\u663e\u7136 \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u8fd9\u79cd\u8981\u4e48\u5305\u542b\u8981\u4e48\u76f8\u79bb\u7684\u7ed3\u6784\u53ef\u4ee5\u7528\u6811\u6765\u523b\u753b\u3002\u6211\u4eec\u628a\u8fd9\u68f5\u6811\u53eb\u540e\u7f00\u94fe\u63a5\u6811\u3002</p> <p>\u6bcf\u4e2a \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u7684\u7236\u4eb2\uff0c\u662f\u5176 \\(\\text{Endpos}\\) \u96c6\u5408\u7684\u6700\u5c0f\u8d85\u96c6\u3002\u6b64\u6811\u4e0a\u7684\u8282\u70b9\u542b\u4e49\u4e0e SAM \u8282\u70b9\u542b\u4e49\u76f8\u540c\uff0c\u56e0\u4e3a\u5bf9\u6240\u6709 \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u53d6\u5e76\uff0c\u6070\u597d\u662f\u539f\u4e32\u7684\u6240\u6709\u5b50\u4e32\uff0c\u4e14\u4efb\u610f\u4e24\u4e2a \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u4e0d\u4ea4\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SAM/#_2", "title": "\u6027\u8d28", "text": "<ol> <li>\u540e\u7f00\u94fe\u63a5\u6811\u8282\u70b9\u6570\u4e3a \\(\\mathcal O(n)\\)\u3002</li> <li>\u8bbe \\(u\\) \u4e3a \\(v\\) \u5728\u540e\u7f00\u94fe\u63a5\u6811\u4e0a\u7684\u7236\u4eb2\uff0c\u800c \\(\\operatorname{minlen}(u)\\)\uff0c\\(\\operatorname{maxlen}(u)\\) \u5206\u522b\u8868\u793a \\(u\\) \u8fd9\u4e2a \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u7684\u6700\u77ed/\u6700\u957f\u5b50\u4e32\u7684\u957f\u5ea6\uff0c\u5219 \\(\\operatorname{minlen}(v)=\\operatorname{maxlen}(u)+1\\)\u3002</li> </ol>"}, {"location": "Algorithms/Strings/Suffix-Structures/SAM/#_3", "title": "\u6784\u9020", "text": "<p>SAM \u7684\u6784\u9020\u662f\u589e\u91cf\u6784\u9020\u7684\uff0c\u5b9e\u73b0\u662f\u4e0b\u5217\u4ee3\u7801\uff1a</p> <pre><code>void Extend(const int &amp;c) {\n    int cur = newnode(), p = last;\n    nd[cur].len = nd[p].len + 1;\n    nd[cur].id = ++clen;\n    last = cur;\n\n    while (p != -1 &amp;&amp; !nd[p][c])\n        nd[p][c] = cur, p = nd[p].Link;\n    if (p == -1) {\n        nd[cur].Link = 0;\n        return ;\n    }\n\n    int q = nd[p][c];\n    if (nd[q].len == nd[p].len + 1) {\n        nd[cur].Link = q;\n    } else {\n        int clone = newnode();\n        nd[clone] = nd[q];\n        nd[clone].id = 0;\n        // \u66f4\u65b0 len, \u66f4\u65b0 Link, \u66f4\u65b0\u8f6c\u79fb\n        nd[clone].len = nd[p].len + 1;\n        nd[q].Link = nd[cur].Link = clone;\n        while (p != -1 &amp;&amp; nd[p][c] == q)\n            nd[p][c] = clone, p = nd[p].Link;\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u51fd\u6570\u7ef4\u62a4\u4e86\u52a0\u5165\u4e00\u4e2a\u5b57\u7b26 \\(c\\) \u540e SAM \u7684\u53d8\u5316\uff0c\u5176\u4e2d <code>last</code> \u662f\u4e0a\u4e00\u6b21\u539f\u4e32\u88ab\u5305\u542b\u7684\u8282\u70b9\u3002<code>nd[u][c]</code> \u662f\u8282\u70b9 \\(u\\) \u7684\u8f6c\u79fb \\(c\\)\u3002</p> <pre><code>nd[cur].len = nd[p].len + 1;\nnd[cur].id = ++clen;\nlast = cur;\n\nwhile (p != -1 &amp;&amp; !nd[p][c])\n    nd[p][c] = cur, p = nd[p].Link;\n</code></pre> <p><code>nd[cur].id</code> \u6307\u7684\u662f\u8fd9\u4e2a \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\u5176\u4ed6\u5c31\u662f\u7ef4\u62a4\u4e00\u4e0b\u957f\u5ea6\u3002</p> <p>\u73b0\u5728 \\(u\\) \u8fd9\u4e2a \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u91cc\u53ea\u6709\u5f53\u524d\u4e32\u4e00\u4e2a\u5143\u7d20\u3002</p> <p>\u7b2c\u4e8c\u6bb5\u7684 <code>while</code> \u662f\u8bf4\uff0c\u4e0d\u65ad\u8df3 \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u7684\u6781\u5c0f\u8d85\u96c6\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7956\u5148\u7684 \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u91cc\u7684\u4e32\uff08\u5f53\u524d\u52a0\u5165\u7684\u662f\u7b2c \\(i\\) \u4e2a\u5b57\u7b26\uff0c\u663e\u7136\u8fd9\u4e9b\u90fd\u662f \\([1,i-1]\\) \u7684\u4e00\u6bb5\u4e0d\u65ad\u7f29\u77ed\u7684\u540e\u7f00\uff09\uff0c\u5728\u52a0\u5165\u4e00\u4e2a \\(c\\) \u4e4b\u540e\u90fd\u4f1a\u8f6c\u79fb\u5230\u5f53\u524d\u8fd9\u4e2a\u72b6\u6001\u3002</p> <pre><code>------??###c---###c\n|        -&gt;       |\n</code></pre> <p>\u5373\u8fd9\u91cc\u7684\u7b2c\u4e00\u4e2a <code>|</code> \u5411\u540e\u79fb\u52a8\u7684\u8fc7\u7a0b\uff0c\u76f4\u5230\u67d0\u4e2a \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u91cc\u5b58\u5728\u4e86\u4e0e\u5f53\u524d\u76f8\u540c\u7684\u8f6c\u79fb\u3002\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u4e0d\u65ad\u5c06 <code>|</code> \u5411\u540e\u79fb\u52a8\uff0c\u76f4\u5230\u627e\u5230\u7b2c\u4e00\u4e2a\u4e0d\u6b62\u5728 \\([1,i]\\) \u7684\u540e\u7f00\u4e2d\u51fa\u73b0\u7684 \\([1,i]\\) \u7684\u540e\u7f00\u3002\u5b83\u6240\u5728\u7684 \\(\\text{Endpos}\\) \u96c6\u5408\u5f53\u7136\u5c31\u662f \\(cur\\) \u7684\u6781\u5c0f\u8d85\u96c6\u3002</p> <pre><code>if (p == -1) {\n    nd[cur].Link = 0;\n    return ;\n}\n</code></pre> <p>\u8fd9\u91cc\u5c31\u662f\u8bf4\u5bf9\u4e8e \\([1,i-1]\\) \u7684\u4efb\u4f55\u4e00\u4e2a\u540e\u7f00\u52a0\u4e0a \\(c\\)\uff0c\u90fd\u6ca1\u6709\u5728\u539f\u6765\u7684\u4e32\u91cc\u51fa\u73b0\u8fc7\uff0c\u90a3\u4e5f\u5c31\u4e0d\u5b58\u5728\u8fd9\u4e00\u7ec4 \\(\\text{Endpos}\\) \u96c6\u5408\u7684\u8d85\u96c6\uff08\u8fd9\u4e9b\u4e32\u552f\u4e00\u7684\u51fa\u73b0\u5c31\u662f\u5728 \\([1,i]\\) \u7684\u540e\u7f00\uff09\uff0c\u6240\u4ee5\u5b83\u7684\u7236\u4eb2\u662f\u7a7a\uff0c\u5373\u6839\u8282\u70b9 \\(0\\)\u3002</p> <pre><code>int q = nd[p][c];\nif (nd[q].len == nd[p].len + 1) {\n    nd[cur].Link = q;\n} else {\n    int clone = newnode();\n    nd[clone] = nd[q];\n    nd[clone].id = 0;\n    // \u66f4\u65b0 len, \u66f4\u65b0 Link, \u66f4\u65b0\u8f6c\u79fb\n    nd[clone].len = nd[p].len + 1;\n    nd[q].Link = nd[cur].Link = clone;\n    while (p != -1 &amp;&amp; nd[p][c] == q)\n        nd[p][c] = clone, p = nd[p].Link;\n}\n</code></pre> <p>\u8003\u8651\u4e0a\u8ff0\u7684\u4f8b\u5b50</p> <pre><code>------??###c---###c\n               | |\n</code></pre> <p><code>nd[p].len</code> \u5c31\u662f <code>###</code> \u7684\u957f\u5ea6\uff0c\u8bbe \\(q\\) \u7684\u4ee3\u8868\u5143\u662f\u524d\u9762\u7684 <code>??###c</code>\u3002\u5982\u679c \\(q\\) \u8fd9\u4e2a \\(\\text{Endpos}\\) \u4ee3\u8868\u5143\u53ea\u6709 <code>###c</code> \u8fd9\u4e00\u6bb5\uff08<code>??</code> \u4e3a\u7a7a\u4e32\uff09\uff0c\u90a3\u4e48\u4efb\u4f55\u4e00\u4e2a\u8fd9\u4e2a\u7b49\u4ef7\u7c7b\u7684\u5b50\u4e32\u90fd\u4f1a\u5728\u540e\u9762\u518d\u6b21\u51fa\u73b0\uff0c\u4e0d\u9700\u8981\u5206\u88c2\u3002</p> <p>\u53cd\u4e4b\uff0c\u5982\u679c <code>nd[p].len + 1 != nd[q].len</code>\uff0c\u5373 <code>??</code> \u4e0d\u662f\u7a7a\u4e32\uff0c\u90a3\u4e48 <code>?###c</code>\uff0c<code>??###c</code> \u7b49\u90fd\u4e0d\u4f1a\u5728\u540e\u9762\u518d\u6b21\u51fa\u73b0\uff0c\u5b83\u4eec\u53ea\u51fa\u73b0\u5728\u524d\u9762\uff0c\u800c <code>###c</code> \u7684\u5b50\u4e32\u8fd8\u51fa\u73b0\u5728\u4e86\u540e\u9762\uff0c\u5b83\u4eec\u73b0\u5728\u5e94\u5f53\u5206\u5c5e\u4e24\u4e2a\u4e0d\u540c\u7684 \\(\\text{Endpos}\\) \u96c6\u5408\u3002</p> <p>\u6211\u4eec\u4ee4\u539f\u6765\u7684 \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\u8868\u793a\u5f62\u5982 <code>??###c</code> \u7684\u5b50\u4e32\uff0c\u663e\u7136\u5b83\u4e0d\u9700\u8981\u4fee\u6539\u3002\u518d\u65b0\u5efa\u4e00\u4e2a\u8282\u70b9\uff0c\u8868\u793a\u5f62\u5982 <code>###c</code> \u7684\u5b50\u4e32\uff0c\u628a\u539f\u6765\u8282\u70b9\u7684\u8f6c\u79fb\u590d\u5236\u8fc7\u6765\uff0c\u7531\u4e8e\u73b0\u5728 <code>###c</code> \u662f <code>??###c</code> \u7684\u4e00\u6bb5\u540e\u7f00\uff0c\u6240\u4ee5 <code>??###c</code> \u7684\u7236\u4eb2\u5e94\u8be5\u8bbe\u4e3a <code>###c</code>\uff0c\u5b83\u7684 \\(\\text{Endpos}\\) \u96c6\u5408\u624d\u662f <code>??###c</code> \\(\\text{Endpos}\\) \u96c6\u5408\u7684\u6700\u5c0f\u8d85\u96c6\uff08\u4ec5\u591a\u52a0\u4e86\u4e00\u4e2a \\(i\\)\uff09\u3002</p> <p>\u7136\u540e\u6211\u4eec\u8fd8\u9700\u8981\u628a\u4e00\u4e9b\u8f6c\u79fb\u8fb9\u6539\u6210\u6307\u5411\u65b0\u5efa\u7684\u8282\u70b9\uff0c\u5373 <code>###</code> \u6240\u5728 \\(\\text{Endpos}\\) \u7b49\u4ef7\u7c7b\uff0c\u53ca\u5176\u7956\u5148\u7684\u6307\u5411 \\(q\\) \u7684\u8f6c\u79fb \\(c\\)\u3002</p> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u6784\u5efa\u51fa\u6765\u7684\u81ea\u52a8\u673a\uff0c\u81f3\u591a\u6709 \\(2|s|-1\\) \u4e2a\u8282\u70b9\uff0c\\(3|s|-4\\) \u6761\u8f6c\u79fb\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SAM/#sam", "title": "SAM \u7684\u5e94\u7528", "text": ""}, {"location": "Algorithms/Strings/Suffix-Structures/SAM/#_4", "title": "\u6027\u8d28", "text": "<ol> <li>\u6b63\u4e32 SAM \u7684\u540e\u7f00\u94fe\u63a5\u6811\u662f\u53cd\u4e32\u7684\u540e\u7f00\u6811\u3002</li> <li>SAM \u6bcf\u6761\u8def\u5f84\u90fd\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a\u5b50\u4e32\uff0c\u6240\u4ee5 SAM \u7684\u8f6c\u79fb DAG \u4e0a\u81f3\u591a\u6709 \\(\\mathcal O(n^2)\\) \u6761\u4e0d\u540c\u7684\uff0c\u4ece \\(\\varnothing\\) \u51fa\u53d1\u7684\u8def\u5f84\u3002</li> <li>\u7531 \\(2\\)\uff0c\\(t\\) \u662f \\(s\\) \u7684\u5b50\u4e32\uff0c\u5f53\u4e14\u4ec5\u5f53\u4ece \\(s\\) \u7684 SAM \u4e0a \\(\\varnothing\\) \u5f00\u59cb\uff0c\u7b2c \\(i\\) \u6b65\u8d70\u8f6c\u79fb \\(t_i\\)\uff0c\u4e0d\u4f1a\u8d70\u51fa\u8fd9\u4e2a SAM\u3002</li> <li>\u4e5f\u53ef\u4ee5\u628a SAM \u770b\u6210\u628a \\(s\\) \u6240\u6709\u5b50\u4e32\u63d2\u5165 ACAM\uff0c\u7136\u540e\u538b\u7f29\u5f97\u5230\u7684\u7ed3\u6784\u3002</li> </ol>"}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/", "title": "SA and SA IS", "text": ""}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/#_1", "title": "\u5b9a\u4e49", "text": "<p>\u5b57\u7b26\u4e32\u7684\u4e0b\u6807\u4ece \\(1\\) \u5f00\u59cb\u3002</p> <p>\u5b9a\u4e49 \\(\\operatorname{Suffix}(s,i)\\) \u8868\u793a\u7684\u662f \\(s\\) \u4e2d \\([i,\\operatorname{Len}(s)]\\) \u7684\u8fd9\u4e00\u6bb5\u540e\u7f00\u3002</p> <p>\u540e\u7f00\u6570\u7ec4 \\(\\operatorname{SA}(s,i)\\) \u8868\u793a\u7684\u662f\u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(s\\)\uff0c\u6392\u540d\u4e3a \\(i\\) \u7684\u540e\u7f00\u662f \\(\\operatorname{Suffix}(s,\\operatorname{SA}(s,i))\\)\uff0c\u5982\u679c\u7701\u7565\u6389 \\(i\\)\uff0c\u8868\u793a\u7684\u662f\u6574\u4e2a\u6570\u7ec4\u672c\u8eab\u3002\u663e\u7136\u8fd9\u662f\u4e00\u4e2a\u6392\u5217\uff0c\u5176\u9006\u6392\u5217\u8bb0\u4f5c \\(\\operatorname{rank}(s,i)\\)\uff0c\u8868\u793a\u540e\u7f00 \\(\\operatorname{Suffix}(s,i)\\) \u7684\u6392\u540d\u3002 \u901a\u5e38\uff0c\u6211\u4eec\u53ea\u6709\u4e00\u4e2a\u4e32 \\(s\\)\uff0c\u6240\u4ee5\u628a \\(\\operatorname{SA}(s,i)\\) \u7b80\u5355\u8bb0\u4e3a \\(\\operatorname{SA}(i)\\)\u3002</p> <p>\u5b57\u7b26 \\(\\texttt{#}\\) \u662f\u4e0d\u4f1a\u51fa\u73b0\u5728\u539f\u4e32\u91cc\uff0c\u4e14\u5c0f\u4e8e\u539f\u4e32\u6240\u6709\u5b57\u7b26\u7684\u5b57\u7b26\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/#sa-is", "title": "SA-IS", "text": "<p>\u4e0b\u9762\u7b80\u8ff0 \\(O(n)\\) \u6c42\u51fa \\(\\operatorname{SA}\\) \u7684\u65b9\u6cd5\u3002</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u8bbe\u5b57\u7b26\u4e32\u672b\u5c3e\uff0c\u5373\u7b2c \\(n\\) \u4e2a\u5b57\u7b26\u662f \\(\\texttt{#}\\)\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/#l-type-s-type-lms", "title": "L-type, S-type \u4e0e LMS \u540e\u7f00", "text": "<p>\u82e5 \\(\\operatorname{Suffix}(s,i)&lt;\\operatorname{Suffix}(s,i+1)\\)\uff0c\u5219\u5b83\u662f\u4e00\u4e2a \\(\\text{S-type}\\) \u540e\u7f00\uff0c\u5426\u5219\u4e3a \\(\\text{L-type}\\) \u540e\u7f00\u3002\u8ba4\u4e3a \\(\\operatorname{Suffix}(n,i)\\) \u662f \\(\\text{S-type}\\) \u7684\u3002</p> <p>\u79f0 \\(\\text{LMS}\\) \u540e\u7f00\u662f\u6bcf\u4e2a \\(\\text{S-type}\\) \u533a\u95f4\u4e2d\u6700\u5de6\u4fa7\u7684\u90a3\u4e00\u4e2a\uff0c\u4e5f\u5c31\u662f \\(\\operatorname{Suffix}(s,i)\\) \u4e3a \\(\\text{S-type}\\) \u4e14 \\(\\operatorname{Suffix}(s,i-1)\\) \u4e3a \\(\\text{L-type}\\) \u7684 \\(\\operatorname{Suffix}(s,i)\\)\u3002</p> <p>\u5f15\u7406 1: \u5148\u8003\u8651\u600e\u4e48\u6c42\u51fa\u6bcf\u4e2a\u540e\u7f00\u7684\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e \\(\\operatorname{Suffix}(s,i)\\) \u662f \\(\\text{S-type}\\) \u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\uff1a</p> <ol> <li>\\(s_i&lt;s_{i+1}\\)</li> <li>\\(s_i=s_{i+1}\\land \\operatorname{type}(i+1)=\\text{S}\\)</li> </ol> <p>\u4e24\u4e2a\u4e2d\u6709\u4e00\u4e2a\u6210\u7acb\u3002 \u8bc1\u660e\u5c31\u662f\u53ea\u8981\u5f00\u5934\u4e00\u76f4\u76f8\u540c\uff0c\u5c31\u4e0d\u65ad\u5220\u6389\u5f00\u5934\u5b57\u7b26\u540e\u5411\u540e\u6bd4\u8f83\u3002\u5f52\u7eb3\u5373\u53ef\u3002</p> <p>\u518d\u8003\u8651\u600e\u4e48\u5229\u7528\u540e\u7f00\u7684\u7c7b\u578b\u8fdb\u884c\u6392\u5e8f\u3002</p> <p>\u5f15\u7406 2: \u82e5 \\(\\operatorname{Suffix}(s,i)\\) \u662f \\(\\text{S-type}\\) \u7684\u800c \\(\\operatorname{Suffix}(s,j)\\) \u662f \\(\\text{L-type}\\) \u7684\uff0c\u4e14 \\(s_i=s_j\\)\uff0c\u90a3\u4e48 \\(\\operatorname{Suffix}(s,i)&gt;\\operatorname{Suffix}(s,j)\\)\u3002</p> <p>\u4e0d\u59a8\u5047\u8bbe \\(\\operatorname{Suffix}(s,i)=abX\\)\uff0c\\(\\operatorname{Suffix}(s,j)=acY\\)\uff0c\u4e14 \\(a\\neq b,a\\neq c\\)\uff0c\u90a3\u4e48 \\(c&lt;a&lt;b\\)\uff0c\u4ece\u800c \\(\\operatorname{Suffix}(s,i)&gt;\\operatorname{Suffix}(s,j)\\)\u3002</p> <p>\u5982\u679c\u5355\u4fa7\u53d6\u5230\u7b49\u53f7\uff0c\u7ed3\u679c\u4e0d\u4f1a\u6539\u53d8\u3002\u4e24\u4fa7\u90fd\u53d6\u7b49\uff0c\u90a3\u4e48\u6d88\u6389\u7b2c\u4e00\u4e2a\uff0c\u7ee7\u7eed\u5411\u540e\u9012\u5f52\uff0c\u7531\u5f15\u7406 \\(1\\) \u53ef\u4ee5\u8bc1\u660e\uff0c\u540e\u7f00\u7c7b\u578b\u4e0d\u6539\u53d8\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/#lms", "title": "LMS \u5b50\u4e32", "text": "<p>\u6211\u4eec\u79f0\u4e24\u4e2a\u76f8\u90bb\u7684 \\(\\text{LMS}\\) \u540e\u7f00\u7684\u5f00\u5934\u4e4b\u95f4\u7684\u4e00\u4e2a\u90e8\u5206\uff0c\u542b\u8fd9\u4e24\u4e2a \\(\\text{LMS}\\) \u540e\u7f00\u7684\u5f00\u5934\uff0c\u662f\u4e00\u4e2a \\(\\text{LMS}\\) \u5b50\u4e32\u3002</p> <p>\u6240\u6709\u975e \\(\\texttt{#}\\) \u7684 \\(\\text{LMS}\\) \u5b50\u4e32\u957f\u5ea6\u4e00\u5b9a \\(&gt;2\\)\uff0c\u56e0\u4e3a\u5728\u4e24\u4e2a \\(\\text{S-type}\\) \u4e4b\u95f4\u4e00\u5b9a\u8981\u6709\u4e00\u4e2a \\(\\text{L-type}\\)\u3002</p> <p>\u4ece\u800c\u53ef\u4ee5\u8bc1\u660e \\(\\text{LMS}\\) \u5b50\u4e32\u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 \\(\\left\\lceil\\dfrac{|s|}{2}\\right\\rceil\\) \u4e2a\u3002</p> <p>\u5f15\u7406 3: \u5bf9\u4efb\u610f\u4e24\u4e2a LMS \u5b50\u4e32\uff0c\u4e0d\u5b58\u5728\u4e00\u4e2a LMS \u5b50\u4e32\u662f\u53e6\u5916\u4e00\u4e2a LMS \u5b50\u4e32\u7684\u771f\u524d\u7f00\u3002</p> <p>\u5047\u8bbe \\(A\\) \u662f \\(B\\) \u7684\u771f\u524d\u7f00\uff0c\u90a3\u4e48 \\(B\\) \u4e2d\u4e00\u5b9a\u81f3\u5c11\u6709\u5f00\u5934\uff0c\u672b\u5c3e\uff0c\\(A\\) \u672b\u5c3e\uff0c\u4e09\u4e2a\u4f4d\u7f6e\u662f\u67d0\u4e00\u4e2a \\(\\text{LMS}\\) \u540e\u7f00\u7684\u5f00\u5934\uff0c\u4e0d\u7b26\u5408\u5b9a\u4e49\u3002</p> <p>\u4e0d\u96be\u53d1\u73b0\u6240\u6709 \\(\\text{LMS}\\) \u5b50\u4e32\u957f\u5ea6\u548c \\(&lt;2|s|\\)\uff0c\u6240\u4ee5\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u65b9\u6cd5\u7ebf\u6027\u628a\u4ed6\u4eec\u6392\u5e8f\uff0c\u518d\u628a\u6bcf\u4e2a \\(\\text{LMS}\\) \u5b50\u4e32\u538b\u7f29\uff0c\u53d8\u6210\u5b83\u7684\u6392\u540d\uff0c\u90a3\u4e48\u5c31\u53ea\u6709 \\(\\left\\lceil \\dfrac{|s|}{2}\\right\\rceil\\) \u4e2a\u5b57\u7b26\uff0c\u79f0\u538b\u7f29\u6210\u7684\u65b0\u5b57\u7b26\u4e32\u662f \\(s'\\)\u3002</p> <p>\u5f15\u7406 4: \\(s'\\) \u4e2d\u6bcf\u4e2a\u540e\u7f00\u7684\u6392\u540d\u5c31\u7b49\u4e8e\u662f \\(s\\) \u4e2d\u6bcf\u4e2a \\(\\text{LMS}\\) \u540e\u7f00\uff08\u8fd9\u91cc\u4e0d\u662f\u5b50\u4e32\uff09\u7684\u6392\u540d\u3002</p> <p>\u6ca1\u6709\u4e24\u4e2a \\(\\text{LMS}\\) \u5b50\u4e32\uff0c\u4e00\u4e2a\u662f\u53e6\u4e00\u4e2a\u7684\u771f\u524d\u7f00\uff0c\u6240\u4ee5\u88ab\u6bd4\u8f83\u7684\u8981\u4e48\u5b8c\u5168\u76f8\u540c\uff0c\u8981\u4e48\u81f3\u5c11\u4e00\u4e2a\u4f4d\u7f6e\u5b57\u7b26\u4e0d\u540c\uff0c\u6216\u7c7b\u578b\u4e0d\u540c\u3002 \u524d\u4e24\u79cd\u60c5\u51b5\u6bd4\u8f83\u80fd\u770b\u7684\u51fa\u6765\u540e\u7f00\u7684\u5927\u5c0f\uff0c\u5bf9\u4e8e\u6700\u540e\u4e00\u79cd\u60c5\u51b5\uff08\u7c7b\u578b\u4e0d\u540c\uff09\uff0c\u8003\u8651\u5f15\u7406 1\uff0c\u4e5f\u80fd\u6bd4\u8f83\u51fa\u5bf9\u5e94\u540e\u7f00\u7684\u5927\u5c0f\u3002</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/#_2", "title": "\u8bf1\u5bfc", "text": "<p>\u5982\u679c\u6211\u4eec\u80fd \\(O(n)\\) \u628a\u4ece \\(\\operatorname {SA}(s')\\) \u7684\u540e\u7f00\u6392\u5e8f\u7ed3\u679c\u8bf1\u5bfc\u51fa \\(\\operatorname{SA}(s)\\) \u7684\u540e\u7f00\u6392\u5e8f\u7ed3\u679c\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u65ad\u9012\u5f52\uff0c\u6bcf\u6b21\u6298\u534a\uff0c\u7b97\u51fa\u4e0b\u4e00\u534a\u7684\u90e8\u5206\u540e\u518d\u8bf1\u5bfc\u51fa\u5f53\u524d\u7684\u7ed3\u679c\uff0c\u603b\u590d\u6742\u5ea6\u662f</p> \\[ T(n)=T(n/2)+\\mathcal O(n) \\] <p>\u4e5f\u5c31\u662f \\(O(n)\\) \u7684\u3002\u90a3\u4e48\u6211\u4eec\u5148\u8003\u8651\uff0c\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u7ed9\u51fa\u4e86\u8fd9\u4e2a \\(\\text{LMS}\\) \u5b50\u4e32\u538b\u7f29\u540e\u7684\u5b57\u7b26\u4e32\u7684 \\(\\text{SA}\\)\uff0c\u600e\u4e48\u6c42\u51fa\u539f\u4e32\u7684 \\(\\operatorname{SA}\\) \u6570\u7ec4\u3002</p> <p>\u63a5\u4e0b\u6765\u7684\u90e8\u5206\u5bf9\u7740\u4ee3\u7801\u8bb2\uff0c\u5148\u7ed9\u51fa\u4ee3\u7801\uff1a</p> <p><pre><code>// lms[i] \u662f\u5c06\u6240\u6709 LMS \u5b50\u4e32\u6392\u5e8f\u540e\uff0c\u6392\u540d\u4e3a i \u7684 LMS \u5b50\u4e32\u7684\u8d77\u59cb\u4f4d\u7f6e\nvoid induce (int n, int m, std::vector&lt;int&gt; &amp;a, std::vector&lt;int&gt; &amp;lms, std::vector&lt;int&gt; &amp;type) {\n    auto pushBack = [=](const int &amp;x) {SA[tmp[a[x]]--] = x;};\n    auto pushFront = [=](const int &amp;x) {SA[tmp[a[x]]++] = x;};\n\n    memset(cnt,  0, (n + 1) * sizeof(int));\n    memset(SA , -1, (n + 1) * sizeof(int));\n    for (int i = 1; i &lt;= n; i++)    cnt[a[i]]++;\n    for (int i = 1; i &lt;= n; i++)    cnt[i] += cnt[i - 1];\n\n    for (int i = 1; i &lt;= n; i++)    tmp[i] = cnt[i];\n    for (int i = m; i &gt;= 1; i--)    pushBack(lms[i]);\n\n    /* L-type \u90e8\u5206 */\n    for (int i = 1; i &lt;= n; i++)    tmp[i] = cnt[i - 1] + 1;\n    for (int i = 1; i &lt;= n; i++)\n        if (SA[i] &gt; 1 &amp;&amp; type[SA[i] - 1] == 0)\n            pushFront(SA[i] - 1);\n\n    /* S-type \u90e8\u5206 */\n    for (int i = 1; i &lt;= n; i++)    tmp[i] = cnt[i];\n    // \u628a\u6240\u6709 S-type Suffix \u5168\u90e8\u91cd\u7f6e\n    for (int i = n; i &gt;= 1; i--)\n        if (SA[i] &gt; 1 &amp;&amp; type[SA[i] - 1] == 1)\n            pushBack(SA[i] - 1);\n}\n</code></pre> \u9996\u5148\u8003\u8651\u540e\u7f00\u6392\u5e8f\u7684\u4e00\u4e2a\u7ed3\u679c\uff0c\u80af\u5b9a\u662f\u6309\u7167\u9996\u5b57\u6bcd\u5206\u4e3a\u82e5\u5e72\u4e2a\u6bb5\uff0c\u7b2c\u4e00\u6bb5\u5f00\u5934\u4e3a \\(\\texttt{a}\\)\uff0c\u7b2c\u4e8c\u6bb5\u5f00\u5934\u4e3a \\(\\texttt{b}\\)\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u4e0d\u96be\u6ce8\u610f\u5230\u6bcf\u4e2a\u6bb5\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u6240\u6709\u4e32\u6309\u5f00\u5934\u5b57\u7b26\u5206\u7c7b\u4e86\u3002</p> <p>\u7531\u5f15\u7406 2\uff0c\u6211\u4eec\u77e5\u9053\u5bf9\u4e8e\u4efb\u610f\u4e00\u5bf9\u9996\u5b57\u6bcd\u76f8\u540c\uff0c\u7c7b\u578b\u4e0d\u540c\u7684\u540e\u7f00\uff0c\\(\\text{L-type}\\) \u7684\u603b\u662f\u5c0f\u4e8e \\(\\text{S-type}\\) \u7684\u3002</p> <p>\u8003\u8651 \\(\\text{SA}\\) \u91cc\u9996\u5b57\u6bcd\u4e3a \\(c\\) \u7684\u8fd9\u6bb5\u533a\u95f4\uff0c\u524d\u534a\u90e8\u5206\u662f \\(\\text{L-type}\\) \u540e\u7f00\uff0c\u540e\u534a\u90e8\u5206\u662f \\(\\text{S-type}\\) \u540e\u7f00\u3002</p> <pre><code>                      L-type            S-type\ncharacter c:     [      &lt;-      ]  |  [   -&gt;   ]\n</code></pre> <p><code>pushFront</code> \u548c <code>pushBack</code> \u4e24\u4e2a\u51fd\u6570\u5206\u522b\u662f\u4ece\u5c3e\u548c\u4ece\u5934\u63d2\u5165\u6876\uff08\u7bad\u5934\u6307\u7684\u662f\u5f80\u54ea\u8fb9\u63d2\u5165\uff09\uff0c<code>type[i]</code> \u4e3a \\(0\\) \u8bf4\u660e\u8fd9\u662f \\(\\text{L-type}\\)\uff0c\u5426\u5219\u662f \\(\\text{S-type}\\)\u3002</p> <p>\\(11\\sim 12\\) \u884c\uff0c\u6211\u4eec\u5148\u5bf9\u628a\u6240\u6709 \\(\\operatorname{LMS}\\) \u540e\u7f00\u968f\u4fbf\u9009\u62e9\u4e00\u4e2a\u5b83\u6240\u5c5e\u7684\u6876\u91cc\u7684\u4f4d\u7f6e\u586b\u8fdb\u53bb\u3002\u5b83\u4eec\u53ea\u8981\u968f\u4fbf\u653e\u5728\u4e00\u4e2a \\(\\text{S-type}\\) \u90e8\u5206\u7684\u4f4d\u7f6e\uff0c\u5e76\u4fdd\u8bc1\u76f8\u5bf9\u987a\u5e8f\u5373\u53ef\uff0c\u6240\u4ee5\u6211\u4eec\u5012\u7740\u679a\u4e3e\uff0c\u9010\u4e2a\u63d2\u5230\u6240\u5c5e\u7684 \\(\\text{S-type}\\) \u7684\u672b\u5c3e\u3002</p> <p>\\(15\\sim 18\\) \u884c\u5728\u586b\u5199 \\(\\text{L-type}\\) \u540e\u7f00\u7684\u6392\u540d\u3002\u73b0\u5728\u6240\u6709 \\(\\operatorname{SA}(i)&gt;0\\) \u7684\u4f4d\u7f6e \\(i\\) \u90fd\u5bf9\u5e94\u7740\u4e00\u4e2a \\(\\text{LMS}\\) \u540e\u7f00\u4e86\u3002\u5e76\u4e14 \\(\\operatorname{SA}(1)\\) \u5fc5\u5b9a\u662f \\(\\texttt{#}\\) \u6240\u5bf9\u5e94\u7684 \\(\\text{LMS}\\) \u540e\u7f00\uff08\u56e0\u4e3a\u5b83\u6700\u5c0f\uff09\u3002\u6bcf\u4e00\u4e2a\u8fd9\u6837\u7684 \\(\\text{LMS}\\) \u540e\u7f00\uff0c\u539f\u4e32\u91cc\u5bf9\u5e94\u7684\u524d\u9762\u7684\u4f4d\u7f6e\u90fd\u5e94\u5f53\u662f\u4e00\u6574\u4e32 \\(\\text{L-type}\\) \u540e\u7f00\uff0c\u5e76\u4e14\u8fd9\u6bb5 \\(\\text{L-type}\\) \u7684\u9996\u5b57\u6bcd\u90fd\u6bd4\u8fd9\u4e2a \\(\\text{LMS}\\) \u540e\u7f00\u7684\u9996\u5b57\u6bcd\u5927\uff08\u53ef\u4ee5\u7531\u5f15\u7406 1 \u63a8\u51fa\uff09\uff0c\u4e5f\u5c31\u662f\u5bf9\u5e94\u7684\u6392\u540d\u6bd4\u8fd9\u4e2a \\(\\text{LMS}\\) \u5927\uff0c\u4f4d\u4e8e \\(\\text{SA}\\) \u7684\u66f4\u540e\u9762\u7684\u4f4d\u7f6e\u3002</p> <p>\u90a3\u4e48\uff0c\\(\\operatorname{SA}(i)-1\\) \u5c31\u662f\u8fd9\u4e00\u4e32 \\(\\text{L}\\) \u7684\u672b\u5c3e\uff0c\u4e5f\u662f\u8fd9\u4e00\u6bb5 \\(\\text{L-type}\\) \u540e\u7f00\u4e2d\u7684\u6700\u5c0f\u503c\u3002</p> <p>\u6211\u4eec\u628a\u8fd9\u4e2a\u4e1c\u897f\u586b\u5165\u5230\u5f53\u524d\u7684 \\(\\text{SA}\\) \u91cc\uff0c\u586b\u5199\u7684\u5c31\u662f\u6700\u9760\u524d\u7684\u90a3\u4e2a\u4f4d\u7f6e\uff1a</p> <pre><code>   L-type       S-type\n[-         ][        ***]\n</code></pre> <p>\u5f53\u6211\u4eec\u7684\u6307\u9488\u4ece\u524d\u5f80\u540e\uff0c\u626b\u5230\u8fd9\u4e2a\u5df2\u7ecf\u586b\u4e86\u7684\u4f4d\u7f6e \\(k\\) \u4e4b\u540e\uff0c\\(\\text{SA}(k)\\) \u6307\u5411\u5b83\u4f4d\u4e8e\u7684\u8fd9\u4e2a\u7ea2\u8272\u7684\u4f4d\u7f6e\u3002</p> \\[ \\text{LL}\\color{green}{\\text{L}}\\color{skyblue}{\\text{L}}\\color{red}{\\text{L}}\\color{black}{\\text{S}} \\] <p>\u8fd9\u4e2a\u65f6\u5019 \\(\\text{SA}(k)-1\\) \u5c31\u662f\u84dd\u8272\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u540c\u6837\u662f \\(\\text{L-type}\\)\uff0c\u90a3\u4ed6\u5728 \\(\\text{SA}\\) \u91cc\u7684\u4f4d\u7f6e\uff08\u5373\u6392\u540d\uff09\u5c31\u5e94\u8be5\u6070\u597d\u4f4d\u4e8e <code>-</code> \u540e\u9762\u3002</p> <pre><code>   L-type       S-type\n[--        ][        ***]\n</code></pre> <p>\u6307\u9488\u7ee7\u7eed\u5411\u540e\u626b\uff0c\u73b0\u5728\u626b\u5230\u7b2c\u4e8c\u4e2a <code>-</code>\uff0c\u90a3\u4e48 \\(\\text{SA}(cur)-1\\) \u5c31\u5bf9\u5e94\u7684\u662f\u7eff\u8272\u7684\u4f4d\u7f6e\u2026\u2026\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6211\u4eec\u5c31\u80fd\u628a\u4e00\u6574\u6bb5 \\(\\text{L}\\) \u5168\u90fd\u5b9a\u4e0b\u6765\u3002</p> <p>\u7c7b\u4f3c\u5730\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9a\u4e0b\u6240\u6709 \\(\\text{S-type}\\) \u540e\u7f00\u7684\u6392\u540d\u3002</p> <p>\u95ee\u9898\u5c31\u662f\u600e\u4e48 \\(O(|s|)\\) \u7ed9 \\(\\text{LMS}\\) \u5b50\u4e32\u6392\u5e8f\u4e86\u3002\u7ed9\u51fa\u4e00\u4e2a\u7ed3\u8bba\uff1a</p> <p>\u5f15\u7406 5: \u53ea\u9700\u8981\u786e\u5b9a\u6bcf\u4e2a\u6876 \\(\\text{S-type}\\) \u6876\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002\u5c06\u6bcf\u4e00\u4e2a \\(\\text{LMS}\\) \u540e\u7f00\u7684\u9996\u5b57\u6bcd\uff08\u5373 \\(\\text{LMS}\\) \u5b57\u7b26\uff09\u6309\u7167\u4efb\u610f\u987a\u5e8f\u653e\u5165\u5bf9\u5e94\u7684\u6876\u4e2d\uff0c\u968f\u540e\u76f4\u63a5\u6267\u884c\u8bf1\u5bfc\u6392\u5e8f\u5373\u53ef\u3002 \u8bc1\u660e\u61d2\u5f97\u8bc1\u4e86\u53c2\u8003 \u8fd9\u7bc7\u535a\u5ba2</p> <p>\u7ed9\u51fa\u5b8c\u6574\u4ee3\u7801\uff1a <pre><code>// SA[i] -&gt; \u6392\u540d\u4e3a i \u7684\u540e\u7f00\u7684\u8d77\u59cb\u70b9\n// \u6ce8\u610f\u8fd9\u4e9b\u6570\u7ec4\u662f\u5168\u5c40\u7684\nint SA[N], rk[N], cnt[N], tmp[N];\nvoid induce (int n, int m, std::vector&lt;int&gt; &amp;a, std::vector&lt;int&gt; &amp;lms, std::vector&lt;int&gt; &amp;type) {\n    auto pushBack = [=](const int &amp;x) {SA[tmp[a[x]]--] = x;};\n    auto pushFront = [=](const int &amp;x) {SA[tmp[a[x]]++] = x;};\n\n    memset(cnt,  0, (n + 1) * sizeof(int));\n    memset(SA , -1, (n + 1) * sizeof(int));\n    // \u9700\u8981\u6ce8\u610f, \u8bf7\u52a1\u5fc5\u4fdd\u8bc1\u5b57\u7b26\u96c6\u662f [1, n + 1], \u5426\u5219\u8fd9\u91cc\u4f1a\u51fa\u9519\n    // \u6bd4\u5982\u957f\u5ea6\u4e3a 1 \u7684\u5b57\u7b26\u4e32 \"z\", \u8fd9\u91cc\u5982\u679c \"z\" \u76f4\u63a5\u6309 ASCII \u8f6c\u8fc7\u6765\u4f1a\u51fa\u9519\n    // \u6700\u597d\u4e0d\u8981 n \u4e0e\u5b57\u7b26\u96c6\u53d6 max, \u624b\u52a8\u79bb\u6563\u5316\u4e00\u4e0b\n    for (int i = 1; i &lt;= n; i++)    cnt[a[i]]++;\n    for (int i = 1; i &lt;= n; i++)    cnt[i] += cnt[i - 1];\n\n    for (int i = 1; i &lt;= n; i++)    tmp[i] = cnt[i];\n    // \u628a LMS \u540e\u7f00\u6309\u987a\u5e8f\u63d2\u5165\n    for (int i = m; i &gt;= 1; i--)    pushBack(lms[i]);\n\n    for (int i = 1; i &lt;= n; i++)    tmp[i] = cnt[i - 1] + 1;\n    for (int i = 1; i &lt;= n; i++)\n        if (SA[i] &gt; 1 &amp;&amp; type[SA[i] - 1] == 0)\n            pushFront(SA[i] - 1);\n\n    for (int i = 1; i &lt;= n; i++)    tmp[i] = cnt[i];\n    // \u628a\u6240\u6709 S-type Suffix \u5168\u90e8\u91cd\u7f6e\n    for (int i = n; i &gt;= 1; i--)\n        if (SA[i] &gt; 1 &amp;&amp; type[SA[i] - 1] == 1)\n            pushBack(SA[i] - 1);\n};\n\n// a[0] \u4e3a\u7a7a\u5b57\u7b26 c1, a[n + 1] \u4e3a\u7a7a\u5b57\u7b26 c2 \u4e14 c1 &lt; c2\n// \u4ece\u800c SA[1] \u4e00\u5b9a\u662f n + 1\ninline void SAIS(int n, std::vector&lt;int&gt; &amp;a) {\n    std::vector&lt;int&gt; type(n + 1, -1);\n    //\u9012\u5f52\u5230\u4e0b\u4e00\u5c42\u7684\u65f6\u5019\u8981\u591a\u52a0\u4e00\u4e2a\u7a7a\u5b57\u7b26, \u4fdd\u9669\u8d77\u89c1\u591a\u5f00\u4e00\u4e2a\n    std::vector&lt;int&gt; LMS(n + 2, 0);\n    type[n] = 1;\n\n    int m = 0;\n    // \u5148\u786e\u5b9a\u4e0b\u7c7b\u578b\n    for (int i = n - 1; i &gt;= 1; i--) {\n        if (a[i] == a[i + 1])\n            type[i] = type[i + 1];\n        else\n            type[i] = (a[i] &lt; a[i + 1]);\n    }\n    // \u8fd9\u91cc\u7684 rk \u662f\u540e\u7f00 i \u7684 LMS \u7f16\u53f7\n    for (int i = 1; i &lt;= n; i++) {\n        if (type[i] == 1 &amp;&amp; type[i - 1] == 0) {\n            LMS[++m] = i;\n            rk[i] = m;\n        } else {\n            rk[i] = -1;\n        }\n    }\n\n    // LMS \u5b50\u4e32\u73b0\u5728\u662f\u4e00\u4e2a\u968f\u4fbf\u7684\u987a\u5e8f\n    induce(n, m, a, LMS, type);\n    // \u73b0\u5728\u6240\u6709 LMS \u5b50\u4e32\u5c31\u6392\u597d\u5e8f\u4e86\n    int tot = 0;\n    // \u7a7a\u5b57\u7b26, \u9632\u6b62 LMS[x + 1] \u6216\u8005 LMS[y + 1] \u4e0d\u5b58\u5728\n    LMS[m + 1] = n;\n\n    std::vector&lt;int&gt; nxt(m + 1, 0);\n    // nxt[i] \u662f LMS[i] \u5728\u6240\u6709 LMS \u5b50\u4e32\u4e2d\u7684\u6392\u540d\n    // \u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u6240\u6709 LMS \u5b50\u4e32, \u6570\u6709\u591a\u5c11\u5bf9\u76f8\u540c\u7684, \u56e0\u4e3a\u5df2\u7ecf\u6392\u597d\u5e8f, \u6570\u76f8\u90bb\u7684\n    // \u8003\u8651\u538b\u7f29\u540e\u7684\u90a3\u4e2a\u5b57\u7b26\u4e32, \u5982\u679c\u6240\u6709\u5b57\u7b26\u4e24\u4e24\u4e0d\u540c(\u6ca1\u6709\u4e00\u5bf9\u76f8\u540c\u7684 LMS \u5b50\u4e32)\n    // \u90a3 LMS \u540e\u7f00\u6392\u540d\u663e\u7136\u548c LMS \u5b50\u4e32\u7684\u6392\u540d\u4e00\u6837\n    for (int i = 1, x, y; i &lt;= n; i++) {\n        x = rk[SA[i]];\n        if (x == -1)\n            continue;\n        // \u957f\u5ea6\u4e0d\u540c\uff0c\u53ef\u4ee5\u76f4\u63a5\u5224\u65ad\u4e0d\u540c\n        if (tot == 0 || LMS[x + 1] - LMS[x] != LMS[y + 1] - LMS[y])\n            tot++;\n        else\n            // \u4e00\u4e2a\u4e2a\u5b57\u7b26\u6bd4\u8f83, \u5982\u679c\u4e0d\u540c\u5c31\u662f\u4e0d\u540c\n            for (int p1 = LMS[x], p2 = LMS[y]; p2 &lt;= LMS[y + 1]; p1++, p2++)\n                if (a[p1] != a[p2] || type[p1] != type[p2]) {\n                    tot++;\n                    break;\n                }\n        // \u7b2c x \u4e2a LMS \u5b50\u4e32\u6392\u540d\u4e3a tot\n        nxt[x] = tot;\n        y = x;\n    }\n    // \u5982\u679c\u6240\u6709 LMS \u5b50\u4e32\u4e24\u4e24\u4e0d\u540c\n    if (tot == m)\n        // SA[\u6392\u540d] = \u539f\u4e32\u4f4d\u7f6e\n        for (int i = 1; i &lt;= m; i++)\n            SA[nxt[i]] = i;\n    else\n        // \u9012\u5f52\u5bf9\u8fd9\u4e2a\u5b57\u7b26\u4e32\u518d\u540e\u7f00\u6392\u5e8f\u4e00\u6b21\n        SAIS(m, nxt);\n    // \u6b64\u5904 SA[i]: \u6392\u540d\u4e3a i \u7684 LMS \u540e\u7f00\u5728\u539f\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\n    // \u628a nxt \u53d8\u6210\u6392\u597d\u5e8f\u7684 LMS \u5b50\u4e32\u5e8f\u5217\n    for (int i = 1; i &lt;= m; i++)\n        nxt[i] = LMS[SA[i]];\n    induce(n, m, a, nxt, type);\n}\n</code></pre></p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/#height", "title": "Height", "text": "<p>\u5b58\u5728\u6027\u547d\u9898\u9b45\u529b\u65f6\u523b\u3002</p> <p>\u4e0b\u9762\u8bb0 \\(\\operatorname{suf}(i)=\\operatorname{Suffix}(s,i)\\)\uff0c\u7565\u53bb \\(\\operatorname{rank}(s,i)\\) \u4e2d\u7684 \\(s\\)\uff0c\u7b80\u8bb0 \\(\\operatorname{LCP}(\\operatorname{suf}(i),\\operatorname{suf}(j))\\) \u4e3a \\(\\operatorname{LCP}(i,j)\\)\uff0c\u5b9a\u4e49\uff1a</p> \\[ \\operatorname{height}(s,i)=\\left|\\operatorname{LCP}(\\operatorname{SA}(i),\\operatorname{SA}(i-1)\\right)| \\] <p>\u5b9a\u4e49 \\(\\operatorname{height}(1)=0\\)\u3002 \u4e00\u4e2a\u7b80\u5355\u7684\u5f15\u7406\uff1a</p> <p>\u5f15\u7406 6: \u82e5 \\(\\operatorname{rank}(i)&lt;\\operatorname{rank}(j)&lt;\\operatorname{rank}(k)\\)\uff0c\u5219\uff1a </p> \\[ \\left|\\operatorname{LCP}(i,j)\\right|,\\left|\\operatorname{LCP}(j,k)\\right|\\ge \\left|\\operatorname{LCP}(i,k)\\right| \\] <p>\u8003\u8651 \\(\\operatorname{height}\\) \u5177\u6709\u4ec0\u4e48\u6027\u8d28\uff0c\u6839\u636e\u901a\u7528\u7684\u589e\u91cf\u7684\u601d\u60f3\uff0c\u4e0d\u59a8\u5047\u8bbe\u5df2\u7ecf\u7b97\u51fa\u4e86 \\(\\operatorname{height}(i)\\)\uff0c\u5e76\u4e14\u5b83 \\(&gt;0\\)\uff0c\u90a3\u4e48\u5bb9\u6613\u7b97\u51fa\u5404\u53bb\u6389\u7b2c\u4e00\u4e2a\u5b57\u7b26\u540e\u7684 \\(\\operatorname{LCP}\\)\uff0c\u5373 \\(\\left|\\operatorname{LCP}\\left(\\operatorname{SA}(i)+1,\\operatorname{SA}(i-1)+1\\right)\\right|\\)\uff0c\u4e14\uff1a</p> \\[ \\left|\\operatorname{LCP}(\\operatorname{SA}(i)+1,\\operatorname{SA}(i-1)+1\\right)| =\\operatorname{height}(i)-1 \\] <p>\u8bb0 \\(p=\\operatorname{SA}(i)+1,q=\\operatorname{SA}(i-1)+1\\)\u3002</p> <p>\u4ed6\u4eec\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u76f8\u540c\uff08\\(\\operatorname{LCP}&gt;0\\)\uff09\uff0c\u6240\u4ee5\uff1a</p> \\[ \\operatorname{rank}(\\operatorname{SA}(i-1))&lt;\\operatorname{rank}(\\operatorname{SA}(i))\\Longrightarrow \\operatorname{rank}(q)&lt;\\operatorname{rank}(p) \\] <p>\u8054\u60f3\u5230\u4e0a\u9762\u7684\u5f15\u7406 \\(6\\)\uff0c\u65e2\u7136 \\(p,q\\) \u7684 \\(\\operatorname{LCP}\\) \u662f \\(\\operatorname{height}(i)-1\\)\uff0c\u90a3\u5f80\u4ed6\u4eec\u4e2d\u95f4\u63d2\u5165\u4e00\u4e2a \\(r\\) \u6765\u51d1\u6210\u5f15\u7406 \\(6\\) \u7684\u5f62\u5f0f\u3002</p> <p>\\(\\operatorname{rank}(p),\\operatorname{rank}(q)\\) \u662f\u5b83\u4eec\u5728 \\(\\operatorname{SA}\\) \u6570\u7ec4\u91cc\u7684\u4e0b\u6807\uff0c\u4f46\u4ed6\u4eec\u5f88\u53ef\u80fd\u4e0d\u76f8\u90bb\uff0c\u6211\u4eec\u53d6 \\(r\\) \u6ee1\u8db3 \\(\\operatorname{rank}(r)=\\operatorname{rank}(p)-1\\)\uff0c\u6b64\u65f6 \\(r,p\\) \u5bf9\u5e94\u7684\u540e\u7f00\u5728 \\(\\operatorname{SA}\\) \u91cc\u5c31\u662f\u76f8\u90bb\u7684\u4e86\uff0c\u4ece\u800c \\(\\operatorname{height}(\\rank(p))=\\operatorname{LCP}(r,p)\\)\uff0c\u90a3\u4e48\uff1a</p> \\[ \\operatorname{rank}(q)\\le \\operatorname{rank}(r)&lt;\\operatorname{rank}(p) \\] <p>\u90a3\u4e48\u6839\u636e\u5f15\u7406 \\(6\\)\uff0c\u6709\uff1a</p> \\[ \\left|\\operatorname{LCP}(r,p)\\right|\\ge \\left|\\operatorname{LCP}(q,p)\\right| =\\operatorname{height}(i)-1 \\] <p>\u8fd9\u4e5f\u5c31\u662f</p> \\[ \\operatorname{height}(\\rank(p))\\ge \\operatorname{height}(i)-1 \\] <p>\u56e0\u4e3a \\(p=\\operatorname{SA}(i)+1\\)\uff0c\u6240\u4ee5\u6709\u4e00\u822c\u6027\u7684\u7ed3\u8bba</p> \\[ \\color{red}{}\\operatorname{height}(\\operatorname{rank}(i))\\ge \\operatorname{height}(\\operatorname{rank}(i-1))-1 \\] <p>\u81f3\u591a \\(O(n)\\) \u6b21\u51cf\u6cd5\uff0c\u90a3\u4e48\u66b4\u529b\u5c31\u80fd\u7ebf\u6027\u4e86\u3002 <pre><code>// \u679a\u4e3e\u4e00\u4e2a\u4e32\u7684\u8d77\u59cb\u70b9\nfor(int i = 1, k = 0; i &lt;= n; i++) {\n    if (k) k--;\n    /* \u9700\u8981\u4fdd\u8bc1 s[0] \u548c s[n] \u662f\u7a7a\u5b57\u7b26 */\n    while (s[i + k] == s[SA[rk[i] - 1] + k]) k++;\n    ht[rk[i]] = k;\n}\n</code></pre></p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/#_3", "title": "\u5e94\u7528", "text": "<p>Example 1: \u6c42\u51fa\u5b57\u7b26\u4e32 \\(\\operatorname{suf}(i)\\) \u4e0e \\(\\operatorname{suf}(j)\\) \u7684\u6700\u957f\u516c\u5171\u524d\u7f00</p> <p>\u6839\u636e\u7ed3\u8bba \\(1\\)\uff0c\\(\\left|\\operatorname{LCP}(\\operatorname{rank}(i),\\operatorname{rank}(j))\\right|\\le \\left|\\operatorname{LCP}(\\operatorname{rank}(k),\\operatorname{rank}(k-1))\\right|\\)\uff0c\u5176\u4e2d \\(k\\in (i,j]\\)\uff0c\u800c\u5b83\u4eec\u5168\u90e8 \\(\\operatorname{LCP}\\) \u8d77\u6765\uff0c\u53ef\u4ee5\u5f97\u5230 \\(\\operatorname{LCP}(i,j)\\)\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2a\u7b49\u53f7\u53ef\u4ee5\u88ab\u53d6\u5230\uff0c\u5373\uff1a</p> \\[ \\left|\\operatorname{LCP}(\\operatorname{rank}(i),\\operatorname{rank}(j))\\right| = \\min_{k=i+1}^{j}\\left\\{\\left|\\operatorname{LCP}(\\operatorname{rank}(k),\\operatorname{rank}(k-1))\\right|\\right\\} \\] <p>\u95ee\u9898\u5c31\u662f \\(\\text{RMQ}\\) \u4e86\u3002</p> <p>\u7ed9\u4e2a \\(\\operatorname{height}\\) \u4e4b\u6240\u4ee5\u88ab\u79f0\u4e3a \\(\\operatorname{height}\\) \u7684\u539f\u56e0\u56fe\uff1a </p> <p>Example 2: \u7ed9\u51fa\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6c42\u672c\u8d28\u4e0d\u540c\u5b50\u4e32\u6570\u3002</p> <p>\u8bbe \\(S\\) \u662f\u5df2\u7ecf\u52a0\u5165\u7684\u540e\u7f00\u7684\u96c6\u5408\uff0c\u90a3\u4e48\u52a0\u5165\u4e00\u4e2a\u65b0\u7684\u540e\u7f00 \\(i\\) \u7684\u8d21\u732e\u662f\uff1a</p> \\[ \\left|\\operatorname{suf}(i)\\right|-\\max_{s\\in S}\\left|\\operatorname{LCP}(s,\\operatorname{suf}(i))\\right| \\] <p>\u4e3a\u4e86\u4f7f\u7528\u5f15\u7406 7\uff0c\u4ece\u5c0f\u5230\u5927\u679a\u4e3e \\(i\\)\uff0c\u52a0\u5165\u540e\u7f00 \\(\\operatorname{suf}(\\operatorname{SA}(i))\\)\uff0c\u90a3\u4e48\u4f7f\u5f97\u4e0e\u5b83 \\(\\operatorname{LCP}\\) \u6700\u957f\u7684\u5c31\u662f \\(\\operatorname{suf}(\\operatorname{SA}(i-1))\\)\uff0c\u4ece\u800c\u7b54\u6848\u4e3a\uff1a</p> \\[ \\sum_{i=1}^{n}(n-\\operatorname{SA}(i)+1)-\\operatorname{height}(i) \\] <p>Code Link</p>"}, {"location": "Algorithms/Strings/Suffix-Structures/SA_and_SA-IS/#_4", "title": "\u5c0f\u7ed3", "text": "<p>\\(\\operatorname{SA}\\) \u548c \\(\\operatorname{rank}\\) \u63d0\u4f9b\u7684\u662f\u5728\u6392\u540d\u4e0e\u539f\u4e32\u4e4b\u95f4\u76f8\u4e92\u5207\u6362\u7684\u65b9\u5f0f\u3002</p> <ul> <li>\u5982\u679c\u4e00\u4e2a\u8ddf\u5b57\u7b26\u4e32\u81ea\u8eab\u76f8\u5173\u7684\u4e1c\u897f\u662f\u53ef\u4ee5\u589e\u91cf\u7ef4\u62a4\u7684\uff0c\u90a3\u4e48\u8003\u8651\u5728\u539f\u4e32\u4e0a\u505a\u3002</li> </ul>"}, {"location": "Counting/", "title": "Index", "text": "<p>Don\u2019t let them say that your peace is a waste of time.</p> <p>\u672c\u7ae0\u7528\u4ee5\u8bb0\u5f55\u4e00\u4e9b\u7b14\u8005\u5728\u5b66\u4e60\u7ec4\u5408\u8ba1\u6570\u4e2d\u4ea7\u751f\u7684\u7ecf\u9a8c\u548c\u60f3\u6cd5\u3002</p> <p>\u7531\u4e8e\u662f\u5728\u6587\u5316\u8bfe\u95f2\u6687\u65f6\u95f4\u5199\u5c31\uff0c\u65e2\u4e0d\u4fdd\u8d28\u4e5f\u4e0d\u4fdd\u91cf\u3002</p>"}, {"location": "Counting/Analytic-1/Introduction/", "title": "1.\u3010\u7406\u8bba\u3011\u751f\u6210\u51fd\u6570\u7684\u5f15\u5165", "text": "\\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\Endpos{\\operatorname{Endpos}} \\newcommand\\Startpos{\\operatorname{Startpos}} \\newcommand\\height{\\operatorname{height}} \\newcommand\\SA{\\operatorname{SA}} \\newcommand\\len{\\operatorname{len}} \\newcommand\\chkmax{\\operatorname{chkmax}} \\newcommand\\chkmin{\\operatorname{chkmin}} \\newcommand\\siz{\\operatorname{siz}} \\newcommand\\fa{\\operatorname{fa}} \\newcommand\\LCP{\\operatorname{LCP}} \\newcommand\\EGF{\\operatorname{EGF}} \\newcommand\\OGF{\\operatorname{OGF}} \\newcommand\\bd{\\operatorname{Border}} \\newcommand\\mbd{\\operatorname{MaxBorder}} \\] <p>\"A generating function is a device somewhat similar to a bag. Instead of carrying many little objects detachedly, which could be embarrassing, we put them all in a bag, and then we have only one object to carry, the bag.\"</p> <p>\u2014 George\u202fP\u00f3lya, Mathematics and Plausible Reasoning (1954)</p> <p>\u7406\u8bba\u4e0a\uff0c\u9605\u8bfb\u672c\u7cfb\u5217\u6587\u7ae0\u5e76\u4e0d\u9700\u8981\u4ec0\u4e48\u524d\u7f6e\u77e5\u8bc6\uff0c\u9047\u5230\u4e0d\u4f1a\u7684\u518d\u53bb\u67e5\u5c31\u591f\u7528\u4e86\u3002\u4f46\u6211\u4ecd\u7136\u5efa\u8bae\u60a8\u6700\u597d\u638c\u63e1\u4e00\u4e9b\u57fa\u7840\u7684\u5fae\u79ef\u5206\u77e5\u8bc6\uff0c\u548c\u4e00\u4e9b\u57fa\u7840\u7684\u7ec4\u5408\u8ba1\u6570\u624b\u6cd5\u3002</p> <p>\u672c\u7cfb\u5217\u5185\u5bb9\u5927\u91cf\u6284\u88ad\u81ea\u5982\u4e0b\u8d44\u6599\uff1a</p> <ol> <li>command_block \u8001\u5e08\u7684\u591a\u9879\u5f0f\u8ba1\u6570\u6742\u8c08\u3002</li> </ol> <p>\u6211\u4eec\u4f1a\u5148\u7565\u53bb\u5404\u79cd\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u4e0d\u751a\u91cd\u8981\u7684\u57fa\u7840\u8bc1\u660e\uff0c\u5c06\u4e00\u4e9b\u8fd0\u7b97\u6cd5\u5219\u5f53\u6210\u516c\u7406\u6765\u7528\uff0c\u5f85\u5230\u7cfb\u5217\u7ed3\u675f\uff0c\u6211\u4eec\u4f1a\u5bf9\u6240\u6709\u4e0d\u52a0\u8bc1\u660e\u5730\u7ed9\u51fa\u7684\u7ed3\u8bba\u4f5c\u5b8c\u6574\u7684\u8bc1\u660e\u3002</p>"}, {"location": "Counting/Analytic-1/Introduction/#_1", "title": "\u751f\u6210\u51fd\u6570\u7684\u5f15\u5165", "text": "<p>\u6b63\u5982 P\u00f3lya \u6240\u8a00\uff0c\u4f7f\u7528\u751f\u6210\u51fd\u6570\u5904\u7406\u95ee\u9898\u7684\u4e00\u4e2a\u57fa\u672c\u601d\u60f3\u5c31\u662f\u8bd5\u7740\u5c06\u6574\u4e2a\u5e8f\u5217\u6253\u5305\u6210\u4e00\u4e2a\u6574\u4f53\uff0c\u8fd9\u4e2a\u6574\u4f53\u5305\u542b\u4e86\u5e8f\u5217\u7684\u5168\u90e8\u4fe1\u606f\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u7684\u5904\u7406\u4e2d\u5c31\u53ea\u7528\u8003\u8651\u8fd9\u4e2a\u6574\u4f53\uff0c\u800c\u4e0d\u662f\u8003\u8651\u6570\u5217\u7684\u6bcf\u4e00\u9879\u3002</p> <p>\u90a3\u4e48\u8be5\u5982\u4f55\u6267\u884c\u8fd9\u4e2a\u6253\u5305\u7684\u8fc7\u7a0b\uff1fEuler \u7ed9\u51fa\u4e86\u4e00\u4e2a\u529e\u6cd5\uff0c\u6211\u4eec\u5b9a\u4e49\u5e8f\u5217 \\(\\{a_n\\}\\) \u7684 OGF(Ordinary Generating Function\uff0c \u666e\u901a\u751f\u6210\u51fd\u6570) \u4e3a</p> \\[ A(x)=\\sum_{i=0}^{\\infty}a_ix^i \\] <p>\u5176\u4e2d\uff0c\\(x\\) \u662f\u7528\u6765\u533a\u5206\u6570\u5217\u5404\u9879\u7684\u5f62\u5f0f\u53d8\u5143\u3002\u8bb0 \\([x^n]A(x)=a_n\\)\uff0c\u5373 \\(A(x)\\) \u7684 \\(n\\) \u6b21\u9879\u7cfb\u6570\u3002</p> <p>\u8fd9\u770b\u8d77\u6765\u53ea\u662f\u6362\u4e86\u4e00\u79cd\u65b9\u6cd5\u5199\u51fa\u6211\u4eec\u7684\u5e8f\u5217\uff0c\u8fd9\u6bd4\u8d77\u539f\u5148\u7684\u65b9\u6cd5\u6709\u4ec0\u4e48\u4f18\u8d8a\u6027\uff1f\u8ba9\u6211\u4eec\u5148\u6765\u5c1d\u8bd5\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5373\u6ee1\u8db3 \\(f_n=1\\) \u7684\u6570\u5217 \\(\\{f_n\\}\\)\u3002\u5b83\u7684\u751f\u6210\u51fd\u6570 \\(F(x)\\) \u4e3a\uff1a</p> \\[ F(x)=\\sum_{i=0}^{\\infty}x^i \\] <p>\u8981\u7814\u7a76\u4e00\u4e2a\u6d89\u53ca\u65e0\u7a77\u7684\u7ed3\u6784\uff0c\u4e00\u79cd\u5e38\u7528\u7684\u65b9\u6cd5\u662f\u5c06\u5176\u81ea\u6211\u8868\u793a\uff0c\u6211\u4eec\u6709\uff1a</p> \\[ \\begin{aligned} F(x)&amp;=1+x+x^2+x^3+x^4+x^5+\\cdots\\\\ xF(x)&amp;=\\hspace{1.75em}x+x^2+x^3+x^4+x^5+\\cdots \\end{aligned} \\] <p>\u6240\u4ee5\u6709</p> \\[ 1+xF(x)=F(x)\\Longrightarrow F(x)=\\frac{1}{1-x} \\] <p>\u6211\u4eec\u628a\u53f3\u5f0f\u8fd9\u6837<sup>1</sup>\u7684\u5f62\u5f0f\u53eb\u505a\u5c01\u95ed\u5f62\u5f0f\u3002</p> <p>\u5b66\u8fc7\u6570\u5b66\u5206\u6790\u7684\u670b\u53cb\u4eec\u4f1a\u6307\u51fa\uff0c\u6211\u4eec\u521a\u521a\u64cd\u4f5c\u65e0\u7a77\u7684\u8fc7\u7a0b\u8fc7\u4e8e\u8f7b\u7387\uff1a\u5982\u679c \\(|x|\\ge 1\\)\uff0c\u90a3\u4e48 \\(F(x)\\) \u4e0d\u6536\u655b\uff0c\u5bf9\u4e24\u4e2a\u65e0\u7a77\u5927\u52a0\u51cf\u662f\u6ca1\u6709\u610f\u4e49\u7684\u3002</p> <p>\u8fd9\u6837\u7684\u6c42\u548c\u6210\u7acb\u7684\u539f\u56e0\u662f\uff0c\\(x\\) \u5728\u6b64\u5904\u4ec5\u4f5c\u5f62\u5f0f\u53d8\u5143\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u770b\u4f5c\u662f\u4e00\u4e2a\u5360\u4f4d\u7b26\uff0c\u5b83\u5b58\u5728\u7684\u610f\u4e49\u53ea\u662f\u533a\u5206\u6570\u5217\u7684\u5404\u9879\uff0c\u4e0d\u4f1a\u662f\u4efb\u4f55\u7684\u6570\uff08\u8fd9\u5c31\u662f\u5b83\u88ab\u79f0\u4e3a\u5f62\u5f0f\u7684\u539f\u56e0\uff09\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u4e0d\u5728\u4e4e\u5b83\u7684\u655b\u6563\u6027\uff0c\u4e5f\u4e0d\u5728\u4e4e\u5b83\u7684\u53d6\u503c\uff0c\u53ef\u4ee5\u5047\u5b9a\u6c42\u548c\u603b\u662f\u6536\u655b\u3002\u6211\u4eec\u79f0\u8fd9\u6837 \\(x\\) \u4f5c\u4e3a\u5f62\u5f0f\u53d8\u5143\u7684\u5e42\u7ea7\u6570\u662f\u5f62\u5f0f\u5e42\u7ea7\u6570\u3002</p> <p>\u4e0d\u52a0\u8bc1\u660e\u5730\uff0c\u6211\u4eec\u8bf4\u751f\u6210\u51fd\u6570\u7684\u52a0\uff0c\u51cf\uff0c\u4e58\u5206\u522b\u5bf9\u5e94\u5e8f\u5217\u7684\u5982\u4e0b\u53d8\u6362\uff1a</p> <ol> <li>\\(C(x)=A(x)\\pm B(x)\\iff [x^n]C(x)=[x^n]A(x)\\pm [x^n]B(x)\\)</li> <li>\\(\\displaystyle C(x)=A(x)B(x)\\iff [x^n]C(x)=\\sum_{i=0}^{n}[x^{n-i}]A(x)[x^i]B(x)\\)</li> </ol> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4ed6\u4eec\u7684\u5c01\u95ed\u5f62\u5f0f\u4f5c\u524d\u8005\u7684\u8fd0\u7b97\uff0c\u5c31\u7b49\u4e8e\u5bf9\u5b83\u4eec\u7684\u5c55\u5f00\u5f0f\u4f5c\u540e\u8005\u7684\u53d8\u6362\u3002</p>"}, {"location": "Counting/Analytic-1/Introduction/#_2", "title": "\u751f\u6210\u51fd\u6570\u4e0e\u5e38\u7cfb\u6570\u9f50\u6b21\u7ebf\u6027\u9012\u63a8", "text": ""}, {"location": "Counting/Analytic-1/Introduction/#_3", "title": "\u6590\u6ce2\u90a3\u5951\u6570\u5217", "text": "<p>\u4e0a\u9762\u53ea\u662f\u8bb2\u4e86\u4e00\u4e9b\u62bd\u8c61\u7684\u5e9f\u8bdd\uff0c\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8bd5\u7740\u7528\u751f\u6210\u51fd\u6570\u6765\u89e3\u51b3\u4e00\u4e9b\u7b80\u5355\u7684\u95ee\u9898\uff1a\u6c42\u6590\u6ce2\u90a3\u5951\u6570\u5217<sup>2</sup> \\(\\{f_n\\}\\) \u7684\u901a\u9879\u516c\u5f0f\u3002</p> <p>\u5148\u8bd5\u7740\u50cf\u4e0a\u9762\u4e00\u6837\u8868\u793a\u51fa \\(\\{f_n\\}\\) \u7684\u751f\u6210\u51fd\u6570 \\(F(x)\\)\uff0c\u6211\u4eec\u6709\uff1a</p> \\[ \\begin{aligned} F(x)&amp;=f_0+f_1x^1+f_2x^2+f_3x^3+\\cdots\\\\ xF(x)&amp;=\\hspace{2.2em}f_0x^1+f_1x^2+f_2x^3+\\cdots\\\\ x^2F(x)&amp;=\\hspace{5.4em}f_0x^2+f_1x^3+\\cdots \\end{aligned} \\] <p>\u5982\u6b64\u6bd4\u5bf9\u7cfb\u6570\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u6709</p> \\[ x+xF(x)+x^2F(x)=F(x)\\iff F(x)=\\frac{x}{1-x-x^2} \\] <p>\u6211\u4eec\u5c3d\u91cf\u5f80\u4e4b\u524d\u7684\u4f8b\u5b50 \\(\\frac{1}{1-x}\\) \u7684\u5f62\u5f0f\u4e0a\u51d1\uff0c\u5373\u5206\u5b50\u662f\u4e2a\u5e38\u6570\uff0c\u5206\u6bcd\u662f\u4e2a\u4e00\u6b21\u5f0f\u3002</p> <p>\u6211\u4eec\u65ad\u8a00 \\(\\frac{x}{1-x-x^2}\\) \u80fd\u88ab\u5199\u6210\u8fd9\u6837\u7684\u4e24\u4e2a\u5206\u5f0f\u4e4b\u548c\uff0c\u5373\uff1a</p> \\[ \\frac{x}{1-x-x^2}=\\frac{-x}{x^2+x-1}=\\frac{a}{x-\\alpha}+\\frac{b}{x-\\beta} \\] <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u628a\u8fd9\u4e9b\u53c2\u6570\u4e00\u4e00\u6c42\u51fa\uff0c\u9996\u5148\u80af\u5b9a\u6709 \\(\\alpha\uff0c\\beta\\) \u662f \\(x^2+x-1\\) \u7684\u4e24\u6839\uff0c\u89e3\u5f97 \\(\\alpha=\\frac{-1-\\sqrt 5}{2}\uff0c\\beta=\\frac{-1+\\sqrt 5}{2}\\)\u3002</p> <p>\u53c8\u77e5\u9053 \\(a(x-\\beta)+b(x-\\alpha)=-x\\)\uff0c\u6bd4\u5bf9\u7cfb\u6570\u6709 \\(a+b=-1\\land a\\beta +b\\alpha =0\\)\uff0c\u89e3\u5f97 \\(a=\\frac{-5-\\sqrt 5}{10}\uff0cb=\\frac{-5+\\sqrt 5}{10}\\)\u3002</p> <p>\u5982\u6b64\uff0c\u56db\u4e2a\u5e38\u6570\u5747\u5df2\u77e5\uff0c\u7531\u4e00\u5f00\u59cb\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u77e5\u9053 \\(\\displaystyle \\frac{1}{1-qx}=\\sum_{i=0}^{\\infty}q^ix^i\\)\u3002\u4ece\u800c\uff1a</p> \\[ \\frac{a}{x-\\alpha}+\\frac{b}{x-\\beta}=\\frac{-\\frac{a}{\\alpha}}{1-\\frac{1}{\\alpha}x}+\\frac{-\\frac{b}{\\beta}}{1-\\frac{1}{\\beta}x}=-\\frac{a}{\\alpha}\\sum_{i=0}^{\\infty}\\frac{1}{\\alpha^i}x^i-\\frac{b}{\\beta}\\sum_{i=0}^{\\infty}\\frac{1}{\\beta^i}x^i \\] <p>\u63d0\u53d6\u5176\u7b2c \\(n\\) \u6b21\u9879\u5e76\u6574\u7406\uff1a</p> \\[ \\begin{aligned} \\phantom{-}[x^n]\\frac{1}{1-x-x^2}&amp;=-\\qty(\\frac{a}{\\alpha^{n+1}}+\\frac{b}{\\beta^{n+1}})\\\\ &amp;=-\\qty(\\dfrac{\\frac{-5-\\sqrt 5}{10}}{\\qty(\\frac{-1-\\sqrt 5}{2})^{n+1}}+\\dfrac{\\frac{-5+\\sqrt 5}{10}}{\\qty(\\frac{-1+\\sqrt 5}{2})^{n+1}})\\\\ &amp;=-\\frac{1}{\\sqrt 5}\\qty(\\dfrac{1}{\\qty(\\frac{-1-\\sqrt 5}{2})^{n}}-\\dfrac{1}{\\qty(\\frac{-1+\\sqrt 5}{2})^{n}})\\\\ &amp;=-\\frac{1}{\\sqrt 5}\\qty(\\dfrac{2^n}{\\qty(-1-\\sqrt 5)^{n}}-\\dfrac{2^n}{\\qty(-1+\\sqrt 5)^{n}})\\\\ &amp;=\\frac{1}{\\sqrt 5}\\qty(\\qty(\\dfrac{\\sqrt 5+1}{2})^n-\\qty(\\dfrac{-\\sqrt 5 +1}{2})^n)&amp;\\text{Rationalizing the denominator} \\end{aligned} \\] <p>\u4e8e\u662f\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u901a\u9879\u516c\u5f0f\uff1a</p> \\[ f_n=\\frac{1}{\\sqrt 5}\\qty(\\qty(\\dfrac{\\sqrt 5+1}{2})^n-\\qty(\\dfrac{-\\sqrt 5 +1}{2})^n) \\]"}, {"location": "Counting/Analytic-1/Introduction/#_4", "title": "\u66f4\u4e00\u822c\u7684\u60c5\u5f62\uff1f", "text": "<p>\u5047\u8bbe\u6709\u5e8f\u5217 \\(\\{f_n\\}\\)\uff0c\u7ed9\u51fa\u5176 \\(0\\sim m-1\\) \u9879\uff0c\u518d\u7ed9\u51fa\u4e00\u4e2a\u5e38\u6570\u5e8f\u5217 \\(\\langle a_1,a_2,\\cdots, a_m\\rangle\\)\uff0c\u5bf9\u4e8e \\(k\\ge m\\) \u6709\uff1a</p> \\[ f_k=\\sum_{i=1}^{m}f_{k-i}a_i \\] <p>\u8fd9\u6837\u7684\u9012\u63a8\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a\u5e38\u7cfb\u6570\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\uff0c\u6211\u4eec\u8bd5\u7740\u4e3a\u5b83\u6784\u9020\u4e00\u4e2a\u751f\u6210\u51fd\u6570\u3002</p> <p>\u4ecd\u7136\u8bd5\u7740\u505a\u4e0a\u9762\u7c7b\u4f3c\u7684\u5c1d\u8bd5\uff0c\u79f0\u5176\u751f\u6210\u51fd\u6570\u4e3a \\(F(x)\\)\uff0c\u6784\u9020\u4e00\u4e2a \\(m\\) \u6b21\u591a\u9879\u5f0f \\(Q\\)\uff0c\u4f7f\u5176\u6709 \\([x^0]Q(x)=-1,[x^k]Q(x)=a_k(0&lt;k\\le m)\\)\u3002</p> <p>\u5bb9\u6613\u77e5\u9053 \\([x^k]F(x)Q(x)\\) \u5728 \\(k\\ge m\\) \u7684\u60c5\u51b5\u4e0b\u4e3a \\(0\\)\uff0c\u800c \\(F(x)\\) \u7684 \\(&lt;m\\) \u6b21\u9879\u5df2\u77e5\uff0c\\(Q(x)\\) \u7684 \\(\\le m\\) \u6b21\u9879\u5df2\u77e5\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa \\(P(x)\\) \u4e3a</p> \\[ P(x)=F(x)Q(x)\\pmod {x^m} \\] <p>\u5176\u4e2d\u4e00\u4e2a\u5f62\u5f0f\u5e42\u7ea7\u6570 \\(G(x)\\) \u5bf9 \\(x^k\\) \u53d6\u6a21\u7684\u610f\u4e49\u4e3a\uff0c\u5c06\u5176 \\(\\ge k\\) \u6b21\u5e42\u7684\u7cfb\u6570\u8bbe\u7f6e\u4e3a \\(0\\)\u3002</p> <p>\u8fd9\u6837\u5c31\u6709\uff1a</p> \\[ F(x)Q(x)-P(x)=0\\iff F(x)=\\frac{P(x)}{Q(x)} \\] <p>\u6211\u4eec\u8fd8\u4e0d\u4f1a\u5bf9\u8fd9\u4e2a\u5f0f\u5b50\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u5904\u7406\uff0c\u6682\u65f6\u5230\u6b64\u4e3a\u6b62\u5427\u3002</p> <ol> <li> <p>\u7531\u5e38\u6570\uff0c\u53d8\u91cf\uff0c\u57fa\u672c\u51fd\u6570\u7684\u6709\u9650\u6b21\u56db\u5219\u8fd0\u7b97/\u4e58\u65b9/\u51fd\u6570\u590d\u5408\u5f97\u6765\u7684\u5f0f\u5b50\u00a0\u21a9</p> </li> <li> <p>\\(f_0=0\uff0cf_1=1\uff0c f_{n}=f_{n-1}+f_{n-2}(n\\ge 2)\\) \u21a9</p> </li> </ol>"}, {"location": "Counting/Analytic-1/Symmetry/", "title": "2.\u3010\u7406\u8bba\u3011\u7fa4\u4e0e\u5bf9\u79f0", "text": "\\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\Endpos{\\operatorname{Endpos}} \\newcommand\\Startpos{\\operatorname{Startpos}} \\newcommand\\height{\\operatorname{height}} \\newcommand\\SA{\\operatorname{SA}} \\newcommand\\len{\\operatorname{len}} \\newcommand\\chkmax{\\operatorname{chkmax}} \\newcommand\\chkmin{\\operatorname{chkmin}} \\newcommand\\siz{\\operatorname{siz}} \\newcommand\\fa{\\operatorname{fa}} \\newcommand\\LCP{\\operatorname{LCP}} \\newcommand\\EGF{\\operatorname{EGF}} \\newcommand\\OGF{\\operatorname{OGF}} \\newcommand\\bd{\\operatorname{Border}} \\newcommand\\mbd{\\operatorname{MaxBorder}} \\] <p>\u672c\u8282\u5185\u5bb9\u662f\u4e0b\u4e00\u8282\u90e8\u5206\u5185\u5bb9\u7684\u57fa\u7840\uff0c\u4f46\u4e0d\u4f1a\u672c\u8282\u7684\u5185\u5bb9\u4e5f\u4e0d\u5f71\u54cd\u4f60\u9605\u8bfb\u4e0b\u4e00\u8282\u7684\u5927\u90e8\u5206\u5185\u5bb9\u3002</p>"}, {"location": "Counting/Analytic-1/Symmetry/#_1", "title": "\u7fa4\u7684\u5f15\u5165", "text": "<p>\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u5bf9\u79f0\u7684\u64cd\u4f5c\u7684\u96c6\u5408 \\(G\\)\uff0c\u7ec4\u5408\u5bf9\u8c61\u7684\u5168\u96c6\u8bb0\u4e3a \\(X\\)\uff0c\u4e00\u4e2a\u7ec4\u5408\u5bf9\u8c61 \\(x\\) \u80fd\u591f\u901a\u8fc7 \\(G\\) \u4e2d\u7684\u64cd\u4f5c\u751f\u6210\u5176\u4ed6\u7684\u7ec4\u5408\u5bf9\u8c61\u3002\u6211\u4eec\u8bf4\u8fd9\u4e9b\u7ec4\u5408\u5bf9\u8c61\u7b49\u4ef7\uff0c\u9700\u8981\u8ba1\u6570\u6240\u6709\u7b49\u4ef7\u7c7b\u7684\u4e2a\u6570\u3002</p> <p>\u4f8b\u5b50</p> <ol> <li>\u7ed9\u4e00\u4e2a \\(n\\) \u5143\u73af\u8282\u70b9\u6807\u53f7\uff0c\u4e24\u4e2a\u73af\u540c\u6784\uff08\u4e8b\u5b9e\u4e0a\u73af\u4e0a\u5c31\u662f\u80fd\u901a\u8fc7\u65cb\u8f6c\u91cd\u5408\uff09\uff0c\u5219\u89c6\u4e3a\u540c\u4e00\u4e2a\u73af\u3002</li> <li>\u7ed9\u4e00\u4e2a\u7acb\u65b9\u4f53\u7684 \\(6\\) \u4e2a\u9762\u6d82\u4e0a\u989c\u8272\uff0c\u5982\u679c\u4e24\u4e2a\u7acb\u65b9\u4f53\u80fd\u591f\u901a\u8fc7\u65cb\u8f6c\u91cd\u5408\uff0c\u5219\u89c6\u4e3a\u540c\u4e00\u4e2a\u7acb\u65b9\u4f53\u3002</li> <li>\u2026\u2026</li> </ol> <p>\u4e3a\u4e86\u7ed9\u8fd9\u4e9b\u8ba1\u6570\u95ee\u9898\u4e00\u4e2a\u901a\u7528\u7684\u89e3\u51b3\u65b9\u6cd5\uff0c\u6211\u4eec\u5c31\u5fc5\u987b\u7814\u7a76\u8fd9\u4e9b\u5bf9\u79f0\u64cd\u4f5c\u7ec4\u6210\u7684\u7ed3\u6784\u3002</p> <p>\u82e5 \\(x,y\\) \u4e24\u4e2a\u5bf9\u8c61\u672c\u8d28\u5c5e\u6027\u76f8\u540c\uff0c\u5219\u6211\u4eec\u8bf4 \\(x\\sim y\\)\u3002\u6211\u4eec\u8bf4 \\(f\\) \u662f\u4e00\u4e2a\u5bf9\u79f0\u64cd\u4f5c\uff0c\u5176\u4f5c\u7528\u5728 \\(x\\) \u4e0a\u7684\u7ed3\u679c\u8bb0\u4f5c \\(f(x)\\)\uff0c\u90a3\u4e48\u6709 \\(\\forall x\\in X,x\\sim f(x)\\)\uff0c\u4e5f\u5c31\u662f\u4efb\u610f\u4e00\u4e2a\u5bf9\u8c61 \\(x\\) \u5728 \\(f\\) \u7684\u4f5c\u7528\u4e0b\u672c\u8d28\u5c5e\u6027\u90fd\u4e0d\u6539\u53d8\u3002</p> <ol> <li>\u82e5 \\(f,g\\) \u90fd\u662f\u5bf9\u79f0\u64cd\u4f5c\uff0c\u90a3\u4e48 \\(x\\sim g(x)\\)\uff0c\u81ea\u7136\u6709 \\(g(x)\\sim f(g(x))\\)\u3002\u4e5f\u5c31\u662f\u8bf4\u5148\u6267\u884c \\(f\\)\uff0c\u518d\u6267\u884c \\(g\\)\uff0c\u8fd9\u4e24\u6b65\u5408\u5728\u4e00\u8d77\u7684\u53d8\u6362\u4e5f\u662f\u4e00\u4e2a\u5bf9\u79f0\u64cd\u4f5c\u3002\u6211\u4eec\u628a\u8fd9\u4e2a\u64cd\u4f5c\u8bb0\u4f5c \\(f\\circ g\\)\uff0c\u90a3\u4e48\u5c31\u662f\u8bf4 \\(\\forall f,g\\in G,f\\circ g\\in G\\)\u3002</li> <li>\u5bf9\u4e8e\u79bb\u6563\u7684\u5bf9\u8c61\u6765\u8bf4\uff0c\u5bf9\u79f0\u603b\u662f\u4e00\u79cd\u4fdd\u6301\u7ed3\u6784\u4e0d\u53d8\u7684\u91cd\u6807\u53f7\u65b9\u5f0f\u3002\u4e5f\u5c31\u662f\u8bf4 \\(f\\) \u662f\u4e00\u4e2a\u51fd\u6570 \\([n]\\rightarrow [n]\\)\uff0c\u51fd\u6570\u590d\u5408\u5fc5\u7136\u6709\u7ed3\u5408\u5f8b\uff0c\u5373 \\(\\forall f,g,h\\in G,(f\\circ g)\\circ h=f\\circ (g\\circ h)\\)\u3002</li> <li>\u5fc5\u7136\u5b58\u5728 \\(e\\in G\\)\uff0c\\(e(x)=x\\)\uff0c\u56e0\u4e3a\u4ec0\u4e48\u90fd\u4e0d\u505a\u540c\u6837\u4e0d\u4f1a\u6539\u53d8\u5176\u672c\u8d28\u5c5e\u6027\u3002</li> <li>\u7531\u4e8e \\(x\\sim f(x)\\)\uff0c\u90a3\u4e48\u5c31\u5fc5\u7136\u6709 \\(f(x)\\sim x\\)\uff0c\u5982\u679c\u5c06 \\(x\\) \u770b\u4f5c\u662f \\(f(x)\\) \u65bd\u52a0\u64cd\u4f5c\u624d\u5f97\u5230\u7684\uff0c\u90a3\u4e48\u5c31\u5fc5\u7136 \\(\\exists f^{-1} \\in G\\)\uff0c\\(f(x)\\sim (f^{-1}\\circ f)(x)\\)\uff0c\u4e5f\u5c31\u662f\u8bf4 \\(\\forall f\\in G,\\exists f^{-1}\\in G,f^{-1}\\circ f=e\\)\u3002</li> </ol> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u8ba8\u8bba\uff0c\u6211\u4eec\u53ef\u4ee5\u8bf4\uff1a\u5bf9\u79f0\u64cd\u4f5c\u96c6\u5408 \\(G\\) \u5728\u64cd\u4f5c\u590d\u5408\u8fd0\u7b97 \\(\\circ\\) \u4e0b\u6784\u6210\u4e00\u4e2a\u7fa4\u3002\u5bf9\u79f0\u53d8\u6362\u662f\u7fa4 \\(G\\) \u5bf9\u7ec4\u5408\u5bf9\u8c61\u96c6\u5408 \\(X\\) \u7684\u7fa4\u4f5c\u7528\u3002\u6211\u4eec\u8981\u8ba1\u6570\u7684\u4e1c\u897f\u5c31\u662f\u7b49\u4ef7\u7c7b\u96c6\u5408 \\(X/G\\) \u7684\u5927\u5c0f \\(|X/G|\\)\u3002</p>"}, {"location": "Counting/Analytic-1/Symmetry/#-", "title": "\u8f68\u9053-\u7a33\u5b9a\u5b50\u7fa4\u5b9a\u7406", "text": "<p>\u6709\u51e0\u4e2a\u7ed3\u6784\u662f\u503c\u5f97\u6211\u4eec\u6ce8\u610f\u7684</p> <ol> <li>\u5bf9\u8c61 \\(x\\) \u7684\u8f68\u9053 \\(O_x=\\{f(x):f\\in G\\}\\)\uff0c\u4e5f\u5c31\u662f \\(x\\) \u7684\u7b49\u4ef7\u7c7b\u96c6\u5408\u3002</li> <li>\u7a33\u5b9a\u5b50\u7fa4 \\(G_x=\\{f\\in G:f(x)=x\\}\\)\uff0c\u4e5f\u5c31\u662f\u4f5c\u7528\u5728 \\(x\\) \u4e0d\u53d8\u7684\u90a3\u4e9b\u53d8\u6362\u7ec4\u6210\u7684\u96c6\u5408\u3002\u5b83\u662f \\(G\\) \u7684\u5b50\u7fa4\u662f\u6613\u8bc1\u7684\u3002</li> <li>\u4e0d\u52a8\u70b9 \\(X^g=\\{x\\in X:g(x)=x\\}\\)\uff0c\u5728 \\(g\\) \u4f5c\u7528\u4e0b\u4e0d\u53d8\u7684\u7ed3\u6784\u3002</li> </ol> <p>\u5bf9\u4e8e\u524d\u4e24\u4e2a\u7ed3\u6784\uff0c\u6211\u4eec\u6709\u8f68\u9053-\u7a33\u5b9a\u5b50\u7fa4\u5b9a\u7406</p> \\[ \\forall x\\in X,|O_x|\\cdot |G_x|=|G| \\] <p>\u8fd9\u4e2a\u5f62\u5f0f\u4e00\u770b\u5c31\u50cf\u62c9\u683c\u6717\u65e5\u5b9a\u7406\u554a\uff01\u4e8b\u5b9e\u4e0a\u4e00\u79cd\u8bc1\u660e\u65b9\u6cd5\u5c31\u662f\u5728\u8f68\u9053\u4e0e \\(G_x\\) \u5728 \\(G\\) \u4e2d\u7684\u5de6\u966a\u96c6\u5efa\u7acb\u53cc\u5c04\uff0c\u4e0d\u8fc7\u6211\u4eec\u8fd9\u91cc\u4e0d\u8fd9\u4e48\u5e72\u3002\u6211\u4eec\u7528\u66f4\u7b80\u5355\u7684\u53e6\u4e00\u79cd\u7406\u89e3\u65b9\u5f0f\u3002</p> <p>\u6211\u4eec\u77e5\u9053</p> \\[ |G|=\\sum_{y\\in O_x}|G_{x\\rightarrow y}| \\] <p>\u5f15\u7406</p> <p>\u82e5 \\(f(x)=y\\)\uff0c\u5219 \\(\\{f\\circ g: g\\in G_x\\}=G_{x\\rightarrow y}\\)\uff0c\\(|G_x|=|G_{x\\rightarrow y}|\\)\u3002</p> <p>\u4eba\u8bdd\u5c31\u662f\uff0c\u65e0\u8bba\u662f\u54ea\u4e2a \\(f\\in G_{x\\rightarrow y}\\)\uff0c\u901a\u8fc7\u53f3\u590d\u5408\u4e0a\u6240\u6709 \\(g\\in G_x\\)\uff0c\u90fd\u80fd\u751f\u6210\u6574\u4e2a \\(G_{x\\rightarrow y}\\)\u3002</p> <p>\u8ba9\u6211\u4eec\u6765\u8bc1\u660e\u8fd9\u4e2a\u5f15\u7406</p> <ol> <li> <p>\u9996\u5148\uff0c\u6211\u4eec\u8bc1\u660e \\(\\{f\\circ g:g\\in G_x\\}\\subseteq G_{x\\rightarrow y}\\)\u3002</p> <p>\u8fd9\u662f\u663e\u7136\u7684\uff0c\u56e0\u4e3a \\(f(g(x))=f(x)=y\\)\u3002</p> </li> <li> <p>\u4e0b\u4e00\u6b65\uff0c\u6211\u4eec\u8bc1\u660e \\(\\{f\\circ g:G_x\\}=|G_x|\\)\u3002</p> <p>\u8fd9\u4e5f\u662f\u663e\u7136\u7684\uff0c\u5373\u8bc1\u660e \\(\\forall g_1,g_2\\in G_x,g_1\\neq g_2\\Longrightarrow f\\circ g_1\\neq f\\circ g_2\\)\u3002\u53cd\u8bc1\uff0c\u5047\u8bbe\u6210\u7acb\uff0c\u53f3\u6d88\u53bb\u5f8b\u544a\u8bc9\u6211\u4eec \\(g_1=g_2\\)\uff0c\u77db\u76fe\u3002</p> <p>\u7ed3\u5408 1\uff0c\u8fd9\u544a\u8bc9\u6211\u4eec \\(|G_x|\\le |G_{x\\rightarrow y}|\\)\u3002</p> </li> <li> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8bc1\u660e \\(|G_{x\\rightarrow y}|\\le |G_x|\\)\uff0c\u6545\u6280\u91cd\u65bd\u5373\u53ef\uff0c\u5bf9\u4e8e \\(\\forall f\\in G_{x\\rightarrow y},\\exists g\\in G_{y\\rightarrow x}\\)\u3002\u90a3\u4e48\u5bf9\u4e8e\u540c\u4e00\u4e2a \\(g\\)\uff0c\u6240\u6709\u7684 \\(f\\circ g\\) \u5fc5\u5b9a\u4e24\u4e24\u4e0d\u540c\uff0c\u6240\u4ee5 \\(|\\{f\\circ g:f\\in G_{x\\rightarrow y}\\}|=|G_{x\\rightarrow y}|\\)\uff0c\u53c8\u6709 \\(\\{f\\circ g:f\\in G_{x\\rightarrow y}\\}\\subseteq G_x\\)\uff0c\u6545 \\(|G_{x\\rightarrow y}|\\le |G_x|\\)\u3002Q.E.D\uff01</p> </li> </ol> <p>\u6709\u4e86 \\(|G_{x\\rightarrow y}|=|G_x|\\) \u8fd9\u4e2a\u5f15\u7406\uff0c\u4e00\u5207\u5c31\u53d8\u5f97\u5bb9\u6613\u4e86\u3002</p> \\[ |G|=\\sum_{y\\in O_x}|G_{x\\rightarrow y}|=|O_x|\\cdot |G_x| \\]"}, {"location": "Counting/Analytic-1/Symmetry/#burnsides-lemma", "title": "Burnside's Lemma", "text": "<p>\u53c8\u53eb Not Burnside's Lemma\u3002</p> <p>\u6211\u4eec\u518d\u8003\u5bdf\u4e0a\u9762\u7684\u7b2c\u4e09\u4e2a\u7ed3\u6784\uff1a\u4e0d\u52a8\u70b9\u3002</p> \\[ \\sum_{x\\in X,g\\in G}[g(x)=x]=\\sum_{g\\in G}X^g=\\sum_{x\\in X}G_x \\] <p>\u7136\u540e\u60f3\u60f3\u6211\u4eec\u600e\u4e48\u8868\u793a\u8f68\u9053\u6570 \\(|X/G|\\)\u3002\u5bf9\u6bcf\u4e2a\u8f68\u9053\uff0c\u6211\u4eec\u8981\u8ba9\u6240\u6709 \\(y\\in O_x\\) \u52a0\u8d77\u6765\u6070\u597d\u662f \\(1\\)\uff0c\u7acb\u5373\u6709\uff1a</p> \\[ |X/G|=\\sum_{x\\in X}\\frac{1}{|O_x|}=\\sum_{x\\in X}\\frac{|G_x|}{|G|}=\\frac{1}{|G|}\\sum_{g\\in G}X^g \\] <p>\u8fd9\u5c31\u662f Burnside's Lemma\uff1a\u8f68\u9053\u6570=\u6240\u6709\u53d8\u6362\u4e0d\u52a8\u70b9\u4e2a\u6570\u7684\u5e73\u5747\u503c\u3002</p>"}, {"location": "Counting/Analytic-1/Symmetry_dia/", "title": "Symmetry dia", "text": "\\[ \\rm{Define\\ \\LaTeX \\ Macros\\ Here} \\newcommand\\stirA[2]{\\begin{bmatrix}#1\\\\ #2\\end{bmatrix}} \\newcommand\\stirB[2]{\\begin{Bmatrix}#1\\\\ #2\\end{Bmatrix}} \\newcommand\\ul[1]{\\underline{#1}} \\newcommand\\dis{\\operatorname{dis}} \\newcommand\\edp{\\operatorname{edp}} \\newcommand\\Endpos{\\operatorname{Endpos}} \\newcommand\\Startpos{\\operatorname{Startpos}} \\newcommand\\height{\\operatorname{height}} \\newcommand\\SA{\\operatorname{SA}} \\newcommand\\len{\\operatorname{len}} \\newcommand\\chkmax{\\operatorname{chkmax}} \\newcommand\\chkmin{\\operatorname{chkmin}} \\newcommand\\siz{\\operatorname{siz}} \\newcommand\\fa{\\operatorname{fa}} \\newcommand\\LCP{\\operatorname{LCP}} \\newcommand\\EGF{\\operatorname{EGF}} \\newcommand\\OGF{\\operatorname{OGF}} \\newcommand\\bd{\\operatorname{Border}} \\newcommand\\mbd{\\operatorname{MaxBorder}} \\] <p>\u672c\u8282\u5185\u5bb9\u662f\u4e0b\u4e00\u8282\u90e8\u5206\u5185\u5bb9\u7684\u57fa\u7840\uff0c\u4f46\u4e0d\u4f1a\u672c\u8282\u7684\u5185\u5bb9\u4e5f\u4e0d\u5f71\u54cd\u4f60\u9605\u8bfb\u4e0b\u4e00\u8282\u7684\u5927\u90e8\u5206\u5185\u5bb9\u3002</p>"}, {"location": "Counting/Analytic-1/Symmetry_dia/#part-a", "title": "Part A. \u95ee\u9898\u7684\u5f15\u5165", "text": "<p>H\uff1a</p>"}, {"location": "Counting/Musings/Revisiting-PIE/", "title": "\u518d\u8c08\u5bb9\u65a5", "text": "<p>Authored : \ud835\udcab</p> <p>\u8fd9\u4e0d\u662f\u4e00\u4efd\u8bb2\u7a3f\uff0c\u53ea\u662f\u521d\u6b65\u601d\u8003\u7684\u8bb0\u5f55\u3002\u975e\u5e38\uff0c\u975e\u5e38\u4e0d\u6210\u719f\uff0c\u4e0d\u5177\u5907\u4efb\u4f55\u53c2\u8003\u4ef7\u503c\u4e0e\u7814\u7a76\u4ef7\u503c\uff0c\u4ec5\u4f5c\u5907\u5fd8\u4f7f\u7528\u3002</p> <p>H\uff1a\u5f00\u59cb\u5427\u3002</p> <p>N\uff1a\u597d\uff0c\u6211\u4eec\u4eca\u5929\u8981\u8c08\u7684\u662f\u53e6\u4e00\u79cd\u5bb9\u65a5\u7684\u7406\u89e3\u3002</p> <p>H\uff1a\u4ece\u54ea\u91cc\u5f00\u59cb\uff1f</p> <p>N\uff1a\u4f60\u80fd\u8bd5\u7740\u56de\u5fc6\u4e00\u4e0b\u7ecf\u5178\u5bb9\u65a5\u5417\uff1f</p> <p>H\uff1a\u597d\uff0c\u8ba9\u6211\u60f3\u60f3\uff0c\u7ecf\u5178\u5bb9\u65a5\u662f\u8bf4\u8fd9\u6837\u4e00\u4e2a\u4e8b\u60c5\uff1a\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u5168\u96c6 \\(U\\)\uff0c\u53c8\u6709\u4e00\u4e2a\u5927\u5c0f\u4e3a \\(n\\) \u7684\u6027\u8d28\u96c6\u5408 \\(P\\)\u3002</p> <p>H\uff1a\u6211\u4eec\u5e0c\u671b\u7edf\u8ba1\u51fa\u81f3\u5c11\u5177\u6709\u4e00\u4e2a \\(P\\) \u4e2d\u7684\u6027\u8d28\u7684\u5143\u7d20\u6570\u91cf\u3002\u5047\u5982\u7528 \\(S_i\\) \u8868\u793a\u62e5\u6709\u7b2c \\(i\\) \u4e2a\u6027\u8d28\u7684\u5143\u7d20\u96c6\u5408\uff0c\u6211\u4eec\u5c31\u662f\u5e0c\u671b\u8ba1\u7b97\uff1a</p> \\[ \\left\\lvert\\bigcup_{i=1}^{n}S_i\\right\\rvert \\] <p>H\uff1a\u7ecf\u5178\u5bb9\u65a5\u7ed9\u51fa\u7684\u505a\u6cd5\u662f\uff0c\u6211\u4eec\u5148\u8ba1\u7b97 \\(\\sum_{i=1}^{n}|S_i|\\)\uff0c\u7136\u540e\u53d1\u73b0\u5177\u6709\u81f3\u5c11\u4e24\u4e2a\u6027\u8d28\u7684\u5143\u7d20\u88ab\u7b97\u91cd\u4e86\uff0c\u51cf\u53bb \\(\\sum_{i&lt;j}|S_i\\cap S_j|\\)\uff0c\u7136\u540e\u53d1\u73b0\u5177\u6709\u81f3\u5c11\u4e09\u4e2a\u6027\u8d28\u7684\u5143\u7d20\u53c8\u591a\u51cf\u4e86\uff0c\u518d\u52a0\u56de\u53bb\u2026\u2026\u6211\u4eec\u51ed\u76f4\u89c9\u5217\u51fa\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a</p> \\[ \\sum_{m=1}^{n}(-1)^{m-1}\\qty(\\sum_{T\\subseteq P,|T|=m}\\left\\lvert\\bigcap_{x\\in T}S_x\\right\\rvert) \\] <p>H\uff1a\u6700\u540e\uff0c\u5bf9\u6bcf\u4e2a\u5143\u7d20\u65bd\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u6240\u6709\u81f3\u5c11\u6709\u4e00\u4e2a\u6027\u8d28\u7684\u5143\u7d20\uff0c\u4f1a\u88ab\u6070\u597d\u88ab\u7edf\u8ba1\u4e00\u6b21\uff0c\u800c\u4e00\u4e2a\u90fd\u6ca1\u6709\u7684\u5b8c\u5168\u4e0d\u53c2\u4e0e\u4e0a\u9762\u7684\u8fd0\u7b97\uff0c\u6240\u4ee5\u4e0a\u5f0f\u5c31\u7b49\u4e8e\u6211\u4eec\u8981\u6c42\u7684\u503c\u3002</p> <p>N\uff1a\u5728\u8ba8\u8bba\u8fd9\u4e9b\u548c\u5f0f\u7684\u65f6\u5019\uff0c\u6211\u4eec\u603b\u662f\u4ece\u6027\u8d28\u7684\u89d2\u5ea6\u53bb\u8ba8\u8bba\uff0c\u5373\u8003\u8651\u5177\u6709\u6027\u8d28 \\(i\\) \u7684\u5143\u7d20\u96c6 \\(S_i\\)\u3002\u4f60\u80fd\u4ece\u5143\u7d20\u7684\u89d2\u5ea6\u7ed9\u51fa\u4e00\u4e9b\u521d\u6b65\u7684\u60f3\u6cd5\u5417\uff1f</p> <p>H\uff1a\u4ece\u5143\u7d20\u7684\u89d2\u5ea6\u89c2\u5bdf\u2026\u2026\u6211\u4eec\u9700\u8981\u7edf\u8ba1\u5177\u6709\u81f3\u5c11\u4e00\u4e2a\u6027\u8d28\u7684\u5143\u7d20\uff0c\u5443\uff0c\u6211\u4eec\u7ed9 \\(U\\) \u4e00\u4e2a\u5230 \\(\\{0,1\\}\\) \u7684\u6620\u5c04 \\(\\varphi\\)\uff0c\u5047\u8bbe \\(x\\) \u5177\u6709\u81f3\u5c11\u4e00\u4e2a\u6027\u8d28\uff0c\u90a3\u4e48 \\(\\varphi(x)=1\\)\uff0c\u5426\u5219 \\(\\varphi(x)=0\\)\u3002\u8fd9\u6837\uff0c\\(\\sum_{x\\in U}\\varphi(x)\\) \u5c31\u662f\u6211\u4eec\u8981\u7684\u7b54\u6848\u4e86\u2026\u2026\u8fd9\u770b\u8d77\u6765\u6ca1\u4ec0\u4e48\u7528\u554a\u3002</p> <p>N\uff1a\u7528\u8865\u96c6\u8f6c\u5316\uff0c\u53d8\u4e3a\u7edf\u8ba1\u4e00\u4e2a\u6027\u8d28\u90fd\u4e0d\u5177\u6709\u7684\u5143\u7d20\u4e2a\u6570\u5462\uff1f</p> <p>H\uff1a\u90a3\u5c31\u662f\u8bf4\uff0c\u82e5 \\(x\\) \u4e0d\u5177\u6709\u4efb\u4f55\u7684\u6027\u8d28\uff0c\u5219 \\(\\varphi(x)=1\\)\uff0c\u5426\u5219 \\(\\varphi(x)=0\\)\uff0c\u8ba9\u6211\u60f3\u60f3\u2026\u2026\u4e5f\u5c31\u662f\u8bf4\u8f93\u5165 \\(0\\) \u4f1a\u5f97\u5230 \\(1\\)\uff0c\u8f93\u5165\u5176\u5b83\u6240\u6709\u6b63\u6574\u6570\u90fd\u4f1a\u5f97\u5230 \\(0\\)\u2026\u2026\u554a\uff01\u6211\u77e5\u9053\u4e86\uff0c\u4ee4 \\(\\psi(x)\\) \u8868\u793a \\(x\\) \u5177\u6709\u7684\u6027\u8d28\u4e2a\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u6709 \\(\\varphi(x)=(1-1)^{\\psi(x)}\\)\uff01</p> <p>H\uff1a\u7136\u540e\u6211\u4eec\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u518d\u4ea4\u6362\u6c42\u548c\u53f7\uff0c\u56e0\u4e3a\uff0c\u5f53 \\(i&gt;\\psi(x)\\) \u65f6\uff0c\\(\\binom{\\psi(x)}{i}=0\\)\uff0c\u6211\u4eec\u7acb\u5373\u5f97\u5230\u4e0b\u9762\u7684\u7ed3\u679c</p> \\[ \\begin{aligned} \\sum_{x\\in U}(1-1)^{\\psi(x)}&amp;=\\sum_{x\\in U}\\sum_{i=0}^{\\psi(x)}(-1)^i\\binom{\\psi(x)}{i}\\\\ &amp;=\\sum_{i=0}^{n}(-1)^i\\sum_{x\\in U}\\binom{\\psi(x)}{i} \\end{aligned} \\] <p>N\uff1a\u4f60\u80fd\u56de\u987e\u4e00\u4e9b\u7ecf\u5178\u7684\u5bb9\u65a5\u8ba1\u6570\uff0c\u5e76\u7528\u8fd9\u4e2a\u65b9\u6cd5\u89e3\u51b3\u5417\uff1f</p> <p>H\uff1a\u6700\u7ecf\u5178\u7684\u5bb9\u65a5\u8ba1\u6570\u2026\u2026\u90a3\u5f53\u7136\u975e\u9519\u6392\u83ab\u5c5e\uff0c\u8ba9\u6211\u6765\u8bd5\u8bd5\u3002\u90a3\u4e48\uff0c\u8fd9\u91cc\u7684 \\(U\\) \u5c31\u662f\u5168\u90e8\u6392\u5217 \\(p\\) \u7ec4\u6210\u7684\u96c6\u5408\uff0c\u800c \\(\\psi(p)\\) \u5c31\u662f\u6392\u5217 \\(p\\) \u7684\u4e0d\u52a8\u70b9\u4e2a\u6570\u3002</p> <p>H\uff1a\u770b\u8d77\u6765\u6211\u4eec\u9700\u8981\u5148\u56fa\u5b9a\u4f4f\u5185\u5c42\u7684 \\(\\psi(p)\\)\uff0c\u90a3\u6211\u4eec\u5c31\u679a\u4e3e\u4e0d\u52a8\u70b9\u7684\u4e2a\u6570 \\(k\\)\uff0c\u7136\u540e\u8ba1\u7b97\u4e0d\u52a8\u70b9\u4e2a\u6570\u4e3a \\(k\\) \u7684\u6392\u5217\u2026\u2026\u4e0d\u5bf9\uff0c\u8fd9\u592a\u56f0\u96be\u4e86\u3002</p> <p>N\uff1a\u6211\u4eec\u9700\u8981\u53e6\u5bfb\u4ed6\u8def\uff0c\u89c2\u5bdf\u6211\u4eec\u7684\u548c\u5f0f\uff0c\u6211\u4eec\u662f\u5728\u679a\u4e3e\u4e86 \\(i\\) \u4e4b\u540e\uff0c\u5bf9\u6240\u6709\u6392\u5217 \\(p\\) \u8ba1\u7b97 \\(\\binom{\\psi(p)}{i}\\) \u4e4b\u548c\u3002</p> <p>H\uff1a\u55ef\u2026\u2026\u90a3\u6211\u4eec\u5c31\u5148\u4ece \\(i\\) \u4e0b\u624b\u5427\u3002\u8ba9\u6211\u60f3\u60f3\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6392\u5217 \\(p\\)\uff0c\u6211\u4eec\u6c42\u51fa\u5728\u5b83\u7684 \\(\\psi(p)\\) \u4e2a\u4e0d\u52a8\u70b9\u4e2d\u9009\u62e9 \\(i\\) \u4e2a\u7684\u65b9\u6848\u6570\u3002\u53cd\u8fc7\u6765\uff0c\u6211\u4eec\u8003\u8651\u94a6\u5b9a \\(i\\) \u4e2a\u70b9\u4f5c\u4e3a\u4e0d\u52a8\u70b9\uff0c\u8003\u8651\u6709\u591a\u5c11\u79cd\u6392\u5217\u4f1a\u8ba1\u7b97\u5230\u5b83\uff0c\u8fd9\u5f53\u7136\u5c31\u662f \\((n-i)!\\)\u3002\u6240\u4ee5\uff0c\u540e\u534a\u90e8\u5206\u7684\u6c42\u548c\u5c31\u662f \\(\\binom{n}{i}(n-i)!\\)\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5c31\u5f97\u5230\u4e86\u6700\u7ec8\u7684\u7ed3\u679c\u3002\u53ef\u8fd9\u770b\u8d77\u6765\u6bd4\u8d77\u4f20\u7edf\u65b9\u6cd5\u751a\u81f3\u66f4\u96be\u4e86\u3002</p> <p>H\uff1a\u554a\uff0c\u6211\u61c2\u4e86\uff0c\u5728\u8ba1\u7b97\u540e\u9762\u7684\u90e8\u5206\u7684\u65f6\u5019\uff0c\u6211\u4eec\u603b\u662f\u53ef\u4ee5\u518d\u4ea4\u6362\u4e00\u6b21\u6c42\u548c\uff0c\u5148\u53bb\u679a\u4e3e\u8fd9 \\(i\\) \u4e2a\u6027\u8d28\uff0c\u518d\u8ba1\u7b97\u5177\u6709\u5b83\u4eec\u7684\u7ed3\u6784\u4e2a\u6570\u2026\u2026\u6211\u4eec\u5f97\u5230\u4e86\u4e0b\u9762\u8fd9\u6761\u5f0f\u5b50\uff0c\u53c8\u56de\u5230\u4e86\u4f20\u7edf\u7684\u89c6\u89d2\u3002</p> \\[ \\sum_{x\\in U}\\binom{\\psi(x)}{i}=\\qty(\\sum_{T\\subseteq P,|T|=i}\\left\\lvert\\bigcap_{x\\in T}S_x\\right\\rvert) \\] <p>N\uff1a\u4e0d\u8981\u5fc3\u6025\uff01\u5f62\u5f0f\u7684\u53d8\u5316\u6709\u65f6\u5019\u4e5f\u80fd\u7ed9\u6211\u4eec\u65b0\u7684\u89c6\u89d2\u3002\u60f3\u4e00\u60f3\uff0c\u6211\u4eec\u5728\u4ec0\u4e48\u6837\u7684\u5730\u65b9\u89c1\u8fc7\u4e8c\u9879\u5f0f\u7cfb\u6570\uff1f</p> <p>H\uff1a\u65e2\u8981\u6709\u4e8c\u9879\u5f0f\u7cfb\u6570\uff0c\u53c8\u8981\u548c\u5bb9\u65a5\u76f8\u5173\u2026\u2026\u6211\u60f3\u6700\u7ecf\u5178\u7684\u4f8b\u5b50\u65e0\u975e\u662f\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\u8ba9\u6211\u56de\u5fc6\u4e00\u4e0b\u5b83\u7684\u5176\u4e2d\u4e00\u4e2a\u5f62\u5f0f\uff1a</p> <p>\u5047\u8bbe\u6070\u597d\u5177\u6709 \\(n\\) \u6761\u6027\u8d28\u7684\u7ec4\u5408\u7ed3\u6784\u6570\u662f \\(g(n)\\)\uff0c\u800c \\(f(n)\\) \u4e3a\u5148\u94a6\u5b9a \\(n\\) \u6761\u6027\u8d28\uff0c\u518d\u8ba1\u7b97\u6240\u6709\u5177\u6709\u8fd9 \\(n\\) \u6761\u6027\u8d28\u7684\u7ed3\u6784\u4e2a\u6570\uff0c\u6700\u540e\u628a\u6240\u6709\u94a6\u5b9a\u65b9\u6cd5\u5f97\u5230\u7684\u7ed3\u6784\u4e2a\u6570\u52a0\u8d77\u6765\u3002</p> <p>H\uff1a\u554a\uff01\u8fd9\u4e5f\u5c31\u662f\u8bf4\uff1a</p> \\[ f(n)=\\qty(\\sum_{T\\subseteq P,|T|=n}\\left\\lvert\\bigcap_{x\\in T}S_x\\right\\rvert)=\\sum_{x\\in U}\\binom{\\psi(x)}{n} \\] <p>H\uff1a\u73b0\u5728\u56de\u5230\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u6839\u636e\u7b97\u4e24\u6b21\u539f\u7406\uff0c\u6211\u4eec\u6709\uff1a</p> \\[ f(n)=\\sum_{i=n}^{m}\\binom{i}{n}g(i) \\] <p>\u8fd9\u662f\u56e0\u4e3a\uff0c\u6bcf\u4e2a \\(g(i)\\) \u90fd\u5728 \\(\\binom{i}{n}\\) \u4e2d\u94a6\u5b9a \\(n\\) \u6761\u5c5e\u6027\u7684\u65b9\u6cd5\u4e2d\u88ab\u8ba1\u7b97\u4e86\u4e00\u6b21\u3002</p> <p>N\uff1a\u53cd\u6f14\u7684\u90e8\u5206\u5462\uff1f\u4f60\u80fd\u4ece\u6211\u4eec\u4e0a\u9762\u7684\u7406\u8bba\uff0c\u5bfc\u51fa\u7528 \\(f(n)\\) \u7b97 \\(g(n)\\) \u7684\u65b9\u6cd5\u5417\uff1f</p> <p>H\uff1a\u8ba9\u6211\u6765\u8bd5\u8bd5\uff0c\u6211\u4eec\u628a\u5f85\u8bc1\u660e\u7684\u5f0f\u5b50\u5217\u51fa\u6765\uff1a</p> \\[ g(n)=\\sum_{i=n}^{m}(-1)^{i-n}\\binom{i}{n}f(i) \\] <p>H\uff1a\u6839\u636e\u6211\u4eec\u4e0a\u9762\u7684\u60f3\u6cd5\uff0c\u6211\u4eec\u8ba1\u7b97\u6240\u6709 \\(\\psi(x)\\ge n\\) \u7684 \\(x\\) \u7684 \\((1-1)^{\\psi(x)-n}\\) \u4e4b\u548c\u2026\u2026</p> \\[ \\begin{aligned} g(n)&amp;=\\sum_{\\psi(x)\\ge n,x\\in U}(1-1)^{\\psi(x)-n}\\\\ &amp;=\\sum_{\\psi(x)\\ge n,x\\in U}\\sum_{i=0}^{\\psi(x)-n}(-1)^i\\binom{\\psi(x)-n}{i} \\end{aligned} \\] <p>H\uff1a\u60f3\u4e00\u60f3\uff0c\u6211\u8981\u600e\u4e48\u624d\u80fd\u51d1\u51fa\u4e0a\u9762\u7684\u5f62\u5f0f\u5462\u2026\u2026\u6709\u4e86\uff0c\u6211\u4ee4 \\(i\\leftarrow i+n\\)\u3002</p> \\[ g(n)=\\sum_{\\psi(x)\\ge n,x\\in U}\\sum_{i=n}^{\\psi(x)}(-1)^{i-n}\\binom{\\psi(x)-n}{i-n} \\] <p>N\uff1a\u6211\u4eec\u8981\u627e\u5230\u4e00\u6761\u542b\u6709 \\(\\displaystyle \\binom{a-c}{b-c}\\) \u7684\u7ec4\u5408\u6052\u7b49\u5f0f\uff0c\u770b\u8d77\u6765 \\(\\displaystyle \\binom{a}{b}\\binom{b}{c}=\\binom{a}{c}\\binom{a-c}{b-c}\\) \u6b63\u662f\u6211\u4eec\u8981\u7684\u3002</p> <p>H\uff1a\u90a3\u5c31\u662f\u8bf4</p> \\[ \\begin{aligned} g(n)&amp;=\\sum_{\\psi(x)\\ge n,x\\in U}\\sum_{i=n}^{\\psi(x)}(-1)^{i-n}\\dfrac{\\binom{\\psi(x)}{i}\\binom{i}{n}}{\\binom{\\psi(x)}{n}}\\\\ &amp;=\\sum_{i=n}^{m}(-1)^{i-n}\\binom{i}{n}\\sum_{x\\in U}\\dfrac{\\binom{\\psi(x)}{i}}{\\binom{\\psi(x)}{n}} \\end{aligned} \\] <p>H\uff1a\u4e0d\u5bf9\uff0c\u6211\u7b97\u9519\u4e86\u5417\uff1f\u8fd9\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u5f62\u5f0f\uff0c\u8ba9\u6211\u60f3\u60f3\u2026\u2026</p> <p>N\uff1a\u6211\u660e\u767d\u4f60\u7684\u7591\u60d1\u3002\u6211\u4eec\u6ce8\u610f\u5230\u8fd9\u4e2a\u5f0f\u5b50\u53ea\u548c \\(x\\) \u4e0e\u5e38\u91cf \\(n\\) \u6709\u5173\u3002\u8ba9\u6211\u4eec\u56de\u5230\u6700\u5f00\u59cb\u7684\u5f0f\u5b50\uff0c\u5e76\u628a\u5b83\u6539\u6210</p> \\[ g(n)=\\sum_{\\psi(x)\\ge n,x\\in U}\\binom{\\psi(x)}{n}(1-1)^{\\psi(x)-n} \\] <p>N\uff1a\u6ce8\u610f\u5230\u5f53 \\(\\psi(x)=n\\) \u65f6\uff0c\\(\\binom{\\psi(x)}{n}=1\\)\uff0c\u800c \\(\\psi(x)\\neq n\\) \u65f6\uff0c\\((1-1)^{\\psi(x)-n}=0\\)\uff0c\u6240\u4ee5\u8fd9\u6761\u5f0f\u5b50\u548c\u539f\u6765\u662f\u76f8\u7b49\u7684\uff0c\u73b0\u5728\uff0c\u4f60\u518d\u8bd5\u8bd5\uff1f</p> <p>H\uff1a\u6211\u6765\u8ba1\u7b97\u4e00\u4e0b\u2026\u2026\u8fd9\u6761\u4e1c\u897f\u662f\u5e38\u91cf\uff0c\u4e0d\u53c2\u4e0e\u8fd0\u7b97\u3002\u6240\u4ee5\u524d\u9762\u7684\u63a8\u5bfc\u4e0d\u53d8\uff0c\u6211\u4eec\u5feb\u8fdb\u5230</p> \\[ \\begin{aligned} g(n)&amp;=\\sum_{\\psi(x)\\ge n,x\\in U}\\binom{\\psi(x)}{n}\\sum_{i=n}^{\\psi(x)}(-1)^{i-n}\\dfrac{\\binom{\\psi(x)}{i}\\binom{i}{n}}{\\binom{\\psi(x)}{n}}\\\\ &amp;=\\sum_{i=n}^{m}(-1)^{i-n}\\binom{i}{n}\\sum_{x\\in U}\\dfrac{\\binom{\\psi(x)}{i}}{\\binom{\\psi(x)}{n}}\\cdot \\binom{\\psi(x)}{n}\\\\ &amp;=\\sum_{i=n}^{m}(-1)^{i-n}\\binom{i}{n}f(i) \\end{aligned} \\] <p>H\uff1a\u554a\uff01\u5b83\u521a\u597d\u6d88\u6389\u4e86\u90a3\u4e2a\u591a\u4f59\u7684\u5206\u6bcd\uff0c\u4e24\u6761\u4e0d\u540c\u7684\u5f0f\u5b50\u5374\u662f\u540c\u4e00\u4e2a\u7ed3\u679c\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\uff1f</p> <p>N\uff1a\u539f\u56e0\u6b63\u662f\u6211\u4eec\u4e0a\u9762\u8bf4\u7684\uff1a\\(\\psi(x)\\neq n\\) \u65f6\uff0c\\((1-1)^{\\psi(x)-n}=0\\)\u3002\u6211\u4eec\u628a\u548c\u5f0f\u6309 \\(\\psi(x)\\) \u5206\u7c7b\uff0c\u6bcf\u4e00\u7c7b\u63d0\u51fa\u6765\u4e00\u4e2a \\(\\binom{\\psi(x)}{n}\\)\uff0c\u9664\u4e86 \\(\\psi(x)=n\\) \u7684\u90a3\u4e00\u7c7b\uff0c\u6c42\u548c\u7684\u7ed3\u679c\u90fd\u662f \\(0\\)\u3002</p> <p>H\uff1a\u771f\u662f\u795e\u5947\uff01\u8fd9\u5c31\u4ee3\u8868\u6211\u4eec\u603b\u80fd\u7ed9 \\(\\displaystyle \\sum_{x\\in U,\\psi(x)\\ge k}(1-1)^{\\psi(x)-k}\\) \u7684\u6c42\u548c\u4e2d\u4e58\u4e0a\u4e00\u4e2a\u53ea\u4e0e\u5e38\u91cf\u548c \\(x\\) \u76f8\u5173\uff0c\u4e14 \\(\\psi(x)=k\\) \u65f6\u53d6\u5230 \\(1\\) \u7684\u51fd\u6570\uff0c\u4ee5\u4fbf\u8ba1\u7b97\u3002</p> <p>N\uff1a\u5f88\u597d\uff0c\u4f60\u53ef\u4ee5\u8bc1\u660e\u53e6\u4e00\u4e2a\u65b9\u5411\u4e0a\u7684\u4e8c\u9879\u5f0f\u53cd\u6f14\u5417\uff1f</p>"}, {"location": "Musings/", "title": "Index", "text": "<p>\u6b64\u5904\u8bb0\u5f55\u7075\u611f\u3001\u6784\u60f3\u3001\u9c9c\u82b1\u7b49\u521b\u4f5c\uff0c\u6216\u662f\u601d\u8003\u4e0e\u603b\u7ed3\u3002</p>"}, {"location": "javascripts/MathJax-3.2.2/", "title": "MathJax", "text": ""}, {"location": "javascripts/MathJax-3.2.2/#beautiful-math-in-all-browsers", "title": "Beautiful math in all browsers", "text": "<p>MathJax is an open-source JavaScript display engine for LaTeX, MathML, and AsciiMath notation that works in all modern browsers.  It was designed with the goal of consolidating the recent advances in web technologies into a single, definitive, math-on-the-web platform supporting the major browsers and operating systems.  It requires no setup on the part of the user (no plugins to download or software to install), so the page author can write web documents that include mathematics and be confident that users will be able to view it naturally and easily.  Simply include MathJax and some mathematics in a web page, and MathJax does the rest.</p> <p>Some of the main features of MathJax include:</p> <ul> <li> <p>High-quality display of LaTeX, MathML, and AsciiMath notation in HTML pages</p> </li> <li> <p>Supported in most browsers with no plug-ins, extra fonts, or special   setup for the reader</p> </li> <li> <p>Easy for authors, flexible for publishers, extensible for developers</p> </li> <li> <p>Supports math accessibility, cut-and-paste interoperability, and other   advanced functionality</p> </li> <li> <p>Powerful API for integration with other web applications</p> </li> </ul> <p>See http://www.mathjax.org/ for additional details about MathJax, and https://docs.mathjax.org for the MathJax documentation.</p>"}, {"location": "javascripts/MathJax-3.2.2/#mathjax-components", "title": "MathJax Components", "text": "<p>MathJax version 3 uses files called components that contain the various MathJax modules that you can include in your web pages or access on a server through NodeJS.  Some components combine all the pieces you need to run MathJax with one or more input formats and a particular output format, while other components are pieces that can be loaded on demand when needed, or by a configuration that specifies the pieces you want to combine in a custom way.  For usage instructions, see the MathJax documentation.</p> <p>Components provide a convenient packaging of MathJax's modules, but it is possible for you to form your own custom components, or to use MathJax's modules directly in a node application on a server.  There are web examples showing how to use MathJax in web pages and how to build your own components, and node examples illustrating how to use components in node applications or call MathJax modules directly.</p>"}, {"location": "javascripts/MathJax-3.2.2/#whats-in-this-repository", "title": "What's in this Repository", "text": "<p>This repository contains only the component files for MathJax, not the source code for MathJax (which are available in a separate MathJax source repository).  These component files are the ones served by the CDNs that offer MathJax to the web.  In version 2, the files used on the web were also the source files for MathJax, but in version 3, the source files are no longer on the CDN, as they are not what are run in the browser.</p> <p>The components are stored in the <code>es5</code> directory, and are in ES5 format for the widest possible compatibility.  In the future, we may make an <code>es6</code> directory containing ES6 versions of the components.</p>"}, {"location": "javascripts/MathJax-3.2.2/#installation-and-use", "title": "Installation and Use", "text": ""}, {"location": "javascripts/MathJax-3.2.2/#using-mathjax-components-from-a-cdn-on-the-web", "title": "Using MathJax components from a CDN on the web", "text": "<p>If you are loading MathJax from a CDN into a web page, there is no need to install anything.  Simply use a <code>script</code> tag that loads MathJax from the CDN.  E.g.,</p> <pre><code>&lt;script id=\"MathJax-script\" async src=\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"&gt;&lt;/script&gt;\n</code></pre> <p>See the MathJax documentation, the MathJax Web Demos, and the MathJax Component Repository for more information.</p>"}, {"location": "javascripts/MathJax-3.2.2/#hosting-your-own-copy-of-the-mathjax-components", "title": "Hosting your own copy of the MathJax Components", "text": "<p>If you want to host MathJax from your own server, you can do so by installing the <code>mathjax</code> package using <code>npm</code> and moving the <code>es5</code> directory to an appropriate location on your server:</p> <pre><code>npm install mathjax@3\nmv node_modules/mathjax/es5 &lt;path-to-server-location&gt;/mathjax\n</code></pre> <p>Note that we are still making updates to version 2, so include <code>@3</code> when you install, since the latest chronological version may not be version 3.</p> <p>Alternatively, you can get the files via GitHub:</p> <pre><code>git clone https://github.com/mathjax/MathJax.git mj-tmp\nmv mj-tmp/es5 &lt;path-to-server-location&gt;/mathjax\nrm -rf mj-tmp\n</code></pre> <p>Then (in either case) you can use a script tag like the following:</p> <pre><code>&lt;script id=\"MathJax-script\" async src=\"&lt;url-to-your-site&gt;/mathjax/tex-chtml.js\"&gt;&lt;/script&gt;\n</code></pre> <p>where <code>&lt;url-to-your-site&gt;</code> is replaced by the URL to the location where you moved the MathJax files above.</p> <p>See the documentation for details.</p>"}, {"location": "javascripts/MathJax-3.2.2/#using-mathjax-components-in-a-node-application", "title": "Using MathJax components in a node application", "text": "<p>To use MathJax components in a node application, install the <code>mathjax</code> package:</p> <pre><code>npm install mathjax@3\n</code></pre> <p>(we are still making updates to version 2, so you should include <code>@3</code> since the latest chronological version may not be version 3).</p> <p>Then require <code>mathjax</code> within your application:</p> <pre><code>require('mathjax').init({ ... }).then((MathJax) =&gt; { ... });\n</code></pre> <p>where the first <code>{ ... }</code> is a MathJax configuration, and the second <code>{ ... }</code> is the code to run after MathJax has been loaded.  E.g.</p> <pre><code>require('mathjax').init({\n  loader: {load: ['input/tex', 'output/svg']}\n}).then((MathJax) =&gt; {\n  const svg = MathJax.tex2svg('\\\\frac{1}{x^2-1}', {display: true});\n  console.log(MathJax.startup.adaptor.outerHTML(svg));\n}).catch((err) =&gt; console.log(err.message));\n</code></pre> <p>Note: this technique is for node-based application only, not for browser applications.  This method sets up an alternative DOM implementation, which you don't need in the browser, and tells MathJax to use node's <code>require()</code> command to load external modules.  This setup will not work properly in the browser, even if you webpack it or bundle it in other ways.</p> <p>See the documentation and the MathJax Node Repository for more details.</p>"}, {"location": "javascripts/MathJax-3.2.2/#reducing-the-size-of-the-components-directory", "title": "Reducing the Size of the Components Directory", "text": "<p>Since the <code>es5</code> directory contains all the component files, so if you are only planning one use one configuration, you can reduce the size of the MathJax directory by removing unused components. For example, if you are using the <code>tex-chtml.js</code> component, then you can remove the <code>tex-mml-chtml.js</code>, <code>tex-svg.js</code>, <code>tex-mml-svg.js</code>, <code>tex-chtml-full.js</code>, and <code>tex-svg-full.js</code> configurations, which will save considerable space.  Indeed, you should be able to remove everything other than <code>tex-chtml.js</code>, and the <code>input/tex/extensions</code>, <code>output/chtml/fonts/woff-v2</code>, <code>adaptors</code>, <code>a11y</code>, and <code>sre</code> directories.  If you are using the results only on the web, you can remove <code>adaptors</code> as well.</p> <p>If you are not using A11Y support (e.g., speech generation, or semantic enrichment), then you can remove <code>a11y</code> and <code>sre</code> as well (though in this case you may need to disable the assistive tools in the MathJax contextual menu in order to avoid MathJax trying to load them when they aren't there).</p> <p>If you are using SVG rather than CommonHTML output (e.g., <code>tex-svg.js</code> rather than <code>tex-chtml.js</code>), you can remove the <code>output/chtml/fonts/woff-v2</code> directory.  If you are using MathML input rather than TeX (e.g., <code>mml-chtml.js</code> rather than <code>tex-chtml.js</code>), then you can remove <code>input/tex/extensions</code> as well.</p>"}, {"location": "javascripts/MathJax-3.2.2/#the-component-files-and-pull-requests", "title": "The Component Files and Pull Requests", "text": "<p>The <code>es5</code> directory is generated automatically from the contents of the MathJax source repository.  You can rebuild the components using the command</p> <pre><code>npm run make-es5 --silent\n</code></pre> <p>Note that since the contents of this repository are generated automatically, you should not submit pull requests that modify the contents of the <code>es5</code> directory.  If you wish to submit a modification to MathJax, you should make a pull request in the MathJax source repository.</p>"}, {"location": "javascripts/MathJax-3.2.2/#mathjax-community", "title": "MathJax Community", "text": "<p>The main MathJax website is http://www.mathjax.org, and it includes announcements and other important information.  A MathJax user forum for asking questions and getting assistance is hosted at Google, and the MathJax bug tracker is hosted at GitHub.</p> <p>Before reporting a bug, please check that it has not already been reported.  Also, please use the bug tracker (rather than the help forum) for reporting bugs, and use the user's forum (rather than the bug tracker) for questions about how to use MathJax.</p>"}, {"location": "javascripts/MathJax-3.2.2/#mathjax-resources", "title": "MathJax Resources", "text": "<ul> <li>MathJax Documentation</li> <li>MathJax Components</li> <li>MathJax Source Code</li> <li>MathJax Web Examples</li> <li>MathJax Node Examples</li> <li>MathJax Bug Tracker</li> <li>MathJax Users' Group</li> </ul>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/", "title": "Contributing to MathJax", "text": "<p>You are interested in giving us a hand? That's awesome! We've put together some brief guidelines that should help you get started quickly and easily.</p> <p>There are lots and lots of ways to get involved, this document covers:</p> <ul> <li>reporting an issue<ul> <li>bug reports</li> <li>feature requests</li> <li>change requests</li> </ul> </li> <li>working on MathJax core<ul> <li>key branches and tags</li> <li>submitting pull requests</li> <li>testing and quality assurance</li> <li>writing documentation</li> <li>translation</li> </ul> </li> <li>Conduct</li> </ul>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#reporting-an-issue", "title": "Reporting An Issue", "text": "<p>If you're about to raise an issue because you think you've found a problem with MathJax, or you'd like to make a request for a new feature in the codebase, or any other reason, please read this first.</p> <p>The MathJax issue tracker is the preferred channel for bug reports, feature requests, change requests, and submitting pull requests, but please respect the following restrictions:</p> <ul> <li> <p>Please search for existing issues. Help us keep duplicate issues   to a minimum by checking to see if someone has already reported your   problem or requested your idea.</p> </li> <li> <p>Please do not use the issue tracker for personal support   requests (use the MathJax User Group).</p> </li> <li> <p>Please be civil. Keep the discussion on topic and respect the   opinions of others. See also our Conduct Guidelines</p> </li> </ul>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#bug-reports", "title": "Bug Reports", "text": "<p>A bug is a demonstrable problem that is caused by the code in the repository. Good bug reports are extremely helpful \u2014 thank you!</p> <p>Guidelines for bug reports:</p> <ol> <li> <p>Use the GitHub issue search \u2014 check if the issue has already been    reported.</p> </li> <li> <p>Check if the issue has been fixed \u2014 look for closed    issues in the current    milestone    or try to reproduce it using the latest <code>develop</code> branch. Please    note that you will need to    compile MathJax and make the components    in order to test MathJax from the source repository.</p> </li> <li> <p>Share a live sample of the problem \u2014 without a live page    it is usually impossible to debug problems; see also the Bug Report    Template below.</p> </li> <li> <p>Isolate the problem \u2014 a live sample is a starting point    but if you want to speed things up, create a reduced test    case. Be specific    about your setup (browser, OS versions, etc). Use services like    jsbin, CodePen, or    jsFiddle to make collaboration on minimal    test cases easier for everyone.</p> </li> <li> <p>Include a screenshot/cast as a last resort \u2014 Is your    issue about a layout or design feature or bug that is hard to reproduce    or isolate? Then please provide a screenshot or screencast. Tools    like LICEcap or    SauceLabs allow you to quickly and    easily record a screencasts. If you make it an animated gif, you can    embed it directly into your GitHub issue.</p> </li> <li> <p>Use the Bug Report Template below or click this    link    to start creating a bug report with the template automatically.</p> </li> </ol> <p>A good bug report shouldn't leave others needing to request more information from you. Be sure to include the details of your environment.</p> <p></p> <p>Template Example (click to use):</p> <pre><code>Short and descriptive example bug report title\n\n### Issue Summary\n\nA summary of the issue and the browser/OS environment in which it occurs. If\nsuitable, include the steps required to reproduce the bug.\n\n### Steps to Reproduce\n\n1. This is the first step\n2. This is the second step\n3. Further steps, etc.\n\nAny other information you want to share that is relevant to the issue\nbeing reported. Especially, why do you consider this to be a bug? What\ndo you expect to happen instead?\n\n### Technical details:\n\n* MathJax Version: 2.3 (latest commit: f3aaf3a2a3e964df2770dc4aaaa9c87ce5f47e2c)\n* Client OS: Mac OS X 10.8.4\n* Browser: Chrome 29.0.1547.57\n</code></pre>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#feature-requests", "title": "Feature Requests", "text": "<p>Feature requests are welcome. Before you submit one, be sure to have:</p> <ol> <li>Used the GitHub search to check that the feature hasn't already    been requested.</li> <li>Take a moment to think about whether your idea fits with the scope    and aims of the project, or if it might better fit being a custom    extension.</li> <li>Remember, it's up to you to make a strong case to convince the    project's leaders of the merits of this feature. Please provide as    much detail and context as possible, this means explaining the use    case and why it is likely to be common.</li> </ol>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#change-requests", "title": "Change Requests", "text": "<p>Change requests cover both architectural and functional changes to how MathJax works. If you have an idea for a new or different dependency, a refactor, or an improvement to a feature, etc., please be sure to:</p> <ol> <li>Use the GitHub search to check that someone else didn't get there first.</li> <li>Take a moment to think about the best way to make a case for, and    explain what you're thinking. Are you sure this shouldn't really be    a bug report or a feature    request?  Is it really one idea or is it many?    What's the context? What problem are you solving? Why is what you    are suggesting better than what's already there?</li> </ol>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#working-on-mathjax-core", "title": "Working on MathJax core", "text": "<p>You want to contribute code? We describe how below.  First, note that the MathJax source code is in the https://github.com/mathjax/MathJax-src repository, not the https://github.com/mathjax/MathJax repository, which contains the packaged component files for distribution on CDNs and the mathjax npm package (the source code is included in the mathjax-full npm package).</p>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#key-branches-tags", "title": "Key Branches &amp; Tags", "text": "<p>MathJax uses several permanent branches in the MathJax source repository:</p> <ul> <li> <p>develop   is the development branch. All work on the next release happens here   so you should generally branch off <code>develop</code> if you are going to   submit a pull request. Do NOT use this branch for a production   site.</p> </li> <li> <p>master contains the latest   release of MathJax. This branch may be used in production. Do    NOT use this branch to work on MathJax's source.</p> </li> </ul> <p>These branches reflect version 3 of MathJax, which is substantially different from the version 2 codebase.  Version 2 will continue to be maintained while web sites transition to version 3, with work being done using the following branches in the MathJax distribution repository:</p> <ul> <li> <p>legacy-v2-develop   is the development branch for changes to the legacy version 2 code.   Any pull requests for version 2 should be branched from here.  Do   NOT use this branch for a production site.</p> </li> <li> <p>legacy-v2   is the branch that contains any updates to version 2 following   the release of version 3.  Do NOT use this branch to work on   MathJax's source.</p> </li> </ul> <p>In addition to these branches, MathJax uses tags to identify the various versions.  These can be checked out to obtain the specified release; for example, <code>git checkout 2.7.5</code> would get you the files for version 2.7.5 of MathJax.</p> <p>Note that version 3 is written in Typescript, and so must be compiled to obtain usable javascript files, and that the components need to be built once that is done.  See the documentation for details. For version 2, the source javascript files are not compressed until a release is made, so you should use the copies in the <code>unpacked</code> directory during development.</p>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#submitting-pull-requests", "title": "Submitting Pull Requests", "text": "<p>Pull requests are welcome. If you're looking to submit a PR for something that doesn't have an open issue, please consider raising an issue that your PR can close, especially if you're fixing a bug. This makes it more likely that there will be enough information available for your PR to be properly tested and merged.</p>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#need-help", "title": "Need Help?", "text": "<p>If you're not completely clear on how to submit/update/do Pull Requests, please check out our source control policies. For more insights, check the excellent in depth Git Workflow guide from Ghost, in particular</p> <ul> <li>Ghost Workflow guide: commit messages</li> </ul>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#testing-and-quality-assurance", "title": "Testing and Quality Assurance", "text": "<p>If you're looking to get involved with the code base and don't know where to start, checking out and testing a pull request is one of the most useful things you could do.</p> <p>These are some excellent instructions on configuring your GitHub repository to allow you to checkout pull requests in the same way as branches.</p>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#writing-documentation", "title": "Writing documentation", "text": "<p>MathJax's main documentation can be found at docs.mathjax.org. The source of the docs is hosted in the mathjax/MathJax-docs repo here on GitHub.</p> <p>The documentation is generated using Sphinx-doc and hosted on Read the docs.  You can clone the repo and submit pull requests following the pull-request guidelines.</p>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#translation", "title": "Translation", "text": "<p>If you wish to add or update translations of MathJax, please do it on TranslateWiki.net (and while you're there you can help other open source projects, too).</p> <p>For bug reports and other questions that don't fit on TranslateWiki.net, head over to the mathjax/mathjax-i18n repository.</p> <p>The translation files currently are for version 2, as localization hasn't been added to version 3 yet.</p>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#conduct", "title": "Conduct", "text": "<p>As a NumFOCUS fiscally sponsored project, MathJax is governed by the NumFOCUS code of conduct, which we summarize as follows:</p> <p>We are committed to providing a friendly, safe and welcoming environment for all, regardless of gender, sexual orientation, disability, ethnicity, religion, or similar personal characteristic.</p> <p>Please be kind and courteous. There's no need to be mean or rude. Respect that people have differences of opinion and that every design or implementation choice carries a trade-off and numerous costs. There is seldom a right answer, merely an optimal answer given a set of values and circumstances.</p> <p>Please keep unstructured critique to a minimum. If you have solid ideas you want to experiment with, make a fork and see how it works.</p> <p>We will exclude you from interaction if you insult, demean or harass anyone.  That is not welcome behaviour. We interpret the term \"harassment\" as including the definition in the Unacceptable Behavior section of the NumFOCUS code of conduct; if you have any lack of clarity about what might be included in that concept, please read that definition. In particular, we don't tolerate behavior that excludes people in socially marginalized groups.</p> <p>Private harassment is also unacceptable. No matter who you are, if you feel you have been or are being harassed or made uncomfortable by a community member, please contact one of the channel ops or any of the MathJax core team immediately. Whether you're a regular contributor or a newcomer, we care about making this community a safe place for you and we've got your back.</p> <p>Likewise any spamming, trolling, flaming, baiting, or other attention-stealing behaviour is not welcome.</p> <p>We also recommend that you read discourse's rules for further suggestions on appropriate behavior.</p>"}, {"location": "javascripts/MathJax-3.2.2/CONTRIBUTING/#references", "title": "References", "text": "<ul> <li>We heavily borrowed from Mozilla and Ghost -- thank you!</li> <li>https://github.com/TryGhost/Ghost/blob/master/CONTRIBUTING.md</li> <li>https://github.com/mozilla/rust/wiki/Note-development-policy</li> <li>https://github.com/jden/CONTRIBUTING.md/blob/master/CONTRIBUTING.md</li> <li>http://blog.discourse.org/2013/03/the-universal-rules-of-civilized-discourse/</li> </ul>"}, {"location": "whk/", "title": "Index", "text": "<p>\u77e2\u52e4\u77e2\u52c7\uff0c\u6307\u6208\u957f\u767d</p>"}]}